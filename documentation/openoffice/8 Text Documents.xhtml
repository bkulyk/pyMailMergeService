<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="content-type" content="text/html; charset=utf-8" /><title>Text Documents</title><link rel="stylesheet" type="text/css" href="./8 Text Documents_files/Text.css" /><meta name="generator" content="StarOffice/OpenOffice XSLT (http://xml.openoffice.org/sx2ml)" /><meta name="author" content="Dietrich Schulten" /><meta name="created" content="2002-03-07T10:38:36" /><meta name="changedby" content="Jürgen Schmidt" /><meta name="changed" content="2007-07-05T13:45:48" /><base href="." />
</head><body dir="ltr"><div id="wm-ipp" style="position: relative; padding-top: 0px; padding-right: 5px; padding-bottom: 0px; padding-left: 5px; min-height: 70px; min-width: 800px; z-index: 9000; display: none; ">
<div id="wm-ipp-inside" style="position:fixed;padding:0!important;margin:0!important;width:97%;min-width:780px;border:5px solid #000;border-top:none;background-image:url(http://static.waybackmachine.org/images/toolbar/wm_tb_bk_trns.png);text-align:center;-moz-box-shadow:1px 1px 3px #333;-webkit-box-shadow:1px 1px 3px #333;box-shadow:1px 1px 3px #333;font-size:11px!important;font-family:&apos;Lucida Grande&apos;,&apos;Arial&apos;,sans-serif!important;">
   <table style="border-collapse:collapse;margin:0;padding:0;width:100%;"><tbody><tr>
   <td style="padding:10px;vertical-align:top;min-width:110px;">
   <a href="http://waybackmachine.org/" title="Wayback Machine home page" style="background-color:transparent;border:none;"><img src="./8 Text Documents_files/wayback-toolbar-logo.png" alt="Wayback Machine" width="110" height="39" border="0" /></a>
   </td>
   <td style="padding:0!important;text-align:center;vertical-align:top;width:100%;">

       <table style="border-collapse:collapse;margin:0 auto;padding:0;width:570px;"><tbody><tr>
       <td style="padding:3px 0;" colspan="2">
       <form target="_top" method="get" action="http://waybackmachine.org/form-submit.jsp" name="wmtb" id="wmtb" style="margin:0!important;padding:0!important;"><input type="text" name="url" id="wmtbURL" value="http://api.openoffice.org/docs/DevelopersGuide/Text/Text.xhtml" style="width:400px;font-size:11px;font-family:&apos;Lucida Grande&apos;,&apos;Arial&apos;,sans-serif;" onfocus="javascript:this.focus();this.select();" /><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20090501191804" /><input type="submit" value="Go" style="font-size:11px;font-family:&apos;Lucida Grande&apos;,&apos;Arial&apos;,sans-serif;margin-left:5px;" /><span id="wm_tb_options" style="display:block;" /></form>
       </td>
       <td style="vertical-align:bottom;padding:5px 0 0 0!important;" rowspan="2">
           <table style="border-collapse:collapse;width:110px;color:#99a;font-family:&apos;Helvetica&apos;,&apos;Lucida Grande&apos;,&apos;Arial&apos;,sans-serif;"><tbody>
			
           <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
           <tr style="width:110px;height:16px;font-size:10px!important;">
           	<td style="padding-right:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="http://replay.waybackmachine.org/20090331154843/http://api.openoffice.org/docs/DevelopersGuide/Text/Text.xhtml" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="31 Mar 2009"><strong>MAR</strong></a>
		                
               </td>
               <td id="displayMonthEl" style="background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: rgb(0, 0, 0); font-size: 11px !important; font-weight: bold; text-transform: uppercase; width: 34px; height: 15px; padding-top: 1px; text-align: center; color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial; " title="You are here: 19:18:04 May 1, 2009">May</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
                       Jun
                       
               </td>
           </tr>

           <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
           <tr>
               <td style="padding-right:9px;white-space:nowrap;overflow:visible;text-align:right!important;vertical-align:middle!important;" nowrap="nowrap">
               
		                <a href="http://replay.waybackmachine.org/20090331154843/http://api.openoffice.org/docs/DevelopersGuide/Text/Text.xhtml" title="15:48:43 Mar 31, 2009" style="background-color:transparent;border:none;"><img src="./8 Text Documents_files/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a>
		                
               </td>
               <td id="displayDayEl" style="background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: rgb(0, 0, 0); width: 34px; height: 24px; padding-top: 2px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; text-align: center; font-size: 24px; font-weight: bold; color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial; " title="You are here: 19:18:04 May 1, 2009">1</td>
				<td style="padding-left:9px;white-space:nowrap;overflow:visible;text-align:left!important;vertical-align:middle!important;" nowrap="nowrap">
               
                       <img src="./8 Text Documents_files/wm_tb_nxt_off.png" alt="Next capture" width="14" height="16" border="0" />
                       
			    </td>
           </tr>

           <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
           <tr style="width:110px;height:13px;font-size:9px!important;">
				<td style="padding-right:9px;font-size:11px!important;font-weight: bold;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="http://replay.waybackmachine.org/20080424073932/http://api.openoffice.org/docs/DevelopersGuide/Text/Text.xhtml" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="24 Apr 2008"><strong>2008</strong></a>
		                
               </td>
               <td id="displayYearEl" style="background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: rgb(0, 0, 0); font-size: 11px !important; font-weight: bold; padding-top: 1px; width: 34px; height: 13px; text-align: center; color: rgb(255, 255, 0); background-position: initial initial; background-repeat: initial initial; " title="You are here: 19:18:04 May 1, 2009">2009</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight: bold;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
                       2010
                       
				</td>
           </tr>
           </tbody></table>
       </td>

       </tr>
       <tr>
       <td style="vertical-align:middle;padding:0!important;">
           <a href="http://waybackmachine.org/20090501191804*/http://api.openoffice.org/docs/DevelopersGuide/Text/Text.xhtml" style="color:#33f;font-size:11px;font-weight:bold;background-color:transparent;border:none;" title="See a list of every capture for this URL"><strong>102 captures</strong></a>
           <div style="margin:0!important;padding:0!important;color:#666;font-size:9px;padding-top:2px!important;white-space:nowrap;" title="Timespan for captures of this URL">1 Feb 06 - 1 May 09</div>
       </td>
       <td style="padding:0!important;">
       <a style="position:relative; white-space:nowrap; width:400px;height:27px;" href="http://replay.waybackmachine.org/19990101000000/http://api.openoffice.org/docs/DevelopersGuide/Text/Text.xhtml" id="wm-graph-anchor">
       <div id="wm-ipp-sparkline" style="position:relative; white-space:nowrap; width:400px;height:27px;background-color:#fff;cursor:pointer;border-right:1px solid #ccc;" title="Explore captures for this URL">
			<img id="sparklineImgId" style="position:absolute; z-index:9012; top:0px; left:0px;" onmouseover="showTrackers(&apos;inline&apos;);" onmouseout="showTrackers(&apos;none&apos;);" onmousemove="trackMouseMove(event,this)" alt="sparklines" width="400" height="27" border="0" src="./8 Text Documents_files/graph.jsp" />
			<img id="wbMouseTrackYearImg" style="position: absolute; z-index: 9010; left: 75px; display: none; " width="25" height="27" border="0" src="./8 Text Documents_files/transp-yellow-pixel.png" />
			<img id="wbMouseTrackMonthImg" style="position: absolute; z-index: 9011; left: 76px; display: none; " width="2" height="27" border="0" src="./8 Text Documents_files/transp-red-pixel.png" />
       </div>
		</a>

       </td>
       </tr></tbody></table>
   </td>
   <td style="text-align:right;padding:5px;width:65px;font-size:11px!important;">
       <a href="javascript:;" onclick="document.getElementById(&apos;wm-ipp&apos;).style.display=&apos;none&apos;;" style="display:block;padding-right:18px;background:url(http://static.waybackmachine.org/images/toolbar/wm_tb_close.png) no-repeat 100% 0;color:#33f;font-family:&apos;Lucida Grande&apos;,&apos;Arial&apos;,sans-serif;margin-bottom:23px;background-color:transparent;border:none;" title="Close the toolbar">Close</a>
       <a href="http://faq.waybackmachine.org/" style="display:block;padding-right:18px;background:url(http://static.waybackmachine.org/images/toolbar/wm_tb_help.png) no-repeat 100% 0;color:#33f;font-family:&apos;Lucida Grande&apos;,&apos;Arial&apos;,sans-serif;background-color:transparent;border:none;" title="Get some help using the Wayback Machine">Help</a>
   </td>
   </tr></tbody></table>

</div>
</div>
<!-- BEGIN WAYBACK TOOLBAR INSERT -->

<script type="text/javascript" src="./8 Text Documents_files/disclaim-element.js" />
<script type="text/javascript" src="./8 Text Documents_files/graph-calc.js" />
<script type="text/javascript" src="./8 Text Documents_files/jquery.min.js" />
<script type="text/javascript">
//<![CDATA[
var firstDate = 820454400000;
var lastDate = 1325375999999;
var wbPrefix = "http://replay.waybackmachine.org/";
var wbCurrentUrl = "http://api.openoffice.org/docs/DevelopersGuide/Text/Text.xhtml";

var curYear = -1;
var curMonth = -1;
var yearCount = 16;
var firstYear = 1996;
var imgWidth=400;
var yearImgWidth = 25;
var monthImgWidth = 2;
var trackerVal = "none";
var displayDay = "1";
var displayMonth = "May";
var displayYear = "2009";
var prettyMonths = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];

function showTrackers(val) {
	if(val == trackerVal) {
		return;
	}
	if(val == "inline") {
		document.getElementById("displayYearEl").style.color = "#ec008c";
		document.getElementById("displayMonthEl").style.color = "#ec008c";
		document.getElementById("displayDayEl").style.color = "#ec008c";		
	} else {
		document.getElementById("displayYearEl").innerHTML = displayYear;
		document.getElementById("displayYearEl").style.color = "#ff0";
		document.getElementById("displayMonthEl").innerHTML = displayMonth;
		document.getElementById("displayMonthEl").style.color = "#ff0";
		document.getElementById("displayDayEl").innerHTML = displayDay;
		document.getElementById("displayDayEl").style.color = "#ff0";
	}
   document.getElementById("wbMouseTrackYearImg").style.display = val;
   document.getElementById("wbMouseTrackMonthImg").style.display = val;
   trackerVal = val;
}
function getElementX2(obj) {
	var thing = jQuery(obj);
	if((thing == undefined) 
			|| (typeof thing == "undefined") 
			|| (typeof thing.offset == "undefined")) {
		return getElementX(obj);
	}
	return Math.round(thing.offset().left);
}
function trackMouseMove(event,element) {

   var eventX = getEventX(event);
   var elementX = getElementX2(element);
   var xOff = eventX - elementX;
	if(xOff < 0) {
		xOff = 0;
	} else if(xOff > imgWidth) {
		xOff = imgWidth;
	}
   var monthOff = xOff % yearImgWidth;

   var year = Math.floor(xOff / yearImgWidth);
	var yearStart = year * yearImgWidth;
   var monthOfYear = Math.floor(monthOff / monthImgWidth);
   if(monthOfYear > 11) {
       monthOfYear = 11;
   }
   // 1 extra border pixel at the left edge of the year:
   var month = (year * 12) + monthOfYear;
   var day = 1;
	if(monthOff % 2 == 1) {
		day = 15;
	}
	var dateString = 
		zeroPad(year + firstYear) + 
		zeroPad(monthOfYear+1,2) +
		zeroPad(day,2) + "000000";

	var monthString = prettyMonths[monthOfYear];
	document.getElementById("displayYearEl").innerHTML = year + 1996;
	document.getElementById("displayMonthEl").innerHTML = monthString;
	// looks too jarring when it changes..
	//document.getElementById("displayDayEl").innerHTML = zeroPad(day,2);

	var url = wbPrefix + dateString + '/' +  wbCurrentUrl;
	document.getElementById('wm-graph-anchor').href = url;

   //document.getElementById("wmtbURL").value="evX("+eventX+") elX("+elementX+") xO("+xOff+") y("+year+") m("+month+") monthOff("+monthOff+") DS("+dateString+") Moy("+monthOfYear+") ms("+monthString+")";
   if(curYear != year) {
       var yrOff = year * yearImgWidth;
       document.getElementById("wbMouseTrackYearImg").style.left = yrOff + "px";
       curYear = year;
   }
   if(curMonth != month) {
       var mtOff = year + (month * monthImgWidth) + 1;
       document.getElementById("wbMouseTrackMonthImg").style.left = mtOff + "px";
       curMonth = month;
   }
}
//]]>
</script>

<style type="text/css">body{margin-top:0!important;padding-top:0!important;min-width:800px!important;}#wm-ipp a:hover{text-decoration:underline!important;}</style>

<script type="text/javascript">
 var wmDisclaimBanner = document.getElementById("wm-ipp");
 if(wmDisclaimBanner != null) {
   disclaimElement(wmDisclaimBanner);
 }
</script>
<!-- END WAYBACK TOOLBAR INSERT -->
<p style="text-align:center;"><small>[ <a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/OfficeDev/OfficeDev.xhtml" title="Link to previous document">Previous document</a> | <a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/DevelopersGuide.xhtml" title="Link to the Content Table">Content Table</a> | <a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/Spreadsheet/Spreadsheet.xhtml" title="Link to next document">Next document</a> ]</small></p>
  
  
  
  <h1 style="margin-left:2.54cm;" class="P3"><a name="1_Text_Documents" />8  Text Documents</h1>
  <p class="Under_Head1"> </p>
  <h2 class="Head2"><a name="1_1_Overview" />8.1  Overview</h2>
  <p class="Paragraph">In the OpenOffice.org API, a text document is a document model which is able to handle text contents. A document in our context is a product of work that can be stored and printed to make the result of the work a permanent resource. By model we mean data that forms the basis of a document and is organized in a manner that allows working with the data independently from their visual representation in a graphical user interface. </p>
  <p class="Paragraph">It is important to understand that developers have to work with the model directly, when they want to change it through the OpenOffice.org API. The model <span class="Emphasis">has</span> a controller object which enables developers to manipulate the visual presentation of the document in the user interface. But the controller is not used to change a document. The controller serves two purposes.</p>
  <ul style="margin-left:0.5cm;">
   <li class="P4" style="margin-left:2.5cm;"><p class="P4" style="margin-left:0cm;">The controller interacts with the user interface for movement, such as moving the visible text cursor, flipping through screen pages or changing the zoom factor.  </p></li>
   <li class="P4" style="margin-left:2.5cm;"><p class="P4" style="margin-left:0cm;">The second purpose is getting information about the current view status, such as the current selection, the current page, the total page count or the line count. Automatic page or line breaks are not really part of the document data, but rather something that is needed in a certain presentation of the document. </p></li>
  </ul>
  <p class="Paragraph">Keeping the difference between model and controller in mind, we will now discuss the parts of a text document model in the OpenOffice.org API. </p>
  <p class="Paragraph">The text document model in the OpenOffice.org API has five major architectural areas, cf. <a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/Text/Text.xhtml#refIllustration0">Illustration 8.1</a> below. The five areas are:</p>
  <ul style="margin-left:0.5cm;">
   <li class="P5" style="margin-left:2.5cm;"><p class="P5" style="margin-left:0cm;">text </p></li>
   <li class="P5" style="margin-left:2.5cm;"><p class="P5" style="margin-left:0cm;">service manager (document internal) </p></li>
   <li class="P5" style="margin-left:2.5cm;"><p class="P5" style="margin-left:0cm;">draw page </p></li>
   <li class="P5" style="margin-left:2.5cm;"><p class="P5" style="margin-left:0cm;">text content suppliers </p></li>
   <li class="P5" style="margin-left:2.5cm;"><p class="P5" style="margin-left:0cm;">objects for styling and numbering </p></li>
  </ul>
  <p class="Paragraph">The core of the text document model is the text. It consists of character strings organized in paragraphs and other text contents. The usage of text will be discussed in <span class="ChapterRef"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/Text/Text.xhtml#1_3_Working_with_Text_Documents" title="see chapter 8.3 Text Documents - Working with Text Documents">8.3 Text Documents - Working with Text Documents</a></span>.</p>
  <p class="Paragraph">The service manager of the document model creates all text contents for the model, except for the paragraphs. Note that the document service manager is different from the main service manager that is used when connecting to the office. Each document model has its own service manager, so that the services can be adapted to the document when required. Examples for text contents created by the text document service manager are text tables, text fields, drawing shapes, text frames or graphic objects. The service manager is asked for a text content, then you insert it into the text. </p>
  <p class="Paragraph">Afterwards, the majority of these text contents in a text can be retrieved from the model using text content suppliers. The exception are drawing shapes. They can be found on the <span class="Codeintext">DrawPage</span>, which is discussed below.</p>
  <p class="Paragraph">Above the text lies the <span class="Codeintext">DrawPage</span>. It is used for drawing contents. Imagine it as a transparent layer with contents that can affect the text under the layer, for instance by forcing it to wrap around contents on the <span class="Codeintext">DrawPage</span>. However, text can also wrap through <span class="Codeintext">DrawPage</span> contents, so the similarity is limited.</p>
  <p class="Paragraph">Finally, there are services that allow for document wide styling and structuring of the text. Among them are style family suppliers for paragraphs, characters, pages and numbering patterns, and suppliers for line and outline numbering. </p>
  <p class="Paragraph">Besides these five architectural areas, there are a number of aspects covering the document character of our model: It is printable, storable, modifiable, it can be refreshed, its contents are able to be searched and replaced and it supplies general information about itself. These aspects are shown at the lower right of the illustration. </p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table55"><colgroup><col width="821" /></colgroup><tr><td style="text-align:left;width:17.979cm; " class="Table55A1">
      <div class="Paragraph"><div style="width: 14.536cm; " id="Frame2" class="fr2">
        <div class="Illustration"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/Text/TextDocumentOverview.png" title="link to the full-sized graphic &quot;./TextDocumentOverview.png&quot;"><img border="0" width="659" height="884" alt="Overview graphic of the Text Document model" src="./8 Text Documents_files/TextDocumentOverview.png" class="fr3" /></a>Illustration <a name="refIllustration0">8.1</a> <a name="Model_Illustration" />Text Document Model</div>
       </div></div>
     </td></tr></table></div>
  <p class="Paragraph">Finally, the controller provides access to the graphical user interface for the model and has knowledge about the current view status in the user interface, cf. the upper left of the diagram above. </p>
  <p class="Paragraph">The usage of text is discussed in the section <span class="ChapterRef"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/Text/Text.xhtml#1_3_1_Word_Processing" title="see chapter 8.3.1 Text Documents - Working with Text Documents - Word Processing">8.3.1 Text Documents - Working with Text Documents - Word Processing</a></span> below. This overview will be concluded by two examples:</p>
  <h3 class="Head3"><a name="1_1_1_Example_3A_Fields_in_a_Template" />8.1.1  Example: Fields in a Template</h3>
  <p class="Paragraph">All following code samples are contained in <span class="wwwftpemail">TextDocuments.java</span>. This file is located in the Samples folder that comes with the resources for the developer's manual.</p>
  <p class="Paragraph">The examples use the environment from chapter <span class="ChapterRef"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/FirstSteps/FirstSteps.xhtml#1_First_Steps" title="see chapter 2 First Steps">2 First Steps</a></span>, for instance, connecting using the <span class="Codeintext">getRemoteServiceManager()</span> method.</p>
  <p class="Paragraph">We want to use a template file containing text fields and bookmarks and insert text into the fields and at the cursor position. The suitable template file <span class="wwwftpemail">TextTemplateWithUserFields.odt</span> lies in the Samples folder, as well. Edit the path to this file below before running the sample.</p>
  <p class="Paragraph">The first step is to load the file as a template, so that OpenOffice.org creates a new, untitled document. As in the chapter <span class="ChapterRef"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/FirstSteps/FirstSteps.xhtml#1_First_Steps" title="see chapter 2 First Steps">2 First Steps</a></span>, we have to connect, get the <span class="Codeintext">Desktop</span> object, query its <span class="Codeintext">XComponentLoader</span> interface and call <span class="Codeintext">loadComponentFromUrl()</span>. This time we tell OpenOffice.org how it should load the file. The key for loading parameters is the sequence of <span class="Codeintext">PropertyValue</span> structs passed to <span class="Codeintext">loadComponentFromUrl()</span>. The appropriate <span class="Codeintext">PropertyValue</span> name is <span class="Codeintext">AsTemplate</span> and we have to set <span class="Codeintext">AsTemplate</span>  to <span class="Codeintext">true</span>. (<a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/examples/DevelopersGuide/Text/TextDocuments.java" title="goto source Text/TextDocuments.java">Text/TextDocuments.java</a>)</p>
  <p class="Code">/** Load a document as template */ </p>
  <p class="Code">protected XComponent newDocComponentFromTemplate(String loadUrl) throws java.lang.Exception { </p>
  <p class="Code">    // get the remote service manager</p>
  <p class="Code">    mxRemoteServiceManager = this.getRemoteServiceManager(unoUrl);</p>
  <p class="Code">    // retrieve the Desktop object, we need its XComponentLoader</p>
  <p class="Code">    Object desktop = mxRemoteServiceManager.createInstanceWithContext(</p>
  <p class="Code">        "com.sun.star.frame.Desktop", mxRemoteContext);</p>
  <p class="Code">    XComponentLoader xComponentLoader = (XComponentLoader)UnoRuntime.queryInterface(</p>
  <p class="Code">        XComponentLoader.class, desktop);</p>
  <p class="Code">        </p>
  <p class="Code">    // define load properties according to com.sun.star.document.MediaDescriptor</p>
  <p class="Code">    // the boolean property AsTemplate tells the office to create a new document</p>
  <p class="Code">    // from the given file</p>
  <p class="Code">    PropertyValue[] loadProps = new PropertyValue[1];</p>
  <p class="Code">    loadProps[0] = new PropertyValue();</p>
  <p class="Code">    loadProps[0].Name = "AsTemplate";</p>
  <p class="Code">    loadProps[0].Value = new Boolean(true);       </p>
  <p class="Code">    // load</p>
  <p class="Code">    return xComponentLoader.loadComponentFromURL(loadUrl, "_blank", 0, loadProps);           </p>
  <p class="Code">} </p>
  <p class="Paragraph">Now that we are able to load a text document as template, we will open an existing template file that contains five text fields and a bookmark. We want to demonstrate how to insert text at predefined positions in a document. </p>
  <p class="Paragraph">Text fields and bookmarks are supplied by the appropriate <span class="Codeintext">XTextFieldsSupplier</span> and <span class="Codeintext">XBookmarksSupplier</span> interfaces. Their fully qualified names are <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextFieldsSupplier.html" title="see type com.sun.star.text.XTextFieldsSupplier">com.sun.star.text.XTextFieldsSupplier</a></span> and <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XBookmarksSupplier.html" title="see type com.sun.star.text.XBookmarksSupplier">com.sun.star.text.XBookmarksSupplier</a></span>.</p>
  <p class="Paragraph">The <span class="Codeintext">XTextFieldsSupplier</span> provides collections of text fields in our text. We use document variable fields for our purpose, which are<span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/User.html" title="see type com.sun.star.text.textfield.User">com.sun.star.text.textfield.User</a></span> services. All <span class="Codeintext">User</span> fields have a field master that holds the actual content of the variable. Therefore, the <span class="Codeintext">TextFields</span> collection, as well as the <span class="Codeintext">FieldMasters</span> are required for our example. We get the field masters for the five fields by name and set their <span class="Codeintext">Content</span> property. Finally, we refresh the text fields so that they reflect the changes made to the field masters.</p>
  <p class="Paragraph">The <span class="Codeintext">XBookmarksSupplier</span> returns all bookmarks in our document. The collection of bookmarks is a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XNameAccess.html" title="see type com.sun.star.container.XNameAccess">com.sun.star.container.XNameAccess</a></span>, so that the bookmarks are retrieved by name. Every object in a text supports the interface <span class="Codeintext">XTextContent</span> that has a method <span class="Codeintext">getAnchor()</span>. The anchor is the text range an object takes up, so <span class="Codeintext">getAnchor()</span> retrieves is an <span class="Codeintext">XTextRange</span>. From the chapter <span class="ChapterRef"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/FirstSteps/FirstSteps.xhtml#1_First_Steps" title="see chapter 2 First Steps">2 First Steps</a></span>, a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextRange.html" title="see type com.sun.star.text.XTextRange">com.sun.star.text.XTextRange</a></span> allows setting the string of a text range. Our bookmark is a text content and therefore must support <span class="Codeintext">XTextContent</span>. Inserting text at a bookmark position is straightforward: get the anchor of the bookmark and set its string. (<a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/examples/DevelopersGuide/Text/TextDocuments.java" title="goto source Text/TextDocuments.java">Text/TextDocuments.java</a>)</p>
  <p class="Code">/** Sample for use of templates </p>
  <p class="Code">    This sample uses the file TextTemplateWithUserFields.odt from the Samples folder.</p>
  <p class="Code">    The file contains a number of User text fields (Variables - User) and a bookmark</p>
  <p class="Code">    which we use to fill in various values</p>
  <p class="Code"> */</p>
  <p class="Code">protected void templateExample() throws java.lang.Exception { </p>
  <p class="Code">    // create a small hashtable that simulates a rowset with columns</p>
  <p class="Code">    Hashtable recipient = new Hashtable();</p>
  <p class="Code">    recipient.put("Company", "Manatee Books");</p>
  <p class="Code">    recipient.put("Contact", "Rod Martin");</p>
  <p class="Code">    recipient.put("ZIP", "34567");</p>
  <p class="Code">    recipient.put("City", "Fort Lauderdale");</p>
  <p class="Code">    recipient.put("State", "Florida");</p>
  <p class="Code">        </p>
  <p class="Code">    // load template with User fields and bookmark</p>
  <p class="Code">    XComponent xTemplateComponent = newDocComponentFromTemplate(</p>
  <p class="Code">    "file:///X:/devmanual/Samples/TextTemplateWithUserFields.odt");</p>
  <p class="Code">        </p>
  <p class="Code">    // get XTextFieldsSupplier and XBookmarksSupplier interfaces from document component</p>
  <p class="Code">    XTextFieldsSupplier xTextFieldsSupplier = (XTextFieldsSupplier)UnoRuntime.queryInterface(</p>
  <p class="Code">        XTextFieldsSupplier.class, xTemplateComponent);</p>
  <p class="Code">    XBookmarksSupplier xBookmarksSupplier = (XBookmarksSupplier)UnoRuntime.queryInterface(</p>
  <p class="Code">        XBookmarksSupplier.class, xTemplateComponent);</p>
  <p class="Code">        </p>
  <p class="Code">    // access the TextFields and the TextFieldMasters collections</p>
  <p class="Code">    XNameAccess xNamedFieldMasters = xTextFieldsSupplier.getTextFieldMasters();</p>
  <p class="Code">    XEnumerationAccess xEnumeratedFields = xTextFieldsSupplier.getTextFields();</p>
  <p class="Code">        </p>
  <p class="Code">    // iterate over hashtable and insert values into field masters</p>
  <p class="Code">    java.util.Enumeration keys = recipient.keys();</p>
  <p class="Code">    while (keys.hasMoreElements()) {</p>
  <p class="Code">        // get column name</p>
  <p class="Code">        String key = (String)keys.nextElement();</p>
  <p class="Code">            </p>
  <p class="Code">        // access corresponding field master</p>
  <p class="Code">        Object fieldMaster = xNamedFieldMasters.getByName(</p>
  <p class="Code">            "com.sun.star.text.FieldMaster.User." + key);</p>
  <p class="Code">            </p>
  <p class="Code">        // query the XPropertySet interface, we need to set the Content property</p>
  <p class="Code">        XPropertySet xPropertySet = (XPropertySet)UnoRuntime.queryInterface(</p>
  <p class="Code">            XPropertySet.class, fieldMaster);</p>
  <p class="Code">            </p>
  <p class="Code">        // insert the column value into field master</p>
  <p class="Code">        xPropertySet.setPropertyValue("Content", recipient.get(key));</p>
  <p class="Code">    }</p>
  <p class="Code"> </p>
  <p class="Code">    // afterwards we must refresh the textfields collection</p>
  <p class="Code">    XRefreshable xRefreshable = (XRefreshable)UnoRuntime.queryInterface(</p>
  <p class="Code">        XRefreshable.class, xEnumeratedFields);</p>
  <p class="Code">    xRefreshable.refresh();</p>
  <p class="Code"> </p>
  <p class="Code">    // accessing the Bookmarks collection of the document</p>
  <p class="Code">    XNameAccess xNamedBookmarks = xBookmarksSupplier.getBookmarks();</p>
  <p class="Code">        </p>
  <p class="Code">    // find the bookmark named "Subscription"</p>
  <p class="Code">    Object bookmark = xNamedBookmarks.getByName("Subscription");</p>
  <p class="Code"> </p>
  <p class="Code">    // we need its XTextRange which is available from getAnchor(), </p>
  <p class="Code">    // so query for XTextContent</p>
  <p class="Code">    XTextContent xBookmarkContent = (XTextContent)UnoRuntime.queryInterface(</p>
  <p class="Code">        XTextContent.class, bookmark);</p>
  <p class="Code"> </p>
  <p class="Code">    // get the anchor of the bookmark (its XTextRange)</p>
  <p class="Code">    XTextRange xBookmarkRange = xBookmarkContent.getAnchor();</p>
  <p class="Code"> </p>
  <p class="Code">    // set string at the bookmark position</p>
  <p class="Code">    xBookmarkRange.setString("subscription for the Manatee Journal");</p>
  <p class="Code">} </p>
  <h3 class="Head3"><a name="1_1_2_Example_3A_Visible_Cursor_Position" />8.1.2  Example: Visible Cursor Position</h3>
  <p class="Paragraph">As discussed earlier, the OpenOffice.org API distinguishes between the model and controller. This difference is mirrored in two different kinds of cursors in the API: model cursors and visible cursors. The visible cursor is also called view cursor. </p>
  <p class="Paragraph">The second example assumes that the user has selected a text range in a paragraph and expects something to happen at that cursor position. Setting character and paragraph styles, and retrieving the current page number at the view cursor position is demonstrated in the example. The view cursor will be transformed into a model cursor. </p>
  <p class="Paragraph">We want to work with the current document, therefore we cannot use <span class="Codeintext">loadComponentFromURL()</span>. Rather, we ask the <a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/frame/Desktop.html" title="see type com.sun.star.frame.Desktop">com.sun.star.frame.Desktop</a> service for the current component. Once we have the current component—which is our document model—we go from the model to the controller and get the view cursor.</p>
  <p class="Paragraph">The view cursor has properties for the current character and paragraph style. The example uses built-in styles and sets the property <span class="Codeintext">CharStyleName</span> to <span class="Codeintext">"Quotation"</span> and <span class="Codeintext">ParaStyleName</span> to <span class="Codeintext">"Quotations"</span>. Furthermore, the view cursor knows about the automatic page breaks. Because we are interested in the current page number, we get it from the view cursor and print it out.</p>
  <p class="Paragraph">The model cursor is much more powerful than the view cursor when it comes to possible movements and editing capabilities. We create a model cursor from the view cursor. Two steps are necessary: We ask the view cursor for its <span class="Codeintext">Text</span> service, then we have the <span class="Codeintext">Text</span> service create a model cursor based on the current cursor position. The model cursor knows where the paragraph ends, so we go there and insert a string. (<a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/examples/DevelopersGuide/Text/TextDocuments.java" title="goto source Text/TextDocuments.java">Text/TextDocuments.java</a>)</p>
  <p class="Code">/** Sample for document changes, starting at the current view cursor position </p>
  <p class="Code">    The sample changes the paragraph style and the character style at the current</p>
  <p class="Code">    view cursor selection</p>
  <p class="Code">    Open the sample file ViewCursorExampleFile, select some text and run the example</p>
  <p class="Code">    The current paragraph will be set to Quotations paragraph style </p>
  <p class="Code">    The selected text will be set to Quotation character style</p>
  <p class="Code"> */</p>
  <p class="Code">private void viewCursorExample() throws java.lang.Exception { </p>
  <p class="Code">    // get the remote service manager</p>
  <p class="Code">    mxRemoteServiceManager = this.getRemoteServiceManager(unoUrl);</p>
  <p class="Code"> </p>
  <p class="Code">    // get the Desktop service</p>
  <p class="Code">    Object desktop = mxRemoteServiceManager.createInstanceWithContext(</p>
  <p class="Code">        "com.sun.star.frame.Desktop", mxRemoteContext);</p>
  <p class="Code"> </p>
  <p class="Code">    // query its XDesktop interface, we need the current component</p>
  <p class="Code">    XDesktop xDesktop = (XDesktop)UnoRuntime.queryInterface(</p>
  <p class="Code">         XDesktop.class, desktop);</p>
  <p class="Code"> </p>
  <p class="Code">    // retrieve the current component and access the controller</p>
  <p class="Code">    XComponent xCurrentComponent = xDesktop.getCurrentComponent();</p>
  <p class="Code"> </p>
  <p class="Code">    // get the XModel interface from the component</p>
  <p class="Code">    XModel xModel = (XModel)UnoRuntime.queryInterface(XModel.class, xCurrentComponent);</p>
  <p class="Code"> </p>
  <p class="Code">    // the model knows its controller</p>
  <p class="Code">    XController xController = xModel.getCurrentController();</p>
  <p class="Code"> </p>
  <p class="Code">    // the controller gives us the TextViewCursor</p>
  <p class="Code">    // query the viewcursor supplier interface </p>
  <p class="Code">    XTextViewCursorSupplier xViewCursorSupplier = </p>
  <p class="Code">        (XTextViewCursorSupplier)UnoRuntime.queryInterface(</p>
  <p class="Code">            XTextViewCursorSupplier.class, xController);</p>
  <p class="Code"> </p>
  <p class="Code">    // get the cursor </p>
  <p class="Code">    XTextViewCursor xViewCursor = xViewCursorSupplier.getViewCursor();</p>
  <p class="Code">        </p>
  <p class="Code">    // query its XPropertySet interface, we want to set character and paragraph properties</p>
  <p class="Code">    XPropertySet xCursorPropertySet = (XPropertySet)UnoRuntime.queryInterface(</p>
  <p class="Code">        XPropertySet.class, xViewCursor);</p>
  <p class="Code"> </p>
  <p class="Code">    // set the appropriate properties for character and paragraph style</p>
  <p class="Code">    xCursorPropertySet.setPropertyValue("CharStyleName", "Quotation");</p>
  <p class="Code">    xCursorPropertySet.setPropertyValue("ParaStyleName", "Quotations");</p>
  <p class="Code"> </p>
  <p class="Code">    // print the current page number – we need the XPageCursor interface for this</p>
  <p class="Code">    XPageCursor xPageCursor = (XPageCursor)UnoRuntime.queryInterface(</p>
  <p class="Code">        XPageCursor.class, xViewCursor);</p>
  <p class="Code">    System.out.println("The current page number is " + xPageCursor.getPage());</p>
  <p class="Code"> </p>
  <p class="Code">    // the model cursor is much more powerful, so </p>
  <p class="Code">    // we create a model cursor at the current view cursor position with the following steps:</p>
  <p class="Code">    // we get the Text service from the TextViewCursor, the cursor is an XTextRange and has </p>
  <p class="Code">    // therefore a method getText()</p>
  <p class="Code">    XText xDocumentText = xViewCursor.getText();</p>
  <p class="Code"> </p>
  <p class="Code">    // the text creates a model cursor from the viewcursor</p>
  <p class="Code">    XTextCursor xModelCursor = xDocumentText.createTextCursorByRange(xViewCursor.getStart());</p>
  <p class="Code"> </p>
  <p class="Code">    // now we could query XWordCursor, XSentenceCursor and XParagraphCursor</p>
  <p class="Code">    // or XDocumentInsertable, XSortable or XContentEnumerationAccess</p>
  <p class="Code">    // and work with the properties of com.sun.star.text.TextCursor</p>
  <p class="Code">        </p>
  <p class="Code">    // in this case we just go to the end of the paragraph and add some text.</p>
  <p class="Code">    XParagraphCursor xParagraphCursor = (XParagraphCursor)UnoRuntime.queryInterface(</p>
  <p class="Code">    XParagraphCursor.class, xModelCursor);</p>
  <p class="Code"> </p>
  <p class="Code">    // goto the end of the paragraph</p>
  <p class="Code">    xParagraphCursor.gotoEndOfParagraph(false);</p>
  <p class="Code">    xParagraphCursor.setString(" ***** Fin de semana! ******");</p>
  <p class="Code">} </p>
  <h2 class="Head2"><a name="1_2_Handling_Text_Document_Files" />8.2  Handling Text Document Files</h2>
  <h3 class="Head3"><a name="1_2_1_Creating_and_Loading_Text_Documents" />8.2.1  Creating and Loading Text Documents</h3>
  <p class="Paragraph">If a document in OpenOffice.org is required, begin by getting a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/frame/Desktop.html" title="see type com.sun.star.frame.Desktop">com.sun.star.frame.Desktop</a></span> service from the service manager. The desktop handles all document components in OpenOffice.org, among other things. It is discussed thoroughly in the chapter <span class="ChapterRef"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/OfficeDev/OfficeDev.xhtml#1_Office_Development" title="see chapter 7 Office Development">7 Office Development</a></span>. Office documents are often called components, because they support the <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/lang/XComponent.html" title="see type com.sun.star.lang.XComponent">com.sun.star.lang.XComponent</a></span> interface. An <span class="Codeintext">XComponent</span> is a UNO object that can be disposed explicitly and broadcast an event to other UNO objects when this happens.</p>
  <p class="Paragraph">The <span class="Codeintext">Desktop</span> can load new and existing components from a URL. For this purpose it has a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/frame/XComponentLoader.html" title="see type com.sun.star.frame.XComponentLoader">com.sun.star.frame.XComponentLoader</a></span> interface that has one single method to load and instantiate components from a URL into a frame:</p>
  <p class="MethodSignatures">com.sun.star.lang::XComponent <span class="T2">loadComponentFromURL</span>([in] string aURL, </p>
  <p class="MethodSignatures">        [in] string aTargetFrameName, </p>
  <p class="MethodSignatures">        [in] long nSearchFlags, </p>
  <p class="MethodSignatures">        [in] sequence&lt; com::sun::star::beans::PropertyValue &gt; aArgs );</p>
  <p class="Paragraph">The interesting parameters in our context are the URL that describes which resource should be loaded and the sequence of load arguments. For the target frame pass <span class="Codeintext">"_blank"</span> and set the search flags to <span class="Codeintext">0. </span>In most cases you will not want to reuse an existing frame.</p>
  <p class="Paragraph">The URL can be a <span class="Codeintext">file:</span> URL, a <span class="Codeintext">http:</span> URL, an <span class="Codeintext">ftp:</span> URL or a <span class="Codeintext">private:</span> URL. Look up the correct URL format in the load URL box in the function bar of OpenOffice.org. For new writer documents, a special URL scheme has to be used. The scheme is "private:", followed by "factory" as hostname. The resource is "swriter" for  OpenOffice.org writer documents. For a new writer document, use <span class="Codeintext">"private:factory/swriter".</span></p>
  <p class="Paragraph">The load arguments are described in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/document/MediaDescriptor.html" title="see type com.sun.star.document.MediaDescriptor">com.sun.star.document.MediaDescriptor</a></span>. The arguments <span class="Codeintext">AsTemplate</span> and <span class="Codeintext">Hidden</span> have properties that are boolean values. If <span class="Codeintext">AsTemplate</span> is <span class="Codeintext">true</span>, the loader creates a new untitled document from the given URL. If it is <span class="Codeintext">false</span>, template files are loaded for editing. If <span class="Codeintext">Hidden</span> is <span class="Codeintext">true</span>, the document is loaded in the background. This is useful when generating a document in the background without letting the user observe, for example, it can be used to generate a document and print it without previewing. <span class="ChapterRef"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/OfficeDev/OfficeDev.xhtml#1_Office_Development" title="see chapter 7 Office Development">7 Office Development</a></span> describes other available options.</p>
  <p class="Paragraph">The section<span class="T3"> </span><span class="ChapterRef"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/Text/Text.xhtml#1_1_1_Fields_in_a_Template" title="see chapter 8.1.1 Text Documents - Overview - Fields in a Template">8.1.1 Text Documents - Overview - Fields in a Template</a></span> discusses a complete example about how loading works. The following snippet loads a document in hidden mode: (<a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/examples/DevelopersGuide/Text/TextDocuments.java" title="goto source Text/TextDocuments.java">Text/TextDocuments.java</a>)</p>
  <p class="Code">// (the method getRemoteServiceManager is described in the chapter First Steps) </p>
  <p class="Code">mxRemoteServiceManager = this.getRemoteServiceManager(unoUrl); </p>
  <p class="Code"> </p>
  <p class="Code">// retrieve the Desktop object, we need its XComponentLoader </p>
  <p class="Code">Object desktop = mxRemoteServiceManager.createInstanceWithContext( </p>
  <p class="Code">"com.sun.star.frame.Desktop", mxRemoteContext); </p>
  <p class="Code"> </p>
  <p class="Code">// query the XComponentLoader interface from the Desktop service </p>
  <p class="Code">XComponentLoader xComponentLoader = (XComponentLoader)UnoRuntime.queryInterface( </p>
  <p class="Code">    XComponentLoader.class, desktop);</p>
  <p class="Code">        </p>
  <p class="Code">// define load properties according to com.sun.star.document.MediaDescriptor </p>
  <p class="Code"> </p>
  <p class="Code">/* or simply create an empty array of com.sun.star.beans.PropertyValue structs: </p>
  <p class="Code">   PropertyValue[] loadProps = new PropertyValue[0]</p>
  <p class="Code">*/ </p>
  <p class="Code"> </p>
  <p class="Code">// the boolean property Hidden tells the office to open a file in hidden mode </p>
  <p class="Code">PropertyValue[] loadProps = new PropertyValue[1]; </p>
  <p class="Code">loadProps[0] = new PropertyValue(); </p>
  <p class="Code">loadProps[0].Name = "Hidden"; </p>
  <p class="Code">loadProps[0].Value = new Boolean(true);  </p>
  <p class="Code">      </p>
  <p class="Code">// load </p>
  <p class="Code">return xComponentLoader.loadComponentFromURL(loadUrl, "_blank", 0, loadProps);           </p>
  <h3 class="Head3"><a name="1_2_2_Saving_Text_Documents" />8.2.2  Saving Text Documents</h3>
  <h4 class="Head4"><a name="1_2_2_1_Storing" />Storing</h4>
  <p class="Paragraph">Documents are storable through their interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/frame/XStorable.html" title="see type com.sun.star.frame.XStorable">com.sun.star.frame.XStorable</a></span>. This interface is discussed in detail in <span class="ChapterRef"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/OfficeDev/OfficeDev.xhtml#1_Office_Development" title="see chapter 7 Office Development">7 Office Development</a></span>. An <span class="Codeintext">XStorable</span> implements these operations:</p>
  <p class="MethodSignatures">boolean <span class="T2">hasLocation</span>()</p>
  <p class="MethodSignatures">string <span class="T2">getLocation</span>()</p>
  <p class="MethodSignatures">boolean <span class="T2">isReadonly</span>()</p>
  <p class="MethodSignatures">void <span class="T2">store</span>() </p>
  <p class="MethodSignatures">void <span class="T2">storeAsURL</span>( [in] string aURL, sequence&lt; com::sun::star::beans::PropertyValue &gt; aArgs)</p>
  <p class="MethodSignatures">void <span class="T2">storeToURL</span>( [in] string aURL, sequence&lt; com::sun::star::beans::PropertyValue &gt; aArgs)  </p>
  <p class="Paragraph">The method names are evident. The method <span class="Codeintext">storeAsUrl()</span> is the exact representation of <span class="T2">File – Save As</span><span class="T1">,</span><span class="T2"> </span><span class="T1">that is, it changes the current document location. In contrast, </span><span class="Codeintext">storeToUrl()</span> stores a copy to a new location, but leaves the current document URL untouched. </p>
  <h4 class="Head4"><a name="1_2_2_2_Exporting" />Exporting</h4>
  <p class="Paragraph">For exporting purposes, a filter name can be passed to <span class="Codeintext">storeAsURL()</span> and <span class="Codeintext">storeToURL()</span> that triggers an export to other file formats. The property needed for this purpose is the string argument <span class="Codeintext">FilterName </span>that takes filter names defined in the configuration file:</p>
  <p class="Paragraph"><span class="wwwftpemail">&lt;OfficePath&gt;\share\config\registry\modules\org\openoffice\TypeDetection\Filter\*.xcu</span></p>
  <p class="Paragraph">In the <span class="wwwftpemail">*.xcu,</span> look for <span class="Codeintext">&lt;node oor:name=”...”/ oor:op=”replace”&gt;</span> elements, their <span class="Codeintext">oor:name</span> attribute contains the needed strings for <span class="Codeintext">FilterName</span>. The proper filter name for StarWriter 5.x is "StarWriter 5.0", and the export format "MS Word 97" is also popular. This is the element in <span class="wwwftpemail">&lt;OfficePath&gt;\share\config\registry\modules\org\openoffice\TypeDetection\Filter\fcfg_writer_filtewrs.xcu </span>that describes the MS Word 97 filter:</p>
  <p class="P6">&lt;node oor:name="MS Word 97" oor:op="replace"&gt; </p>
  <p class="P6">        &lt;prop oor:name="Flags"&gt;&lt;value&gt;IMPORT EXPORT ALIEN PREFERRED&lt;/value&gt;&lt;/prop&gt;</p>
  <p class="P6">        &lt;prop oor:name="UIComponent"/&gt;</p>
  <p class="P6">        &lt;prop oor:name="FilterService"/&gt;</p>
  <p class="P6">        &lt;prop oor:name="UserData"&gt;&lt;value&gt;CWW8&lt;/value&gt;&lt;/prop&gt;</p>
  <p class="P6">        &lt;prop oor:name="UIName"&gt;</p>
  <p class="P6">                &lt;value xml:lang="x-default"&gt;Microsoft Word 97/2000/XP&lt;/value&gt;</p>
  <p class="P6">        &lt;/prop&gt;</p>
  <p class="P6">        &lt;prop oor:name="FileFormatVersion"&gt;&lt;value&gt;0&lt;/value&gt;&lt;/prop&gt;</p>
  <p class="P6">        &lt;prop oor:name="Type"&gt;&lt;value&gt;writer_MS_Word_97&lt;/value&gt;&lt;/prop&gt;</p>
  <p class="P6">        &lt;prop oor:name="TemplateName"/&gt;</p>
  <p class="P6">        &lt;prop oor:name="DocumentService"&gt;&lt;value&gt;com.sun.star.text.TextDocument&lt;/value&gt;&lt;/prop&gt;</p>
  <p class="P6">&lt;/node&gt; </p>
  <p class="Paragraph">The following method stores a document using this filter: (<a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/examples/DevelopersGuide/Text/TextDocuments.java" title="goto source Text/TextDocuments.java">Text/TextDocuments.java</a>) </p>
  <p class="Code">/** Store a document, using the MS Word 97/2000/XP Filter */ </p>
  <p class="Code">    protected void storeDocComponent(XComponent xDoc, String storeUrl) throws java.lang.Exception {</p>
  <p class="Code">        </p>
  <p class="Code">        XStorable xStorable = (XStorable)UnoRuntime.queryInterface(XStorable.class, xDoc);</p>
  <p class="Code">        PropertyValue[] storeProps = new PropertyValue[1];</p>
  <p class="Code">        storeProps[0] = new PropertyValue();</p>
  <p class="Code">        storeProps[0].Name = "FilterName";</p>
  <p class="Code">        storeProps[0].Value = "MS Word 97";        </p>
  <p class="Code">        xStorable.storeAsURL(storeUrl, storeProps);           </p>
  <p class="Code">    } </p>
  <p class="Paragraph">If an empty array of <span class="Codeintext">PropertyValue</span> structs is passed, the native <span class="wwwftpemail">.odt</span> format of OpenOffice.org is used.</p>
  <h3 class="Head3"><a name="1_2_3_Printing_Text_Documents" />8.2.3  Printing Text Documents</h3>
  <h4 class="Head4"><a name="1_2_3_1_Printer_and_Print_Job_Settings" />Printer and Print Job Settings</h4>
  <p class="Paragraph">Printing is a common office functionality. The chapter  <span class="ChapterRef"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/OfficeDev/OfficeDev.xhtml#1_Office_Development" title="see chapter 7 Office Development">7 Office Development</a></span> provides in-depth information about it. The writer document implements the <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/view/XPrintable.html" title="see type com.sun.star.view.XPrintable">com.sun.star.view.XPrintable</a></span> interface for printing. It consists of three methods:</p>
  <p class="MethodSignatures">sequence&lt; com::sun::star::beans::PropertyValue &gt; <span class="T2">getPrinter </span>()</p>
  <p class="MethodSignatures">void <span class="T2">setPrinter </span>( [in] sequence&lt; com::sun::star::beans::PropertyValue &gt; aPrinter)</p>
  <p class="MethodSignatures">void <span class="T2">print </span>( [in] sequence&lt; com::sun::star::beans::PropertyValue &gt; xOptions)</p>
  <p class="Paragraph">The following code is used with a given document <span class="Codeintext">xDoc</span> to print to the standard printer without any settings: (<a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/examples/DevelopersGuide/Text/TextDocuments.java" title="goto source Text/TextDocuments.java">Text/TextDocuments.java</a>)</p>
  <p class="Code">        // query the XPrintable interface from your document</p>
  <p class="Code">        XPrintable xPrintable = (XPrintable)UnoRuntime.queryInterface(XPrintable.class, xDoc);</p>
  <p class="Code">        </p>
  <p class="Code">        // create an empty printOptions array</p>
  <p class="Code">        PropertyValue[] printOpts = new PropertyValue[0];</p>
  <p class="Code">        </p>
  <p class="Code">        // kick off printing        </p>
  <p class="Code">        xPrintable.<span class="CODEEmphasis">print</span>(printOpts);</p>
  <p class="Paragraph">There are two groups of properties involved in general printing. The first one is used with <span class="Codeintext">setPrinter()</span> and <span class="Codeintext">getPrinter()</span> that controls the printer, and the second one is passed to <span class="Codeintext">print()</span> and controls the print job.</p>
  <p class="Paragraph"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/view/PrinterDescriptor.html" title="see type com.sun.star.view.PrinterDescriptor">com.sun.star.view.PrinterDescriptor</a></span> comprises the properties for the printer:</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table44"><colgroup><col width="216" /><col width="489" /></colgroup><tr><td colspan="2" style="text-align:left;width:4.734cm; " class="Table44A1">
     <p class="TableHead">Properties of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/view/PrinterDescriptor.html" title="see type com.sun.star.view.PrinterDescriptor">com.sun.star.view.PrinterDescriptor</a></span></p>
    </td></tr><tr><td style="text-align:left;width:4.734cm; " class="Table44A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/view/PrinterDescriptor.html#Name" title="see Name of type com.sun.star.view.PrinterDescriptor">Name</a></span></p>
    </td><td style="text-align:left;width:10.705cm; " class="Table44B2">
     <p class="TextInTable"><span class="Codeintext">string</span>  <span class="T4">— S</span>pecifies the name of the printer queue to be used.</p>
    </td></tr><tr><td style="text-align:left;width:4.734cm; " class="Table44A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/view/PrinterDescriptor.html#PaperOrientation" title="see PaperOrientation of type com.sun.star.view.PrinterDescriptor">PaperOrientation</a></span></p>
    </td><td style="text-align:left;width:10.705cm; " class="Table44B2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/view/PaperOrientation.html" title="see type com.sun.star.view.PaperOrientation">com.sun.star.view.PaperOrientation</a></span>. Specifies the orientation of the paper. </p>
    </td></tr><tr><td style="text-align:left;width:4.734cm; " class="Table44A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/view/PrinterDescriptor.html#PaperFormat" title="see PaperFormat of type com.sun.star.view.PrinterDescriptor">PaperFormat</a></span></p>
    </td><td style="text-align:left;width:10.705cm; " class="Table44B2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/view/PaperFormat.html" title="see type com.sun.star.view.PaperFormat">com.sun.star.view.PaperFormat</a></span>. Specifies a predefined paper size or if the paper size is a user-defined size.</p>
    </td></tr><tr><td style="text-align:left;width:4.734cm; " class="Table44A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/view/PrinterDescriptor.html#PaperSize" title="see PaperSize of type com.sun.star.view.PrinterDescriptor">PaperSize</a></span></p>
    </td><td style="text-align:left;width:10.705cm; " class="Table44B2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/awt/Size.html" title="see type com.sun.star.awt.Size">com.sun.star.awt.Size</a></span>. Specifies the size of the paper in 1/100 mm.</p>
    </td></tr><tr><td style="text-align:left;width:4.734cm; " class="Table44A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/view/PrinterDescriptor.html#IsBusy" title="see IsBusy of type com.sun.star.view.PrinterDescriptor">IsBusy</a></span></p>
    </td><td style="text-align:left;width:10.705cm; " class="Table44B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T4">—</span> Indicates if the printer is busy.</p>
    </td></tr><tr><td style="text-align:left;width:4.734cm; " class="Table44A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/view/PrinterDescriptor.html#CanSetPaperOrientation" title="see CanSetPaperOrientation of type com.sun.star.view.PrinterDescriptor">CanSetPaperOrientation</a></span></p>
    </td><td style="text-align:left;width:10.705cm; " class="Table44B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T4">—</span> Indicates if the printer allows changes to <span class="Codeintext">PaperOrientation</span>.</p>
    </td></tr><tr><td style="text-align:left;width:4.734cm; " class="Table44A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/view/PrinterDescriptor.html#CanSetPaperFormat" title="see CanSetPaperFormat of type com.sun.star.view.PrinterDescriptor">CanSetPaperFormat</a></span></p>
    </td><td style="text-align:left;width:10.705cm; " class="Table44B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span>  <span class="T4">— I</span>ndicates if the printer allows changes to PaperFormat.</p>
    </td></tr><tr><td style="text-align:left;width:4.734cm; " class="Table44A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/view/PrinterDescriptor.html#CanSetPaperSize" title="see CanSetPaperSize of type com.sun.star.view.PrinterDescriptor">CanSetPaperSize</a></span></p>
    </td><td style="text-align:left;width:10.705cm; " class="Table44B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span>  <span class="T4">— I</span>ndicates if the printer allows changes to PaperSize.</p>
    </td></tr></table></div>
  <p class="Paragraph"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/view/PrintOptions.html" title="see type com.sun.star.view.PrintOptions">com.sun.star.view.PrintOptions</a></span> contains the following possibilities for a print job:</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table45"><colgroup><col width="216" /><col width="489" /></colgroup><tr><td colspan="2" style="text-align:left;width:4.734cm; " class="Table45A1">
      <p class="TableHead">Properties of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/view/PrintOptions.html" title="see type com.sun.star.view.PrintOptions">com.sun.star.view.PrintOptions</a></span></p>
     </td></tr><tr><td style="text-align:left;width:4.734cm; " class="Table45A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/view/PrintOptions.html#CopyCount" title="see CopyCount of type com.sun.star.view.PrintOptions">CopyCount</a></span></p>
    </td><td style="text-align:left;width:10.705cm; " class="Table45B2">
     <p class="TextInTable"><span class="Codeintext">short</span>  <span class="T4">—</span> Specifies the number of copies to print.</p>
    </td></tr><tr><td style="text-align:left;width:4.734cm; " class="Table45A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/view/PrintOptions.html#FileName" title="see FileName of type com.sun.star.view.PrintOptions">FileName</a></span></p>
    </td><td style="text-align:left;width:10.705cm; " class="Table45B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T4">— S</span>pecifies the name of a file to print to, if set.</p>
    </td></tr><tr><td style="text-align:left;width:4.734cm; " class="Table45A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/view/PrintOptions.html#Collate" title="see Collate of type com.sun.star.view.PrintOptions">Collate</a></span></p>
    </td><td style="text-align:left;width:10.705cm; " class="Table45B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span>  <span class="T4">—</span> Advises the printer to collate the pages of the copies. If <span class="Codeintext">true</span>, a whole document is printed prior to the next copy, otherwise the page copies are completed together.</p>
    </td></tr><tr><td style="text-align:left;width:4.734cm; " class="Table45A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/view/PrintOptions.html#Pages" title="see Pages of type com.sun.star.view.PrintOptions">Pages</a></span></p>
    </td><td style="text-align:left;width:10.705cm; " class="Table45B2">
     <p class="TextInTable"><span class="Codeintext">string</span>  <span class="T4">— </span>Specifies the pages to print in the same format as in the print dialog of the GUI (e.g. "1, 3, 4-7, 9-")</p>
    </td></tr></table></div>
  <p class="Paragraph">The following method uses <span class="Codeintext">PrinterDescriptor</span> and <span class="Codeintext">PrintOptions</span> to print to a special printer,  and preselect the pages to print. (<a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/examples/DevelopersGuide/Text/TextDocuments.java" title="goto source Text/TextDocuments.java">Text/TextDocuments.java</a>)</p>
  <p class="Code">protected void printDocComponent(XComponent xDoc) throws java.lang.Exception { </p>
  <p class="Code">    XPrintable xPrintable = (XPrintable)UnoRuntime.queryInterface(XPrintable.class, xDoc);</p>
  <p class="Code">    PropertyValue[] printerDesc = new PropertyValue[1];</p>
  <p class="Code">    printerDesc[0] = new PropertyValue();</p>
  <p class="Code">    printerDesc[0].Name = "Name";</p>
  <p class="Code">    printerDesc[0].Value = "5D PDF Creator";        </p>
  <p class="Code"> </p>
  <p class="Code">    xPrintable.setPrinter(printerDesc);        </p>
  <p class="Code">        </p>
  <p class="Code">    PropertyValue[] printOpts = new PropertyValue[1];</p>
  <p class="Code">    printOpts[0] = new PropertyValue();</p>
  <p class="Code">    printOpts[0].Name = "Pages";</p>
  <p class="Code">    printOpts[0].Value = "3-5,7";        </p>
  <p class="Code">        </p>
  <p class="Code">    xPrintable.print(printOpts);</p>
  <p class="Code">} </p>
  <h4 class="Head4"><a name="1_2_3_2_Printing_Multiple_Pages_on_one_Page" />Printing Multiple Pages on one Page</h4>
  <p class="Paragraph">The interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XPagePrintable.html" title="see type com.sun.star.text.XPagePrintable">com.sun.star.text.XPagePrintable</a></span> is used to print more than one document page to a single printed page. </p>
  <p class="MethodSignatures">sequence&lt; com::sun::star::beans::PropertyValue &gt; <span class="T2">getPagePrintSettings</span>()</p>
  <p class="MethodSignatures">void <span class="T2">setPagePrintSettings</span>( [in] sequence&lt; com::sun::star::beans::PropertyValue &gt; aSettings)</p>
  <p class="MethodSignatures">void <span class="T2">printPages</span>( [in] sequence&lt; com::sun::star::beans::PropertyValue &gt; xOptions)   </p>
  <p class="Paragraph">The first two methods <span class="Codeintext">getPagePrintSettings()</span> and <span class="Codeintext">setPagePrintSettings()</span> control the page printing. They use a sequence of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/beans/PropertyValue.html" title="see type com.sun.star.beans.PropertyValue">com.sun.star.beans.PropertyValue</a>s</span> whose possible values are defined in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/PagePrintSettings.html" title="see type com.sun.star.text.PagePrintSettings">com.sun.star.text.PagePrintSettings</a></span>:</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table14"><colgroup><col width="222" /><col width="483" /></colgroup><tr><td colspan="2" style="text-align:left;width:4.863cm; " class="Table14A1">
      <p class="TableHead">Properties of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/PagePrintSettings.html" title="see type com.sun.star.text.PagePrintSettings">com.sun.star.text.PagePrintSettings</a></span> </p>
     </td></tr><tr><td style="text-align:left;width:4.863cm; " class="Table14A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/PagePrintSettings.html#PageRows" title="see PageRows of type com.sun.star.text.PagePrintSettings">PageRows</a></span></p>
    </td><td style="text-align:left;width:10.576cm; " class="Table14B2">
     <p class="TextInTable"><span class="Codeintext">short</span>  <span class="T4">— </span>Number of rows in which document pages should appear on the output page.</p>
    </td></tr><tr><td style="text-align:left;width:4.863cm; " class="Table14A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/PagePrintSettings.html#PageColumns" title="see PageColumns of type com.sun.star.text.PagePrintSettings">PageColumns</a></span></p>
    </td><td style="text-align:left;width:10.576cm; " class="Table14B2">
     <p class="TextInTable"><span class="Codeintext">short</span>  <span class="T4">—</span> Number of columns in which document pages should appear on the output page.</p>
    </td></tr><tr><td style="text-align:left;width:4.863cm; " class="Table14A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/PagePrintSettings.html#LeftMargin" title="see LeftMargin of type com.sun.star.text.PagePrintSettings">LeftMargin</a></span></p>
    </td><td style="text-align:left;width:10.576cm; " class="Table14B2">
     <p class="TextInTable"><span class="Codeintext">long</span>  <span class="T4">—</span> Left margin on the output page.</p>
    </td></tr><tr><td style="text-align:left;width:4.863cm; " class="Table14A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/PagePrintSettings.html#RightMargin" title="see RightMargin of type com.sun.star.text.PagePrintSettings">RightMargin</a></span></p>
    </td><td style="text-align:left;width:10.576cm; " class="Table14B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T4">— </span>Right margin on the output page.</p>
    </td></tr><tr><td style="text-align:left;width:4.863cm; " class="Table14A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/PagePrintSettings.html#TopMargin" title="see TopMargin of type com.sun.star.text.PagePrintSettings">TopMargin</a></span></p>
    </td><td style="text-align:left;width:10.576cm; " class="Table14B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T4">—</span> Top margin on the output page.</p>
    </td></tr><tr><td style="text-align:left;width:4.863cm; " class="Table14A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/PagePrintSettings.html#BottomMargin" title="see BottomMargin of type com.sun.star.text.PagePrintSettings">BottomMargin</a></span></p>
    </td><td style="text-align:left;width:10.576cm; " class="Table14B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T4">— </span>Bottom margin on the output page.</p>
    </td></tr><tr><td style="text-align:left;width:4.863cm; " class="Table14A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/PagePrintSettings.html#HoriMargin" title="see HoriMargin of type com.sun.star.text.PagePrintSettings">HoriMargin</a></span></p>
    </td><td style="text-align:left;width:10.576cm; " class="Table14B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T4">— </span>Margin between the columns on the output page.</p>
    </td></tr><tr><td style="text-align:left;width:4.863cm; " class="Table14A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/PagePrintSettings.html#VertMargin" title="see VertMargin of type com.sun.star.text.PagePrintSettings">VertMargin</a></span></p>
    </td><td style="text-align:left;width:10.576cm; " class="Table14B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T4">— </span>Margin between the rows on the output page.</p>
    </td></tr><tr><td style="text-align:left;width:4.863cm; " class="Table14A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/PagePrintSettings.html#IsLandscape" title="see IsLandscape of type com.sun.star.text.PagePrintSettings">IsLandscape</a></span></p>
    </td><td style="text-align:left;width:10.576cm; " class="Table14B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T4">—</span> Determines if the output page is in landscape format.</p>
    </td></tr></table></div>
  <p class="Paragraph">The method <span class="Codeintext">printPages()</span> prints the document according to the previous settings. The argument for the <span class="Codeintext">printPages()</span> method may contain the <span class="Codeintext">PrintOptions</span> as described in the section above (containing the properties <span class="Codeintext">CopyCount</span>, <span class="Codeintext">FileName</span>, <span class="Codeintext">Collate</span> and <span class="Codeintext">Pages</span>).</p>
  <h2 class="Head2"><a name="1_3_Working_with_Text_Documents" />8.3  Working with Text Documents</h2>
  <h3 class="Head3"><a name="1_3_1_Word_Processing" />8.3.1  Word Processing</h3>
  <p class="Paragraph">The text model in Illustration <a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/Text/Text.xhtml#refIllustration0">8.1</a> shows that working with text starts with the method <span class="Codeintext">getText()</span> at the <span class="Codeintext">XTestDocument</span> interface of the document model. It returns a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Text.html" title="see type com.sun.star.text.Text">com.sun.star.text.Text</a></span> service that handles text in OpenOffice.org. </p>
  <p class="Paragraph">The Text service has two mandatory interfaces and no properties: </p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table57"><colgroup><col width="821" /></colgroup><tr><td style="text-align:left;width:17.979cm; " class="Table57A1">
      <div class="Paragraph"><div style="width: 12.363cm; " id="Frame31" class="fr4">
        <div class="Illustration"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/Text/TextServiceSimple.png" title="link to the full-sized graphic &quot;./TextServiceSimple.png&quot;"><img border="0" width="560" height="106" alt="UML diagram showing the of com.sun.star.text.Text service" src="./8 Text Documents_files/TextServiceSimple.png" class="fr3" /></a>Illustration <a name="refIllustration1">8.2</a>: Service com.sun.star.text.Text (mandatory interfaces only)</div>
       </div></div>
     </td></tr></table></div>
  <p class="Paragraph">The<span class="Codeintext"> XText</span> is used to edit a text, and <span class="Codeintext">XEnumerationAccess</span> is used to iterate over text. The following sections discuss these aspects of the Text service.</p>
  <h4 class="Head4"><a name="1_3_1_1_Editing_Text" />Editing Text</h4>
  <p class="P7">As previously discussed in the introductory chapter <span class="ChapterRef"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/FirstSteps/FirstSteps.xhtml#1_First_Steps" title="see chapter 2 First Steps">2 First Steps</a></span>, the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XText.html" title="see type com.sun.star.text.XText">com.sun.star.text.XText</a></span>  incorporates three interfaces: <span class="Codeintext">XText</span>, <span class="Codeintext">XSimpleText</span> and <span class="Codeintext">XTextRange</span>. When working with an <span class="Codeintext">XText</span>, you work with the string it contains, or you insert and remove contents other than strings, such as tables, text fields, and graphics.</p>
  <h5 class="Head5"><a name="1_3_1_1_1_Strings" />Strings</h5>
  <p class="Paragraph">The <span class="Codeintext">XText</span> is handled as a whole. There are two possibilities if the text is handled as one string. The complete string can be set at once, or strings can be added at the beginning or end of the existing text. These are the appropriate methods used for that purpose:</p>
  <p class="MethodSignatures">void <span class="T2">setString</span>( [in] string text)</p>
  <p class="MethodSignatures">String <span class="T2">getString</span>()</p>
  <p class="Paragraph">Consider the following example: (<a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/examples/DevelopersGuide/Text/TextDocuments.java" title="goto source Text/TextDocuments.java">Text/TextDocuments.java</a>) </p>
  <p class="Code">/** Setting the whole text of a document as one string */ </p>
  <p class="Code">protected void BodyTextExample() { </p>
  <p class="Code">    // Body Text and TextDocument example</p>
  <p class="Code">    try {</p>
  <p class="Code">        // demonstrate simple text insertion</p>
  <p class="Code">        mxDocText.setString("This is the new body text of the document." </p>
  <p class="Code">            + "\n\nThis is on the second line.\n\n");</p>
  <p class="Code">    } catch (Exception e) {</p>
  <p class="Code">        e.printStackTrace (System.out);</p>
  <p class="Code">    }</p>
  <p class="Code">} </p>
  <p class="Paragraph">Beginning and end of a text can be determined calling <span class="Codeintext">getStart()</span> and <span class="Codeintext">getEnd()</span>:</p>
  <p class="MethodSignatures">com::sun::star::text::XTextRange <span class="T2">getStart</span>()</p>
  <p class="MethodSignatures">com::sun::star::text::XTextRange <span class="T2">getEnd</span>()</p>
  <p class="Paragraph">The following example adds text using the start and end range of a text: (<a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/examples/DevelopersGuide/Text/TextDocuments.java" title="goto source Text/TextDocuments.java">Text/TextDocuments.java</a>) </p>
  <p class="Code">/** Adding a string at the end or the beginning of text */ </p>
  <p class="Code">protected void TextRangeExample() { </p>
  <p class="Code">    try {</p>
  <p class="Code">        // Get a text range referring to the beginning of the text document</p>
  <p class="Code">        XTextRange xStart = mxDocText.getStart();</p>
  <p class="Code">        // use setString to insert text at the beginning</p>
  <p class="Code">        xStart.setString ("This is text inserted at the beginning.\n\n");</p>
  <p class="Code">        // Get a text range referring to the end of the text document</p>
  <p class="Code">        XTextRange xEnd = mxDocText.getEnd();</p>
  <p class="Code">        // use setString to insert text at the end</p>
  <p class="Code">            xEnd.setString ("This is text inserted at the end.\n\n");</p>
  <p class="Code">    } catch (Exception e) {</p>
  <p class="Code">        e.printStackTrace(System.out);</p>
  <p class="Code">    }</p>
  <p class="Code">} </p>
  <p class="Paragraph">The above code is not very flexible. To gain flexibility, create a text cursor that is a movable text range. Note that such a text cursor is not visible in the user interface. The <span class="Codeintext">XText</span> creates a cursor that works on the model immediately. The following methods can be used to get as many cursors as required:</p>
  <p class="MethodSignatures">com::sun::star::text::XTextCursor <span class="T5">createTextCursor</span>()</p>
  <p class="MethodSignatures">com::sun::star::text::XTextCursor <span class="T5">createTextCursorByRange</span>(<br />                        com::sun::star::text::XTextRange aTextPosition)</p>
  <p class="Paragraph">The text cursor travels through the text as a "collapsed" text range with identical start and end as a point in text, or it can expand while it moves to contain a target string. This is controlled with the  methods of the <span class="Codeintext">XTextCursor</span> interface:</p>
  <p class="MethodSignatures">// moving the cursor </p>
  <p class="MethodSignatures">// if bExpand is true, the cursor expands while it travels </p>
  <p class="MethodSignatures">boolean <span class="T5">goLeft</span>( [in] short nCount, [in] boolean bExpand)</p>
  <p class="MethodSignatures">boolean <span class="T5">goRight</span>( [in] short nCount, [in] boolean bExpand)</p>
  <p class="MethodSignatures">void <span class="T5">gotoStart</span>( [in] boolean bExpand)</p>
  <p class="MethodSignatures">void <span class="T5">gotoEnd</span>( [in] boolean bExpand)</p>
  <p class="MethodSignatures">void <span class="T5">gotoRange</span>( [in] com::sun::star::text::XTextRange xRange, [in] boolean bExpand)</p>
  <p class="MethodSignatures"> </p>
  <p class="MethodSignatures">// controlling the collapsed status of the cursor </p>
  <p class="MethodSignatures">void <span class="T5">collapseToStart</span>()</p>
  <p class="MethodSignatures">void <span class="T5">collapseToEnd</span>()</p>
  <p class="MethodSignatures">boolean <span class="T5">isCollapsed</span>()</p>
  <p class="Paragraph">In writer, a text cursor has three interfaces that inherit from <span class="Codeintext">XTextCursor</span>: <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XWordCursor.html" title="see type com.sun.star.text.XWordCursor">com.sun.star.text.XWordCursor</a></span>, <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XSentenceCursor.html" title="see type com.sun.star.text.XSentenceCursor">com.sun.star.text.XSentenceCursor</a></span> and <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XParagraphCursor.html" title="see type com.sun.star.text.XParagraphCursor">com.sun.star.text.XParagraphCursor</a></span>. These interfaces introduce the following additional movements and status checks:</p>
  <p class="MethodSignatures">boolean <span class="T5">gotoNextWord</span>( [in] boolean bExpand)</p>
  <p class="MethodSignatures">boolean <span class="T5">gotoPreviousWord</span>( [in] boolean bExpand)</p>
  <p class="MethodSignatures">boolean <span class="T5">gotoEndOfWord</span>( [in] boolean bExpand)</p>
  <p class="MethodSignatures">boolean <span class="T5">gotoStartOfWord</span>( [in] boolean bExpand)  </p>
  <p class="MethodSignatures">boolean <span class="T5">isStartOfWord</span>()</p>
  <p class="MethodSignatures">boolean <span class="T5">isEndOfWord</span>()</p>
  <p class="MethodSignatures"> </p>
  <p class="MethodSignatures">boolean <span class="T5">gotoNextSentence</span>( [in] boolean Expand)</p>
  <p class="MethodSignatures">boolean <span class="T5">gotoPreviousSentence</span>( [in] boolean Expand)</p>
  <p class="MethodSignatures">boolean <span class="T5">gotoStartOfSentence</span>( [in] boolean Expand)</p>
  <p class="MethodSignatures">boolean <span class="T5">gotoEndOfSentence</span>( [in] boolean Expand) </p>
  <p class="MethodSignatures">boolean <span class="T5">isStartOfSentence</span>()</p>
  <p class="MethodSignatures">boolean <span class="T5">isEndOfSentence</span>()</p>
  <p class="MethodSignatures"> </p>
  <p class="MethodSignatures">boolean <span class="T5">gotoStartOfParagraph</span>( [in] boolean bExpand)</p>
  <p class="MethodSignatures">boolean <span class="T5">gotoEndOfParagraph</span>( [in] boolean bExpand)</p>
  <p class="MethodSignatures">boolean <span class="T5">gotoNextParagraph</span>( [in] boolean bExpand)</p>
  <p class="MethodSignatures">boolean <span class="T5">gotoPreviousParagraph</span>( [in] boolean bExpand)   </p>
  <p class="MethodSignatures">boolean <span class="T5">isStartOfParagraph</span>()</p>
  <p class="MethodSignatures">boolean <span class="T5">isEndOfParagraph</span>()</p>
  <p class="Paragraph">Since <span class="Codeintext">XTextCursor</span> inherits from <span class="Codeintext">XTextRange</span>, a cursor is an <span class="Codeintext">XTextRange</span> and incorporates the methods of an <span class="Codeintext">XTextRange</span>:</p>
  <p class="MethodSignatures">com::sun::star::text::XText <span class="T5">getText</span>()</p>
  <p class="MethodSignatures">com::sun::star::text::XTextRange <span class="T5">getStart</span>()</p>
  <p class="MethodSignatures">com::sun::star::text::XTextRange <span class="T5">getEnd</span>()</p>
  <p class="MethodSignatures">string <span class="T5">getString</span>()</p>
  <p class="MethodSignatures">void <span class="T5">setString</span>( [in] string aString)</p>
  <p class="Paragraph">The cursor can be told where it is required and the string content can be set later. This does have a drawback. After setting the string, the inserted string is always selected. That means further text can not be added without moving the cursor again. Therefore the most flexible method to insert strings by means of a cursor is the method <span class="Codeintext">insertString()</span> in <span class="Codeintext">XText</span>. It takes an <span class="Codeintext">XTextRange</span> as the target range that is replaced during insertion, a string to insert, and a <span class="Codeintext">boolean</span> parameter that determines if the inserted text should be absorbed by the cursor after it has been inserted. The <span class="Codeintext">XTextRange</span> could be any <span class="Codeintext">XTextRange</span>. The <span class="Codeintext">XTextCursor</span> is an <span class="Codeintext">XTextRange</span>, so it is used here:</p>
  <p class="MethodSignatures">void <span class="T2">insertString</span>( [in] com::sun::star::text::XTextRange xRange,  </p>
  <p class="MethodSignatures">                   [in] string aString,  </p>
  <p class="MethodSignatures">                   [in] boolean bAbsorb) </p>
  <p class="Paragraph">To insert text sequentially the <span class="Codeintext">bAbsorb</span> parameter must be set to <span class="Codeintext">false</span>, so that the <span class="Codeintext">XTextRange</span> collapses at the end of the inserted string after insertion. If <span class="Codeintext">bAbsorb</span> is <span class="Codeintext">true</span>, the text range selects the new inserted string. The string that was selected by the text range prior to insertion is deleted.</p>
  <p class="Paragraph">Consider the use of <span class="Codeintext">insertString() </span>below: (<a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/examples/DevelopersGuide/Text/TextDocuments.java" title="goto source Text/TextDocuments.java">Text/TextDocuments.java</a>)</p>
  <p class="Code">/** moving a text cursor, selecting text and overwriting it */ </p>
  <p class="Code">protected void TextCursorExample() { </p>
  <p class="Code">    try {</p>
  <p class="Code">        // First, get the XSentenceCursor interface of our text cursor</p>
  <p class="Code">        XSentenceCursor xSentenceCursor = (XSentenceCursor)UnoRuntime.queryInterface(</p>
  <p class="Code">            XSentenceCursor.class, mxDocCursor);</p>
  <p class="Code"> </p>
  <p class="Code">        // Goto the next cursor, without selecting it</p>
  <p class="Code">        xSentenceCursor.gotoNextSentence(false);</p>
  <p class="Code"> </p>
  <p class="Code">        // Get the XWordCursor interface of our text cursor</p>
  <p class="Code">        XWordCursor xWordCursor = (XWordCursor) UnoRuntime.queryInterface(</p>
  <p class="Code">            XWordCursor.class, mxDocCursor);</p>
  <p class="Code"> </p>
  <p class="Code">        // Skip the first four words of this sentence and select the fifth</p>
  <p class="Code">        xWordCursor.gotoNextWord(false);</p>
  <p class="Code">        xWordCursor.gotoNextWord(false);</p>
  <p class="Code">        xWordCursor.gotoNextWord(false);</p>
  <p class="Code">        xWordCursor.gotoNextWord(false);</p>
  <p class="Code">        xWordCursor.gotoNextWord(true);</p>
  <p class="Code"> </p>
  <p class="Code">        // Use the XSimpleText interface to insert a word at the current cursor</p>
  <p class="Code">        // location, over-writing</p>
  <p class="Code">        // the current selection (the fifth word selected above)</p>
  <p class="Code">        mxDocText.<span class="T5">insertString</span>(xWordCursor, "old ", true);</p>
  <p class="Code"> </p>
  <p class="Code">        // Access the property set of the cursor, and set the currently selected text</p>
  <p class="Code">        // (which is the string we just inserted) to be bold</p>
  <p class="Code">        XPropertySet xCursorProps = (XPropertySet) UnoRuntime.queryInterface(</p>
  <p class="Code">            XPropertySet.class, mxDocCursor);</p>
  <p class="Code">        xCursorProps.setPropertyValue("CharWeight", new Float(com.sun.star.awt.FontWeight.BOLD));</p>
  <p class="Code"> </p>
  <p class="Code">        // replace the '.' at the end of the sentence with a new string</p>
  <p class="Code">        xSentenceCursor.gotoEndOfSentence(false);</p>
  <p class="Code">        xWordCursor.gotoPreviousWord(true);</p>
  <p class="Code">        mxDocText.<span class="T5">insertString</span>(xWordCursor, </p>
  <p class="Code">            ", which has been changed with text cursors!", true);</p>
  <p class="Code">    } catch (Exception e) {</p>
  <p class="Code">            e.printStackTrace(System.out);</p>
  <p class="Code">    }</p>
  <p class="Code">} </p>
  <h5 class="Head5"><a name="1_3_1_1_2_Text_Contents_Other_Than_Strings" />Text Contents Other Than Strings</h5>
  <p class="Paragraph">Up to this point, paragraphs made up of character strings has been discussed. Text can also contain other objects besides character strings in paragraphs. They all support the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextContent.html" title="see type com.sun.star.text.XTextContent">com.sun.star.text.XTextContent</a></span>. In fact, everything in texts must support <span class="Codeintext">XTextContent</span>. </p>
  <p class="Paragraph">A text content is an object that is attached to a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextRange.html" title="see type com.sun.star.text.XTextRange">com.sun.star.text.XTextRange</a></span>. The text range it is attached to is called the <span class="Emphasis">anchor</span> of the text content.</p>
  <p class="Paragraph">All text contents mentioned below, starting with tables, support the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextContent.html" title="see type com.sun.star.text.TextContent">com.sun.star.text.TextContent</a></span>. It includes the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextContent.html" title="see type com.sun.star.text.XTextContent">com.sun.star.text.XTextContent</a></span> that inherits from the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/lang/XComponent.html" title="see type com.sun.star.lang.XComponent">com.sun.star.lang.XComponent</a></span>. The <span class="Codeintext">TextContent</span> services may have the following properties:</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table39"><colgroup><col width="189" /><col width="516" /></colgroup><tr><td colspan="2" style="text-align:left;width:4.147cm; " class="Table39A1">
      <p class="TableHead">Properties of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextContent.html" title="see type com.sun.star.text.TextContent">com.sun.star.text.TextContent</a></span> </p>
     </td></tr><tr><td style="text-align:left;width:4.147cm; " class="Table39A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextContent.html#AnchorType" title="see AnchorType of type com.sun.star.text.TextContent">AnchorType</a></span></p>
    </td><td style="text-align:left;width:11.292cm; " class="Table39B2">
     <p class="TextInTable">Describes the base the object is positioned to, according to  <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextContentAnchorType.html" title="see type com.sun.star.text.TextContentAnchorType">com.sun.star.text.TextContentAnchorType</a></span>.</p>
    </td></tr><tr><td style="text-align:left;width:4.147cm; " class="Table39A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextContent.html#AnchorTypes" title="see AnchorTypes of type com.sun.star.text.TextContent">AnchorTypes</a></span></p>
    </td><td style="text-align:left;width:11.292cm; " class="Table39B2">
     <p class="TextInTable">A sequence of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextContentAnchorType.html" title="see type com.sun.star.text.TextContentAnchorType">com.sun.star.text.TextContentAnchorType</a></span> that contains all allowed anchor types for the object.</p>
    </td></tr><tr><td style="text-align:left;width:4.147cm; " class="Table39A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextContent.html#TextWrap" title="see TextWrap of type com.sun.star.text.TextContent">TextWrap</a></span></p>
    </td><td style="text-align:left;width:11.292cm; " class="Table39B2">
     <p class="TextInTable">Determines the way the surrounding text flows around the object, according to <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/WrapTextMode.html" title="see type com.sun.star.text.WrapTextMode">com.sun.star.text.WrapTextMode</a></span>.</p>
    </td></tr></table></div>
  <p class="Paragraph">The method <span class="Codeintext">dispose()</span> of the <span class="Codeintext">XComponent</span> interface deletes the object from the document. Since a text content is an <span class="Codeintext">XComponent</span>, <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/lang/XEventListener.html" title="see type com.sun.star.lang.XEventListener">com.sun.star.lang.XEventListener</a></span> can be added or removed with the methods <span class="Codeintext">addEventListener()</span> and <span class="Codeintext">removeEventListener().</span> These methods are called back when the object is disposed. Other events are not supported.</p>
  <p class="Paragraph">The method <span class="Codeintext">getAnchor()</span> at the <span class="Codeintext">XTextContent</span> interface returns a text range which reflects the text position where the object is located. This method may return a void object, for example, for text frames that are bound to a page. The method <span class="Codeintext">getAnchor()</span> is used in situations where an <span class="Codeintext">XTextRange</span> is required. For instance, placeholder fields (<span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/JumpEdit.html" title="see type com.sun.star.text.textfield.JumpEdit">com.sun.star.text.textfield.JumpEdit</a></span>)  can be filled out using their <span class="Codeintext">getAnchor()</span> method. Also, yo can get a bookmark, retrieve its <span class="Codeintext">XTextRange</span> from <span class="Codeintext">getAnchor()</span> and use it to insert a string at the bookmark position.</p>
  <p class="Paragraph">The method <span class="Codeintext">attach()</span> is an intended method to attach text contents to the document, but it is currently not implemented.</p>
  <p class="Paragraph">All text contents—<span class="T6">including</span> paragraphs—can be created by the service manager of the document. They are created using the factory methods <span class="Codeintext">createInstance()</span> or <span class="Codeintext">createInstanceWithArguments() </span>at the <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/lang/XMultiServiceFactory.html" title="see type com.sun.star.lang.XMultiServiceFactory">com.sun.star.lang.XMultiServiceFactory</a></span> interface of the document.</p>
  <p class="Paragraph">All text contents—<span class="T3">except</span><span class="T7"> for </span>paragraphs—can be inserted into text using the <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XText.html" title="see type com.sun.star.text.XText">com.sun.star.text.XText</a></span> method <span class="Codeintext">insertTextContent(). </span>They can be removed by calling <span class="Codeintext">removeTextContent()</span>. Starting with the section <span class="ChapterRef"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/Text/Text.xhtml#1_3_4_Tables" title="see chapter 8.3.4 Text Documents - Working with Text Documents - Tables">8.3.4 Text Documents - Working with Text Documents - Tables</a></span>, there are code samples showing the usage of the document service manager with  <span class="Codeintext">insertTextContent()</span>.</p>
  <p class="MethodSignatures">void <span class="T2">insertTextContent</span>( [in] com::sun::star::text::XTextRange xRange,</p>
  <p class="MethodSignatures">                        [in] com::sun::star::text::XTextContent xContent, boolean bAbsorb);</p>
  <p class="MethodSignatures">void <span class="T2">removeTextContent</span>( [in] com::sun::star::text::XTextContent xContent)   </p>
  <p class="Paragraph">Paragraphs cannot be inserted by <span class="Codeintext">insertTextContent(). </span>Only the interface <span class="Codeintext">XRelativeTextContentInsert </span>can insert paragraphs. A paragraph created by the service manager can be used for creating a new paragraph before or after a table, or a text section positioned at the beginning or the end of page where no cursor can insert new paragraphs. Cf. the section <span class="ChapterRef"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/Text/Text.xhtml#1_3_1_3_Inserting_a_Paraqraph_where_no_Cursor_can_go" title="see chapter 8.3.1 Text Documents - Working with Text Documents - Word Processing - Inserting a Paraqraph where no Cursor can go">8.3.1 Text Documents - Working with Text Documents - Word Processing - Inserting a Paraqraph where no Cursor can go</a></span><span class="T3"> </span>below.</p>
  <h5 class="Head5"><a name="1_3_1_1_3_Control_Characters" />Control Characters</h5>
  <p class="Paragraph">We have used Java escape sequences for paragraph breaks, but this may not be feasible in every language. Moreover, OpenOffice.org supports a number of control characters that can be used. There are two possibilities: use the method  </p>
  <p class="MethodSignatures">void <span class="T2">insertControlCharacter</span>( [in] com::sun::star::text::XTextRange xRange, <br />                             [in] short nControlCharacter, </p>
  <p class="MethodSignatures">                             [in] boolean bAbsorb)</p>
  <p class="Paragraph">to insert single control characters as defined in the constants group <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ControlCharacter.html" title="see type com.sun.star.text.ControlCharacter">com.sun.star.text.ControlCharacter</a></span>, or use the corresponding unicode character from the following list as escape sequence in a string if your language supports it. In Java, Unicode characters in strings can be incorporated using the <span class="Codeintext">\uHHHH</span> escape sequence, where H represents a hexadecimal digit</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table37"><colgroup><col width="190" /><col width="515" /></colgroup><tr><td style="text-align:left;width:4.161cm; " class="Table37A1">
      <p class="TextInTable"><span class="Codeintext">PARAGRAPH_BREAK</span></p>
     </td><td style="text-align:left;width:11.278cm; " class="Table37B1">
      <p class="TextInTable">Insert a paragraph break (UNICODE  0x000D).</p>
     </td></tr><tr><td style="text-align:left;width:4.161cm; " class="Table37A2">
     <p class="TextInTable"><span class="Codeintext">LINE_BREAK</span></p>
    </td><td style="text-align:left;width:11.278cm; " class="Table37B2">
     <p class="TextInTable">Inserts a line break inside of the paragraph (UNICODE  0x000A).</p>
    </td></tr><tr><td style="text-align:left;width:4.161cm; " class="Table37A2">
     <p class="TextInTable"><span class="Codeintext">HARD_HYPHEN</span></p>
    </td><td style="text-align:left;width:11.278cm; " class="Table37B2">
     <p class="TextInTable">A character that appears like a dash, but prevents hyphenation at its position  (UNICODE 0x2011).</p>
    </td></tr><tr><td style="text-align:left;width:4.161cm; " class="Table37A2">
     <p class="TextInTable"><span class="Codeintext">SOFT_HYPHEN</span></p>
    </td><td style="text-align:left;width:11.278cm; " class="Table37B2">
     <p class="TextInTable">Marks a preferred position for hyphenation (UNICODE  0x00AD).</p>
    </td></tr><tr><td style="text-align:left;width:4.161cm; " class="Table37A2">
     <p class="TextInTable"><span class="Codeintext">HARD_SPACE</span></p>
    </td><td style="text-align:left;width:11.278cm; " class="Table37B2">
     <p class="TextInTable">A character that appears like a space, but prevents hyphenation at this point (UNICODE  0x00A0).</p>
    </td></tr><tr><td style="text-align:left;width:4.161cm; " class="Table37A2">
     <p class="TextInTable"><span class="Codeintext">APPEND_PARAGRAPH</span></p>
    </td><td style="text-align:left;width:11.278cm; " class="Table37B2">
     <p class="TextInTable">A new paragraph is appended (no UNICODE for this function). </p>
    </td></tr></table></div>
  <p class="Paragraph">The section <span class="ChapterRef"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/Text/Text.xhtml#1_3_2_Formatting" title="see chapter 8.3.2 Text Documents - Working with Text Documents - Formatting">8.3.2 Text Documents - Working with Text Documents - Formatting</a></span> describes how page breaks are created by setting certain paragraph properties.</p>
  <h4 class="Head4"><a name="1_3_1_2_Iterating_over_Text" />Iterating over Text</h4>
  <p class="Paragraph">The second interface of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Text.html" title="see type com.sun.star.text.Text">com.sun.star.text.Text</a></span> is <span class="Codeintext">XEnumerationAccess</span>. AText service enumerates all paragraphs in a text and returns objects which support <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Paragraph.html" title="see type com.sun.star.text.Paragraph">com.sun.star.text.Paragraph</a></span>. This includes tables, because writer sees tables as specialized paragraphs that support the <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html" title="see type com.sun.star.text.TextTable">com.sun.star.text.TextTable</a></span> service. </p>
  <p class="Paragraph">Paragraphs also have an <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XEnumerationAccess.html" title="see type com.sun.star.container.XEnumerationAccess">com.sun.star.container.XEnumerationAccess</a></span> of their own. They can enumerate every single text portion that they contain. A text portion is a text range containing a uniform piece of information that appears within the text flow. An ordinary paragraph, formatted in a uniform manner and containing nothing but a string, enumerates just a single text portion. In a paragraph that has specially formatted words or other contents, the text portion enumeration  returns one <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextPortion.html" title="see type com.sun.star.text.TextPortion">com.sun.star.text.TextPortion</a></span> service for each differently formatted string, and for every other text content. Text portions include the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextRange.html" title="see type com.sun.star.text.TextRange">com.sun.star.text.TextRange</a></span> and have the properties listed below:</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table41"><colgroup><col width="187" /><col width="518" /></colgroup><tr><td colspan="2" style="text-align:left;width:4.101cm; " class="Table41A1">
     <p class="TableHead">Properties of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextPortion.html" title="see type com.sun.star.text.TextPortion">com.sun.star.text.TextPortion</a></span> </p>
    </td></tr><tr><td style="text-align:left;width:4.101cm; " class="Table41A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextPortion.html#TextPortionType" title="see TextPortionType of type com.sun.star.text.TextPortion">TextPortionType</a></span></p>
    </td><td style="text-align:left;width:11.338cm; " class="Table41B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">— </span>Contains the type of the text portion (see below).</p>
    </td></tr><tr><td style="text-align:left;width:4.101cm; " class="Table41A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextPortion.html#ControlCharacter" title="see ControlCharacter of type com.sun.star.text.TextPortion">ControlCharacter</a></span></p>
    </td><td style="text-align:left;width:11.338cm; " class="Table41B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">— </span>Returns the control character if the text portion contains a control character as defined in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ControlCharacter.html" title="see type com.sun.star.text.ControlCharacter">com.sun.star.text.ControlCharacter</a></span>.</p>
    </td></tr><tr><td style="text-align:left;width:4.101cm; " class="Table41A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextPortion.html#Bookmark" title="see Bookmark of type com.sun.star.text.TextPortion">Bookmark</a></span></p>
    </td><td style="text-align:left;width:11.338cm; " class="Table41B2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextContent.html" title="see type com.sun.star.text.XTextContent">com.sun.star.text.XTextContent</a></span>. Contains the bookmark if the portion has TextPortionType="Bookmark".</p>
    </td></tr><tr><td style="text-align:left;width:4.101cm; " class="Table41A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextPortion.html#IsCollapsed" title="see IsCollapsed of type com.sun.star.text.TextPortion">IsCollapsed</a></span></p>
    </td><td style="text-align:left;width:11.338cm; " class="Table41B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">— </span>Determines whether the portion is a point only.</p>
    </td></tr><tr><td style="text-align:left;width:4.101cm; " class="Table41A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextPortion.html#IsStart" title="see IsStart of type com.sun.star.text.TextPortion">IsStart</a></span></p>
    </td><td style="text-align:left;width:11.338cm; " class="Table41B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">— </span>Determines whether the portion is a start portion if two portions are needed to include an object, that is, <span class="Codeintext">DocmentIndexMark</span>.</p>
    </td></tr></table></div>
  <p class="Paragraph">Possible Values for <span class="Codeintext">TextPortionType</span> are:</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table40"><colgroup><col width="187" /><col width="518" /></colgroup><tr><td style="text-align:left;width:4.098cm; " class="Table40A1">
      <p class="TableHead">TextPortionType (String) </p>
     </td><td style="text-align:left;width:11.342cm; " class="Table40B1">
      <p class="TableHead">Description </p>
     </td></tr><tr><td style="text-align:left;width:4.098cm; " class="Table40A2">
     <p class="TextInTable">“Text” </p>
    </td><td style="text-align:left;width:11.342cm; " class="Table40B2">
     <p class="TextInTable">a portion with mere string content </p>
    </td></tr><tr><td style="text-align:left;width:4.098cm; " class="Table40A2">
     <p class="TextInTable">“TextField” </p>
    </td><td style="text-align:left;width:11.342cm; " class="Table40B2">
     <p class="TextInTable">A <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextField.html" title="see type com.sun.star.text.TextField">com.sun.star.text.TextField</a></span> content.</p>
    </td></tr><tr><td style="text-align:left;width:4.098cm; " class="Table40A2">
     <p class="TextInTable">“TextContent” </p>
    </td><td style="text-align:left;width:11.342cm; " class="Table40B2">
     <p class="TextInTable">A text content supplied through the interface <span class="Codeintext">XContentEnumerationAccess</span>.</p>
    </td></tr><tr><td style="text-align:left;width:4.098cm; " class="Table40A2">
     <p class="TextInTable">“Footnote” </p>
    </td><td style="text-align:left;width:11.342cm; " class="Table40B2">
     <p class="TextInTable">A footnote or an endnote. </p>
    </td></tr><tr><td style="text-align:left;width:4.098cm; " class="Table40A2">
     <p class="TextInTable">“ControlCharacter” </p>
    </td><td style="text-align:left;width:11.342cm; " class="Table40B2">
     <p class="TextInTable">A control character. </p>
    </td></tr><tr><td style="text-align:left;width:4.098cm; " class="Table40A2">
     <p class="TextInTable">“ReferenceMark” </p>
    </td><td style="text-align:left;width:11.342cm; " class="Table40B2">
     <p class="TextInTable">A reference mark. </p>
    </td></tr><tr><td style="text-align:left;width:4.098cm; " class="Table40A2">
     <p class="TextInTable">“DocumentIndexMark” </p>
    </td><td style="text-align:left;width:11.342cm; " class="Table40B2">
     <p class="TextInTable">A document index mark. </p>
    </td></tr><tr><td style="text-align:left;width:4.098cm; " class="Table40A2">
     <p class="TextInTable">“Bookmark” </p>
    </td><td style="text-align:left;width:11.342cm; " class="Table40B2">
     <p class="TextInTable">A bookmark. </p>
    </td></tr><tr><td style="text-align:left;width:4.098cm; " class="Table40A2">
     <p class="TextInTable">“Redline” </p>
    </td><td style="text-align:left;width:11.342cm; " class="Table40B2">
     <p class="TextInTable">A redline portion which is a result of the change tracking feature. </p>
    </td></tr><tr><td style="text-align:left;width:4.098cm; " class="Table40A2">
     <p class="TextInTable">“Ruby” </p>
    </td><td style="text-align:left;width:11.342cm; " class="Table40B2">
     <p class="TextInTable">A ruby attribute which is used in Asian text. </p>
    </td></tr></table></div>
  <p class="Paragraph">The text portion enumeration of a paragraph does not supply contents which do belong to the paragraph, <span class="T1">but do not fuse together with the text flow. These could be text frames, graphic objects, embedded objects or drawing shapes </span>anchored at the paragraph, characters or as character. The <span class="Codeintext">TextPortionType</span> <span class="Codeintext">"TextContent" </span>indicate if there is a content anchored at a character or as a character. If you have a <span class="Codeintext">TextContent</span> portion type, you know that there are shape objects anchored at a character or as a character.</p>
  <p class="Paragraph">This last group of data contained in a text, <span class="Codeintext">Paragraphs</span> and <span class="Codeintext">TextPortions</span> in writer support the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XContentEnumerationAccess.html" title="see type com.sun.star.container.XContentEnumerationAccess">com.sun.star.container.XContentEnumerationAccess</a></span>. This interface tells which text contents besides the text flow contents there are and supplies them as an   <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XEnumeration.html" title="see type com.sun.star.container.XEnumeration">com.sun.star.container.XEnumeration</a></span>:</p>
  <p class="MethodSignatures">sequence&lt; string &gt; <span class="T2">getAvailableServiceNames</span>()</p>
  <p class="MethodSignatures">com::sun::star::container::XEnumeration <span class="T2">createContentEnumeration</span>( [in] string aServiceName)</p>
  <p class="Paragraph">The <span class="Codeintext">XContentEnumerationAccess</span> of the paragraph lists the shape objects anchored at the paragraph while the <span class="Codeintext">XContentEnumerationAccess</span> lists the shape objects anchored at a character or as a  character.</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table6"><colgroup><col width="112" /><col width="709" /></colgroup><tr><td style="text-align:left;width:2.45cm; " class="Table6A1">
      <div class="TableContents"><img width="39" height="39" alt="Note graphics marks a special text section" src="./8 Text Documents_files/interesting.gif" class="fr5" /></div>
     </td><td style="text-align:left;width:15.529cm; " class="Table6B1">
      <p class="TipInTable">Precisely the same enumerations are available for the current text cursor selection. The text cursor enumerates paragraphs, text portions and text contents just like the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Text.html" title="see type com.sun.star.text.Text">com.sun.star.text.Text</a></span> itself.</p>
     </td></tr></table></div>
  <p class="Paragraph">The enumeration access to text through paragraphs and text portions is used if every single paragraph in a text needs to be touched. The application area for this enumeration are export filters,  that uses this enumeration to go over the whole document, writing out the paragraphs to the target file. The following code snippet centers all paragraphs in a text. (<a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/examples/DevelopersGuide/Text/TextDocuments.java" title="goto source Text/TextDocuments.java">Text/TextDocuments.java</a>)</p>
  <p class="Code">/** This method demonstrates how to iterate over paragraphs */ </p>
  <p class="Code">protected void ParagraphExample () { </p>
  <p class="Code">    try {</p>
  <p class="Code">        // The service 'com.sun.star.text.Text' supports the XEnumerationAccess interface to</p>
  <p class="Code">        // provide an enumeration</p>
  <p class="Code">        // of the paragraphs contained by the text the service refers to. </p>
  <p class="Code"> </p>
  <p class="Code">        // Here, we access this interface</p>
  <p class="Code">        XEnumerationAccess xParaAccess = (XEnumerationAccess) UnoRuntime.queryInterface(</p>
  <p class="Code">            XEnumerationAccess.class, mxDocText);</p>
  <p class="Code">        // Call the XEnumerationAccess's only method to access the actual Enumeration</p>
  <p class="Code">        XEnumeration xParaEnum = xParaAccess.createEnumeration();</p>
  <p class="Code"> </p>
  <p class="Code">        // While there are paragraphs, do things to them</p>
  <p class="Code">        while (xParaEnum.hasMoreElements()) {</p>
  <p class="Code">            // Get a reference to the next paragraphs XServiceInfo interface. TextTables</p>
  <p class="Code">            // are also part of this</p>
  <p class="Code">            // enumeration access, so we ask the element if it is a TextTable, if it</p>
  <p class="Code">            // doesn't support the</p>
  <p class="Code">            // com.sun.star.text.TextTable service, then it is safe to assume that it</p>
  <p class="Code">            // really is a paragraph</p>
  <p class="Code">            XServiceInfo xInfo = (XServiceInfo) UnoRuntime.queryInterface(</p>
  <p class="Code">                XServiceInfo.class, xParaEnum.nextElement());</p>
  <p class="Code">            if (!xInfo.supportsService("com.sun.star.text.TextTable")) {</p>
  <p class="Code">                // Access the paragraph's property set...the properties in this</p>
  <p class="Code">                // property set are listed</p>
  <p class="Code">                // in: com.sun.star.style.ParagraphProperties</p>
  <p class="Code">                XPropertySet xSet = (XPropertySet) UnoRuntime.queryInterface(</p>
  <p class="Code">                    XPropertySet.class, xInfo);</p>
  <p class="Code">                // Set the justification to be center justified</p>
  <p class="Code">                xSet.setPropertyValue("ParaAdjust", com.sun.star.style.ParagraphAdjust.CENTER);</p>
  <p class="Code">            }</p>
  <p class="Code">        }</p>
  <p class="Code">    } catch (Exception e) {</p>
  <p class="Code">                e.printStackTrace (System.out);</p>
  <p class="Code">    }</p>
  <p class="Code">} </p>
  <h4 class="Head4"><a name="1_3_1_3_Inserting_a_Paragraph_where_no_Cursor_can_go" />Inserting a Paragraph where no Cursor can go</h4>
  <p class="Paragraph">The service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Text.html" title="see type com.sun.star.text.Text">com.sun.star.text.Text</a></span> has an optional interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XRelativeTextContentInsert.html" title="see type com.sun.star.text.XRelativeTextContentInsert">com.sun.star.text.XRelativeTextContentInsert</a></span> which is available in Text services in writer. The intention of this interface is to insert paragraphs in positions where no cursor or text portion can be located to use the <span class="Codeintext">insertTextContent()</span> method. These situation occurs when text sections or text tables are at the start or end of the document, or if they follow each other directly.</p>
  <p class="MethodSignatures">void <span class="T2">insertTextContentBefore</span>( [in] com::sun::star::text::XTextContent xNewContent,</p>
  <p class="MethodSignatures">                              [in] com::sun::star::text::XTextContent xSuccessor) </p>
  <p class="MethodSignatures">void <span class="T2">insertTextContentAfter</span>( [in] com::sun::star::text::XTextContent xNewContent, </p>
  <p class="MethodSignatures">                             [in] com::sun::star::text::XTextContent xPredecessor) </p>
  <p class="Paragraph">The only supported text contents are <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Paragraph.html" title="see type com.sun.star.text.Paragraph">com.sun.star.text.Paragraph</a></span> as new content, and <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextSection.html" title="see type com.sun.star.text.TextSection">com.sun.star.text.TextSection</a></span> and <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html" title="see type com.sun.star.text.TextTable">com.sun.star.text.TextTable</a></span> as successor or predecessor.      </p>
  <h4 class="Head4"><a name="1_3_1_4_Sorting_Text" />Sorting Text</h4>
  <p class="Paragraph">It is possible to sort text or the content of text tables.  </p>
  <p class="Paragraph">Sorting of text is done by the text cursor that supports <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/util/XSortable.html" title="see type com.sun.star.util.XSortable">com.sun.star.util.XSortable</a></span>. It contains two methods:</p>
  <p class="MethodSignatures">sequence&lt; com::sun::star::beans::PropertyValue &gt; <span class="T2">createSortDescriptor</span>()</p>
  <p class="MethodSignatures">void <span class="T9">sort</span>( [in] sequence&lt; com::sun::star::beans::PropertyValue &gt; xDescriptor)</p>
  <p class="Paragraph">The method <span class="Codeintext">createSortDescriptor()</span> returns a sequence of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/beans/PropertyValue.html" title="see type com.sun.star.beans.PropertyValue">com.sun.star.beans.PropertyValue</a></span> that provides the elements as described in the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextSortDescriptor.html" title="see type com.sun.star.text.TextSortDescriptor">com.sun.star.text.TextSortDescriptor</a></span></p>
  <p class="Paragraph">The method <span class="Codeintext">sort()</span> sorts the text that is selected by the cursor, by the given parameters. </p>
  <p class="Paragraph">Sorting of tables happens directly at the table service, which supports <span class="Codeintext">XSortable</span>. Sorting is a common feature of OpenOffice.org and it is described in detail in <span class="ChapterRef"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/OfficeDev/OfficeDev.xhtml#1_Office_Development" title="see chapter 7 Office Development">7 Office Development</a></span>.</p>
  <h4 class="Head4"><a name="1_3_1_5_Inserting_Text_Files" />Inserting Text Files</h4>
  <p class="Paragraph">The text cursor in writer supports the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/document/XDocumentInsertable.html" title="see type com.sun.star.document.XDocumentInsertable">com.sun.star.document.XDocumentInsertable</a></span> which has a single method to insert a file at the current cursor position:</p>
  <p class="MethodSignatures">void <span class="T2">insertDocumentFromURL</span>( [in] string aURL,  </p>
  <p class="MethodSignatures">                            [in] sequence&lt; com::sun::star::beans::PropertyValue &gt; aOptions)</p>
  <p class="Paragraph">Pass a URL and an empty sequence of <span class="Codeintext">PropertyValue</span> structs. However, load properties could be used as described in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/document/MediaDescriptor.html" title="see type com.sun.star.document.MediaDescriptor">com.sun.star.document.MediaDescriptor</a></span>. </p>
  <h4 class="Head4"><a name="1_3_1_6_Auto_Text" />Auto Text</h4>
  <p class="Paragraph">The auto text function can be used to organize reusable text passages. They allow storing text, including the formatting and all other contents in a text block collection to apply them later. Three services deal with auto text in OpenOffice.org:  </p>
  <ul style="margin-left:0.5cm;">
   <li class="P8" style="margin-left:2.5cm;"><p class="P8" style="margin-left:0cm;"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/AutoTextContainer.html" title="see type com.sun.star.text.AutoTextContainer">com.sun.star.text.AutoTextContainer</a></span> specifies the entire collection of auto texts</p></li>
   <li class="P8" style="margin-left:2.5cm;"><p class="P8" style="margin-left:0cm;"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/AutoTextGroup.html" title="see type com.sun.star.text.AutoTextGroup">com.sun.star.text.AutoTextGroup</a></span> describes a category of  auto texts </p></li>
   <li class="P8" style="margin-left:2.5cm;"><p class="P8" style="margin-left:0cm;"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/AutoTextEntry.html" title="see type com.sun.star.text.AutoTextEntry">com.sun.star.text.AutoTextEntry</a></span> is a single auto text. (<a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/examples/DevelopersGuide/Text/TextDocuments.java" title="goto source Text/TextDocuments.java">Text/TextDocuments.java</a>)</p></li>
  </ul>
  <p class="Code">/** Insert an autotext at the current cursor position of given cursor mxDocCursor*/ </p>
  <p class="Code"> </p>
  <p class="Code">// Get an XNameAccess interface to all auto text groups from the document factory </p>
  <p class="Code">XNameAccess xContainer = (XNameAccess) UnoRuntime.queryInterface(  </p>
  <p class="Code">    XNameAccess.class, mxFactory.createInstance("com.sun.star.text.AutoTextContainer"));</p>
  <p class="Code"> </p>
  <p class="Code">// Get the autotext group Standard </p>
  <p class="Code">xGroup = (XAutoTextGroup) UnoRuntime.queryInterface( </p>
  <p class="Code">    XAutoTextGroup.class, xContainer.getByName("Standard"));</p>
  <p class="Code"> </p>
  <p class="Code">// get the entry Best Wishes (BW) </p>
  <p class="Code">XAutoTextEntry xEntry = (XAutoTextEntry)UnoRuntime.queryInterface (  </p>
  <p class="Code">    XAutoTextEntry.class, xGroup.getByName ("BW"));</p>
  <p class="Code"> </p>
  <p class="Code">// insert the modified autotext block at the cursor position </p>
  <p class="Code">xEntry.applyTo(mxDocCursor); </p>
  <p class="Code"> </p>
  <p class="Code"> </p>
  <p class="Code"> </p>
  <p class="Code">/** Add a new autotext entry to the AutoTextContainer </p>
  <p class="Code">*/ </p>
  <p class="Code">// Select the last paragraph in the document </p>
  <p class="Code">xParaCursor.gotoPreviousParagraph(true); </p>
  <p class="Code"> </p>
  <p class="Code">// Get the XAutoTextContainer interface of the AutoTextContainer service </p>
  <p class="Code">XAutoTextContainer xAutoTextCont = (XAutoTextContainer) UnoRuntime.queryInterface( </p>
  <p class="Code">    XAutoTextContainer.class, xContainer );</p>
  <p class="Code"> </p>
  <p class="Code">// If the APIExampleGroup already exists, remove it so we can add a new one </p>
  <p class="Code">if (xContainer.hasByName("APIExampleGroup")) </p>
  <p class="Code">    xAutoTextCont.removeByName("APIExampleGroup" );</p>
  <p class="Code"> </p>
  <p class="Code">// Create a new auto-text group called APIExampleGroup </p>
  <p class="Code">XAutoTextGroup xNewGroup = xAutoTextCont.insertNewByName ( "APIExampleGroup" ); </p>
  <p class="Code"> </p>
  <p class="Code">// Create and insert a new auto text entry containing the current cursor selection </p>
  <p class="Code">XAutoTextEntry xNewEntry = xNewGroup.insertNewByName( </p>
  <p class="Code">    "NAE", "New AutoTextEntry", xParaCursor);</p>
  <p class="Code"> </p>
  <p class="Code">// Get the XSimpleText and XText interfaces of the new autotext block </p>
  <p class="Code">    XSimpleText xSimpleText = (XSimpleText) UnoRuntime.queryInterface(</p>
  <p class="Code">        XSimpleText.class, xNewEntry);</p>
  <p class="Code">XText xText = (XText) UnoRuntime.queryInterface(XText.class, xNewEntry); </p>
  <p class="Code"> </p>
  <p class="Code">// Insert a string at the beginning of the autotext block </p>
  <p class="Code">xSimpleText.insertString(xText.getStart(),  </p>
  <p class="Code">    "This string was inserted using the API!\n\n", false);</p>
  <p class="Paragraph">The current implementation forces the user to close the <span class="Codeintext">AutoTextEntry</span> instance when they are changed, so that the changes can take effect.  However, the new AutoText is not written to disk until the destructor of the  <span class="Codeintext">AutoTextEntry </span>instance inside the writer is called. When this example has finished executing, the file on disk correctly contains the complete text <span class="Codeintext">"This string was inserted using the API!\n\nSome text for a new autotext block",</span> but there is no way in Java to call the destructor. It is not clear when the garbage collector deletes the object and writes the modifications to disk.</p>
  <h3 class="Head3"><a name="1_3_2_Formatting" />8.3.2  Formatting</h3>
  <p class="Paragraph">A multitude of character, paragraph and other properties are available for text in OpenOffice.org. However, the objects implemented in the writer do not provide properties that support <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/beans/XPropertyChangeListener.html" title="see type com.sun.star.beans.XPropertyChangeListener">com.sun.star.beans.XPropertyChangeListener</a></span> or <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/beans/XVetoableChangeListener.html" title="see type com.sun.star.beans.XVetoableChangeListener">com.sun.star.beans.XVetoableChangeListener</a></span> yet.</p>
  <p class="P9">Character and paragraph properties are available in the following services: </p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table35"><colgroup><col width="292" /><col width="413" /></colgroup><tr><td style="text-align:left;width:6.398cm; " class="Table35A1">
      <p class="TableHead">Services supporting Character <br />and Paragraph  Properties</p>
     </td><td style="text-align:left;width:9.042cm; " class="Table35B1">
      <p class="TableHead">Remark </p>
     </td></tr><tr><td style="text-align:left;width:6.398cm; " class="Table35A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextCursor.html" title="see type com.sun.star.text.TextCursor">com.sun.star.text.TextCursor</a></span></p>
    </td><td style="text-align:left;width:9.042cm; " class="Table35B2">
     <p class="TextInTable">If collapsed, the <span class="Codeintext">CharacterProperties</span> refer to the position on the right hand side of the cursor.</p>
    </td></tr><tr><td style="text-align:left;width:6.398cm; " class="Table35A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Paragraph.html" title="see type com.sun.star.text.Paragraph">com.sun.star.text.Paragraph</a></span></p>
    </td><td style="text-align:left;width:9.042cm; " class="Table35B2">
     <p class="TextInTable"> </p>
    </td></tr><tr><td style="text-align:left;width:6.398cm; " class="Table35A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextPortion.html" title="see type com.sun.star.text.TextPortion">com.sun.star.text.TextPortion</a></span></p>
    </td><td style="text-align:left;width:9.042cm; " class="Table35B2">
     <p class="TextInTable"> </p>
    </td></tr><tr><td style="text-align:left;width:6.398cm; " class="Table35A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTableCursor.html" title="see type com.sun.star.text.TextTableCursor">com.sun.star.text.TextTableCursor</a></span></p>
    </td><td style="text-align:left;width:9.042cm; " class="Table35B2">
     <p class="TextInTable"> </p>
    </td></tr><tr><td style="text-align:left;width:6.398cm; " class="Table35A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Shape.html" title="see type com.sun.star.text.Shape">com.sun.star.text.Shape</a></span></p>
    </td><td style="text-align:left;width:9.042cm; " class="Table35B2">
     <p class="TextInTable"> </p>
    </td></tr><tr><td style="text-align:left;width:6.398cm; " class="Table35A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/table/CellRange.html" title="see type com.sun.star.table.CellRange">com.sun.star.table.CellRange</a></span></p>
    </td><td style="text-align:left;width:9.042cm; " class="Table35B2">
     <p class="TextInTable">In text tables. </p>
    </td></tr><tr><td style="text-align:left;width:6.398cm; " class="Table35A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextDocument.html" title="see type com.sun.star.text.TextDocument">com.sun.star.text.TextDocument</a></span></p>
    </td><td style="text-align:left;width:9.042cm; " class="Table35B2">
     <p class="TextInTable">The model offers a selected number of character properties which apply to the entire document. These are: <span class="Codeintext">CharFontName</span>,<span class="Codeintext">CharFontStyleName</span>, <span class="Codeintext">CharFontFamily</span>, <span class="Codeintext">CharFontCharSet</span>, <span class="Codeintext">CharFontPitch</span> and their Asian counterparts <span class="Codeintext">CharFontStyleNameAsian</span>, <span class="Codeintext">CharFontFamilyAsian</span>, <span class="Codeintext">CharFontCharSetAsian</span>, <span class="Codeintext">CharFontPitchAsian</span>.</p>
    </td></tr></table></div>
  <p class="Paragraph">The character properties are described in the services <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html" title="see type com.sun.star.style.CharacterProperties">com.sun.star.style.CharacterProperties</a></span>, <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterPropertiesAsian.html" title="see type com.sun.star.style.CharacterPropertiesAsian">com.sun.star.style.CharacterPropertiesAsian</a></span> and <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterPropertiesComplex.html" title="see type com.sun.star.style.CharacterPropertiesComplex">com.sun.star.style.CharacterPropertiesComplex</a></span>.</p>
  <p class="Paragraph"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html" title="see type com.sun.star.style.CharacterProperties">com.sun.star.style.CharacterProperties</a></span> describes common character properties for all language zones and character properties in Western text. The following table provides possible values.</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table5"><colgroup><col width="206" /><col width="500" /></colgroup><tr><td colspan="2" style="text-align:left;width:4.501cm; " class="Table5A1">
      <p class="TableHead">Properties of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html" title="see type com.sun.star.style.CharacterProperties">com.sun.star.style.CharacterProperties</a></span></p>
     </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharFontName" title="see CharFontName of type com.sun.star.style.CharacterProperties">CharFontName</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">string </span><span class="T8">— </span>This property specifies the name of the font in western text.</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharFontStyleName" title="see CharFontStyleName of type com.sun.star.style.CharacterProperties">CharFontStyleName</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">string</span>  <span class="T8">— </span>This property contains the name of the font style. </p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharFontFamily" title="see CharFontFamily of type com.sun.star.style.CharacterProperties">CharFontFamily</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">— </span>This property contains font family that is specified in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/awt/FontFamily.html" title="see type com.sun.star.awt.FontFamily">com.sun.star.awt.FontFamily</a></span>. Possible values are: DONTKNOW, DECORATIVE, MODERN, ROMAN, SCRIPT, SWISS, and SYSTEM.</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharFontCharSet" title="see CharFontCharSet of type com.sun.star.style.CharacterProperties">CharFontCharSet</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">short</span>  <span class="T8">— </span>This property contains the text encoding of the font that is specified in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/awt/CharSet.html" title="see type com.sun.star.awt.CharSet">com.sun.star.awt.CharSet</a></span>. Possible values are: DONTKNOW, ANSI MAC, IBMPC_437, IBMPC_850, IBMPC_860, IBMPC_861, IBMPC_863, IBMPC_865, and SYSTEM SYMBOL.</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharFontPitch" title="see CharFontPitch of type com.sun.star.style.CharacterProperties">CharFontPitch</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">short</span>  <span class="T8">— </span>This property contains the font pitch that is specified in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/awt/FontPitch.html" title="see type com.sun.star.awt.FontPitch">com.sun.star.awt.FontPitch</a></span>. The word font pitch refers to characters per inch, but the possible values are  DONTKNOW, FIXED and VARIABLE. VARIABLE points to the difference between proportional and unproportional fonts.</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharColor" title="see CharColor of type com.sun.star.style.CharacterProperties">CharColor</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">long</span>  <span class="T8">— </span>This property contains the value of the text color in ARGB notation. ARGB has four bytes denoting alpha, red, green and blue. In hex notation, this can be used conveniently: <span class="Codeintext">0xAARRGGBB</span>. The AA (Alpha) can be 00 or left out.</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharEscapement" title="see CharEscapement of type com.sun.star.style.CharacterProperties">CharEscapement</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] short</span>  <span class="T8">— </span>Property which contains the relative value of the character height in subscription or superscription.</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharHeight" title="see CharHeight of type com.sun.star.style.CharacterProperties">CharHeight</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">float</span> <span class="T8">— </span>This value contains the height of the characters in point. </p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharUnderline" title="see CharUnderline of type com.sun.star.style.CharacterProperties">CharUnderline</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">— </span>This property contains the value for the character underline that is specified in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/awt/FontUnderline.html" title="see type com.sun.star.awt.FontUnderline">com.sun.star.awt.FontUnderline</a></span>. A lot of underline types are available. Some possible values are SINGLE, DOUBLE, and DOTTED.</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharWeight" title="see CharWeight of type com.sun.star.style.CharacterProperties">CharWeight</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">float</span> <span class="T8">— </span>This property contains the value of the font weight, cf. [<span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/awt/FontWeight.html" title="see type com.sun.star.awt.FontWeight">com.sun.star.awt.FontWeight</a></span>. A lot of weights are possible. The common ones are BOLD and NORMAL.</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharPosture" title="see CharPosture of type com.sun.star.style.CharacterProperties">CharPosture</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">— </span>This property contains the posture of the font as defined in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/awt/FontSlant.html" title="see type com.sun.star.awt.FontSlant">com.sun.star.awt.FontSlant</a></span>. The most common values are ITALIC and NONE.</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharAutoKerning" title="see CharAutoKerning of type com.sun.star.style.CharacterProperties">CharAutoKerning</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">— </span>Property to determine whether the kerning tables from the current font are used. </p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharBackColor" title="see CharBackColor of type com.sun.star.style.CharacterProperties">CharBackColor</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] long</span> <span class="T8">—</span>Property which contains the text background color in ARGB: <span class="Codeintext">0xAARRGGBB</span>.</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharBackTransparent" title="see CharBackTransparent of type com.sun.star.style.CharacterProperties">CharBackTransparent</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">—D</span>etermines if the text background color is set to transparent. </p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharCaseMap" title="see CharCaseMap of type com.sun.star.style.CharacterProperties">CharCaseMap</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] short</span> <span class="T8">— </span>Property which contains the value of the case-mapping of the text for formatting and displaying. Possible CaseMaps are NONE, UPPERCASE, LOWERCASE, TITLE, and SMALLCAPS as defined in the constants group <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CaseMap.html" title="see type com.sun.star.style.CaseMap">com.sun.star.style.CaseMap</a></span>. (optional) </p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharCrossedOut" title="see CharCrossedOut of type com.sun.star.style.CharacterProperties">CharCrossedOut</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] </span> <span class="Codeintext">boolean</span> <span class="T8">— </span>This property is <span class="Codeintext">true</span> if the characters are crossed out.</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharFlash" title="see CharFlash of type com.sun.star.style.CharacterProperties">CharFlash</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] </span> <span class="Codeintext">boolean</span> <span class="T8">— </span>If this optional property is <span class="Codeintext">true</span> , then the characters are flashing</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharStrikeout" title="see CharStrikeout of type com.sun.star.style.CharacterProperties">CharStrikeout</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] short</span> <span class="T8">— </span>Determines the type of the strikethrough of the character as defined in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/awt/FontStrikeout.html" title="see type com.sun.star.awt.FontStrikeout">com.sun.star.awt.FontStrikeout</a></span>. Values are NONE, SINGLE, DOUBLE, DONTKNOW, BOLD, and SLASH X.</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharWordMode" title="see CharWordMode of type com.sun.star.style.CharacterProperties">CharWordMode</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">—</span> If this property is <span class="Codeintext">true</span> , the underline and strike-through properties are not applied to white spaces. </p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharKerning" title="see CharKerning of type com.sun.star.style.CharacterProperties">CharKerning</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] short</span> <span class="T8">— </span>Property which contains the value of the kerning of the characters.</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharLocale" title="see CharLocale of type com.sun.star.style.CharacterProperties">CharLocale</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable">struct <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/lang/Locale.html" title="see type com.sun.star.lang.Locale">com.sun.star.lang.Locale</a></span>. Contains the locale (language and country) of the characters.</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharKeepTogether" title="see CharKeepTogether of type com.sun.star.style.CharacterProperties">CharKeepTogether</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">— </span>Property which marks a range of characters to prevent it from being broken into two lines. </p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharNoLineBreak" title="see CharNoLineBreak of type com.sun.star.style.CharacterProperties">CharNoLineBreak</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">— </span>Property which marks a range of characters to ignore a line break in this area. </p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharShadowed" title="see CharShadowed of type com.sun.star.style.CharacterProperties">CharShadowed</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">— </span><span class="Codeintext">True</span> if the characters are formatted and displayed with a shadow effect. (optional) </p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharFontType" title="see CharFontType of type com.sun.star.style.CharacterProperties">CharFontType</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] short</span> <span class="T8">— </span>Property which specifies the fundamental technology of the font as specified in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/awt/FontType.html" title="see type com.sun.star.awt.FontType">com.sun.star.awt.FontType</a></span>. Possible values are DONTKNOW, RASTER, DEVICE, and SCALABLE.</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharStyleName" title="see CharStyleName of type com.sun.star.style.CharacterProperties">CharStyleName</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] string</span> <span class="T8">— </span>Specifies the name of the style of the font.</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharContoured" title="see CharContoured of type com.sun.star.style.CharacterProperties">CharContoured</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">— </span><span class="Codeintext">True</span> if the characters are formatted and displayed with a contour effect. </p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharCombineIsOn" title="see CharCombineIsOn of type com.sun.star.style.CharacterProperties">CharCombineIsOn</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">—</span> <span class="Codeintext">True</span> if text is formatted in two lines. </p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharCombinePrefix" title="see CharCombinePrefix of type com.sun.star.style.CharacterProperties">CharCombinePrefix</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] string</span> <span class="T8">—</span> Contains the prefix string (usually parenthesis) before text that is formatted in two lines. </p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharCombineSuffix" title="see CharCombineSuffix of type com.sun.star.style.CharacterProperties">CharCombineSuffix</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] string</span> <span class="T8">—</span> Contains the suffix string (usually parenthesis) after text that is formatted in two lines. </p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharEmphasis" title="see CharEmphasis of type com.sun.star.style.CharacterProperties">CharEmphasis</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] short</span> <span class="T8">— </span>Contains the font emphasis value <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/FontEmphasis.html" title="see type com.sun.star.text.FontEmphasis">com.sun.star.text.FontEmphasis</a></span>.</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharRelief" title="see CharRelief of type com.sun.star.style.CharacterProperties">CharRelief</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] short</span> <span class="T8">—</span> Contains the relief value as FontRelief.</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#RubyText" title="see RubyText of type com.sun.star.style.CharacterProperties">RubyText</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] string</span> <span class="T8">— </span>Contains the text that is set as ruby.</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#RubyAdjust" title="see RubyAdjust of type com.sun.star.style.CharacterProperties">RubyAdjust</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] short</span> <span class="T8">— </span>Determines the adjustment of the ruby text as RubyAdjust.</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#RubyCharStyleName" title="see RubyCharStyleName of type com.sun.star.style.CharacterProperties">RubyCharStyleName</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] string</span> <span class="T8">— </span>Contains the name of the character style that is applied to RubyText (optional).</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#RubyIsAbove" title="see RubyIsAbove of type com.sun.star.style.CharacterProperties">RubyIsAbove</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">— </span>Determines whether the ruby text is printed above/left or below/right of the text (optional) .</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharRotation" title="see CharRotation of type com.sun.star.style.CharacterProperties">CharRotation</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] short</span> <span class="T8">— </span>Determines the rotation of a character in degree.</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharRotationIsFitToLine" title="see CharRotationIsFitToLine of type com.sun.star.style.CharacterProperties">CharRotationIsFitToLine</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] short</span> <span class="T8">— </span>Determines whether the text formatting tries to fit rotated text into the surrounded line height.</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharScaleWidth" title="see CharScaleWidth of type com.sun.star.style.CharacterProperties">CharScaleWidth</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] short</span> <span class="T8">—</span> Determines the percentage value of scaling of characters.</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#HyperLinkURL" title="see HyperLinkURL of type com.sun.star.style.CharacterProperties">HyperLinkURL</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] string</span> <span class="T8">— contains the URL of a hyperlink if the URL is set.</span></p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#HyperLinkTarget" title="see HyperLinkTarget of type com.sun.star.style.CharacterProperties">HyperLinkTarget</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] string</span> <span class="T8">— contains the name of the target for a hyperlink if the target is set.</span></p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#HyperLinkName" title="see HyperLinkName of type com.sun.star.style.CharacterProperties">HyperLinkName</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] string</span> <span class="T8">— contains the name of the hyperlink if the name is set.</span></p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#VisitedCharStyleName" title="see VisitedCharStyleName of type com.sun.star.style.CharacterProperties">VisitedCharStyleName</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] string</span> <span class="T8">— Contains the character style name for visited hyperlinks.</span></p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#UnvisitedCharStyleName" title="see UnvisitedCharStyleName of type com.sun.star.style.CharacterProperties">UnvisitedCharStyleName</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] string</span> <span class="T8">— Contains the character style name for unvisited hyperlinks.</span></p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharEscapementHeight" title="see CharEscapementHeight of type com.sun.star.style.CharacterProperties">CharEscapementHeight</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] byte</span> <span class="T8">— This is the additional height used for subscript or superscript characters in units of percent. For subscript characters the value is negative and for superscript characters positive.</span></p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharNoHyphenation" title="see CharNoHyphenation of type com.sun.star.style.CharacterProperties">CharNoHyphenation</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">—</span> <span class="Codeintext">True </span>if the word can be hyphenated at the character.</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharUnderlineColor" title="see CharUnderlineColor of type com.sun.star.style.CharacterProperties">CharUnderlineColor</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/util/Color.html" title="see type com.sun.star.util.Color">Color</a> <span class="T8">— Gives the color of the underline for that character.</span></p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharUnderlineHasColor" title="see CharUnderlineHasColor of type com.sun.star.style.CharacterProperties">CharUnderlineHasColor</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> <span class="Codeintext">True</span> if the CharunderlineColor is used for an underline</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharStyleNames" title="see CharStyleNames of type com.sun.star.style.CharacterProperties">CharStyleNames</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] sequence&lt;string&gt; </span> <span class="T8">— </span> specifies the names of the all styles applied to the font.</p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#CharHidden" title="see CharHidden of type com.sun.star.style.CharacterProperties">CharHidden</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">—</span> <span class="Codeintext">True</span> <span class="T8">if the characters are invisible</span></p>
    </td></tr><tr><td style="text-align:left;width:4.501cm; " class="Table5A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#TextUserDefinedAttributes" title="see TextUserDefinedAttributes of type com.sun.star.style.CharacterProperties">TextUserDefinedAttributes</a></span></p>
    </td><td style="text-align:left;width:10.938cm; " class="Table5B2">
     <p class="TextInTable"><span class="Codeintext">[optional] <a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XNameContainer.html" title="see type com.sun.star.container.XNameContainer">XNameContainer</a></span> <span class="T8">— This property stores xml attributes. They will be saved to and restored from automatic styles inside xml files. </span></p>
    </td></tr></table></div>
  <p class="Paragraph"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterPropertiesAsian.html" title="see type com.sun.star.style.CharacterPropertiesAsian">com.sun.star.style.CharacterPropertiesAsian</a></span> describes properties used in Asian text. All of these properties have a counterpart in <span class="Codeintext">CharacterProperties</span>. They apply as soon as a text is recognized as Asian by the employed Unicode character subset.</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table32"><colgroup><col width="206" /><col width="499" /></colgroup><tr><td colspan="2" style="text-align:left;width:4.521cm; " class="Table32A1">
     <p class="TableHead">Properties of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterPropertiesAsian.html" title="see type com.sun.star.style.CharacterPropertiesAsian">com.sun.star.style.CharacterPropertiesAsian</a></span></p>
    </td></tr><tr><td style="text-align:left;width:4.521cm; " class="Table32A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterPropertiesAsian.html#CharHeightAsian" title="see CharHeightAsian of type com.sun.star.style.CharacterPropertiesAsian">CharHeightAsian</a></span></p>
    </td><td style="text-align:left;width:10.918cm; " class="Table32B2">
     <p class="TextInTable"><span class="Codeintext">float</span> <span class="T8">—</span> This value contains the height of the characters in point. </p>
    </td></tr><tr><td style="text-align:left;width:4.521cm; " class="Table32A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterPropertiesAsian.html#CharWeightAsian" title="see CharWeightAsian of type com.sun.star.style.CharacterPropertiesAsian">CharWeightAsian</a></span></p>
    </td><td style="text-align:left;width:10.918cm; " class="Table32B2">
     <p class="TextInTable"><span class="Codeintext">float</span> <span class="T8">— </span>This property contains the value of the font weight.</p>
    </td></tr><tr><td style="text-align:left;width:4.521cm; " class="Table32A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterPropertiesAsian.html#CharFontNameAsian" title="see CharFontNameAsian of type com.sun.star.style.CharacterPropertiesAsian">CharFontNameAsian</a></span></p>
    </td><td style="text-align:left;width:10.918cm; " class="Table32B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">—</span> This property specifies the name of the font style. </p>
    </td></tr><tr><td style="text-align:left;width:4.521cm; " class="Table32A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterPropertiesAsian.html#CharFontStyleNameAsian" title="see CharFontStyleNameAsian of type com.sun.star.style.CharacterPropertiesAsian">CharFontStyleNameAsian</a></span></p>
    </td><td style="text-align:left;width:10.918cm; " class="Table32B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">— </span>This property contains the name of the font style. </p>
    </td></tr><tr><td style="text-align:left;width:4.521cm; " class="Table32A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterPropertiesAsian.html#CharFontFamilyAsian" title="see CharFontFamilyAsian of type com.sun.star.style.CharacterPropertiesAsian">CharFontFamilyAsian</a></span></p>
    </td><td style="text-align:left;width:10.918cm; " class="Table32B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">— </span>This property contains the font family that is specified in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/awt/FontFamily.html" title="see type com.sun.star.awt.FontFamily">com.sun.star.awt.FontFamily</a></span>.</p>
    </td></tr><tr><td style="text-align:left;width:4.521cm; " class="Table32A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterPropertiesAsian.html#CharFontCharSetAsian" title="see CharFontCharSetAsian of type com.sun.star.style.CharacterPropertiesAsian">CharFontCharSetAsian</a></span></p>
    </td><td style="text-align:left;width:10.918cm; " class="Table32B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">— </span>This property contains the text encoding of the font that is specified in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/awt/CharSet.html" title="see type com.sun.star.awt.CharSet">com.sun.star.awt.CharSet</a></span>.</p>
    </td></tr><tr><td style="text-align:left;width:4.521cm; " class="Table32A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterPropertiesAsian.html#CharFontPitchAsian" title="see CharFontPitchAsian of type com.sun.star.style.CharacterPropertiesAsian">CharFontPitchAsian</a></span></p>
    </td><td style="text-align:left;width:10.918cm; " class="Table32B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">— </span>This property contains the font pitch that is specified in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/awt/FontPitch.html" title="see type com.sun.star.awt.FontPitch">com.sun.star.awt.FontPitch</a></span>.</p>
    </td></tr><tr><td style="text-align:left;width:4.521cm; " class="Table32A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterPropertiesAsian.html#CharPostureAsian" title="see CharPostureAsian of type com.sun.star.style.CharacterPropertiesAsian">CharPostureAsian</a></span></p>
    </td><td style="text-align:left;width:10.918cm; " class="Table32B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">— </span>This property contains the value of the posture of the font as defined in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/awt/FontSlant.html" title="see type com.sun.star.awt.FontSlant">com.sun.star.awt.FontSlant</a></span>. </p>
    </td></tr><tr><td style="text-align:left;width:4.521cm; " class="Table32A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterPropertiesAsian.html#CharLocaleAsian" title="see CharLocaleAsian of type com.sun.star.style.CharacterPropertiesAsian">CharLocaleAsian</a></span></p>
    </td><td style="text-align:left;width:10.918cm; " class="Table32B2">
     <p class="TextInTable">struct <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/lang/Locale.html" title="see type com.sun.star.lang.Locale">com.sun.star.lang.Locale</a></span>  <span class="T8">— C</span>ontains the value of the locale. </p>
    </td></tr></table></div>
  <p class="Paragraph">The complex properties <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterPropertiesComplex.html" title="see type com.sun.star.style.CharacterPropertiesComplex">com.sun.star.style.CharacterPropertiesComplex</a></span> refer to the same character settings as in <span class="Codeintext">CharacterPropertiesAsian</span>, only they have the suffix “Complex” instead of “Asian”.</p>
  <p class="Paragraph"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html" title="see type com.sun.star.style.ParagraphProperties">com.sun.star.style.ParagraphProperties</a></span> comprises paragraph properties.</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table33"><colgroup><col width="197" /><col width="508" /></colgroup><tr><td colspan="2" style="text-align:left;width:4.311cm; " class="Table33A1">
      <p class="TableHead">Properties of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html" title="see type com.sun.star.style.ParagraphProperties">com.sun.star.style.ParagraphProperties</a></span></p>
     </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#ParaAdjust" title="see ParaAdjust of type com.sun.star.style.ParagraphProperties">ParaAdjust</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">— </span>Determines the adjustment of a paragraph. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#ParaLineSpacing" title="see ParaLineSpacing of type com.sun.star.style.ParagraphProperties">ParaLineSpacing</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B2">
     <p class="TextInTable"><span class="Codeintext">[optional] </span>struct <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/LineSpacing.html" title="see type com.sun.star.style.LineSpacing">com.sun.star.style.LineSpacing</a></span> <span class="T8">— </span>Determines the line spacing of a paragraph. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#ParaBackColor" title="see ParaBackColor of type com.sun.star.style.ParagraphProperties">ParaBackColor</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B2">
     <p class="TextInTable"><span class="Codeintext">[optional] long</span> <span class="T8">— </span>Contains the paragraph background color. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#ParaBackTransparent" title="see ParaBackTransparent of type com.sun.star.style.ParagraphProperties">ParaBackTransparent</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B2">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">— </span>This value is <span class="Codeintext">true</span> if the paragraph background color is set to transparent. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#ParaBackGraphicURL" title="see ParaBackGraphicURL of type com.sun.star.style.ParagraphProperties">ParaBackGraphicURL</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B2">
     <p class="TextInTable"><span class="Codeintext">[optional] string</span> <span class="T8">— </span>Contains the value of a link for the background graphic of a paragraph. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#ParaBackGraphicFilter" title="see ParaBackGraphicFilter of type com.sun.star.style.ParagraphProperties">ParaBackGraphicFilter</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B2">
     <p class="TextInTable"><span class="Codeintext">[optional] string</span> <span class="T8">— </span>Contains the name of the graphic filter for the background graphic of a paragraph. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#ParaBackGraphicLocation" title="see ParaBackGraphicLocation of type com.sun.star.style.ParagraphProperties">ParaBackGraphicLocation</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B2">
     <p class="TextInTable"><span class="Codeintext">[optional] long</span> <span class="T8">— </span>Contains the value for the position of a background graphic according to <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/GraphicLocation.html" title="see type com.sun.star.style.GraphicLocation">com.sun.star.style.GraphicLocation</a></span>.</p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#ParaLastLineAdjust" title="see ParaLastLineAdjust of type com.sun.star.style.ParagraphProperties">ParaLastLineAdjust</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">— </span>Determines the adjustment of the last line. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#ParaExpandSingleWord" title="see ParaExpandSingleWord of type com.sun.star.style.ParagraphProperties">ParaExpandSingleWord</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B2">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">— </span>Determines if single words are stretched. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#ParaLeftMargin" title="see ParaLeftMargin of type com.sun.star.style.ParagraphProperties">ParaLeftMargin</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">— </span>Determines the left margin of the paragraph in 1/100 mm. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#ParaRightMargin" title="see ParaRightMargin of type com.sun.star.style.ParagraphProperties">ParaRightMargin</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">— </span>Determines the right margin of the paragraph in 1/100 mm. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#ParaTopMargin" title="see ParaTopMargin of type com.sun.star.style.ParagraphProperties">ParaTopMargin</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">— </span>Determines the top margin of the paragraph in 1/100 mm. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#ParaBottomMargin" title="see ParaBottomMargin of type com.sun.star.style.ParagraphProperties">ParaBottomMargin</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">— </span>Determines the bottom margin of the paragraph in 1/100 mm. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#ParaLineNumberCount" title="see ParaLineNumberCount of type com.sun.star.style.ParagraphProperties">ParaLineNumberCount</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B2">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">— D</span>etermines if the paragraph is included in the line numbering. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#ParaLineNumberStartValue" title="see ParaLineNumberStartValue of type com.sun.star.style.ParagraphProperties">ParaLineNumberStartValue</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B2">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">— </span>Contains the start value for the line numbering. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#ParaIsHyphenation" title="see ParaIsHyphenation of type com.sun.star.style.ParagraphProperties">ParaIsHyphenation</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B2">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">—</span> Prevents the paragraph from getting hyphenated. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#PageDescName" title="see PageDescName of type com.sun.star.style.ParagraphProperties">PageDescName</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B2">
     <p class="TextInTable"><span class="Codeintext">[optional] string</span> <span class="T8">— </span>If this property is set, it creates a page break before the paragraph it belongs to and assigns the value as the name of the new page style sheet to use. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A19">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#PageNumberOffset" title="see PageNumberOffset of type com.sun.star.style.ParagraphProperties">PageNumberOffset</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B19">
     <p class="TextInTable"><span class="Codeintext">[optional] short</span> <span class="T8">— </span>If a page break property is set at a paragraph, this property contains the new value for the page number. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A19">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#PageStyleName" title="see PageStyleName of type com.sun.star.style.ParagraphProperties">PageStyleName</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B19">
     <p class="TextInTable"><span class="Codeintext">[optional] string</span> — Contains the page style name.</p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A19">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#ParaRegisterModeActive" title="see ParaRegisterModeActive of type com.sun.star.style.ParagraphProperties">ParaRegisterModeActive</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B19">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">— </span>Determines if the register mode is applied to a paragraph. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A19">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#ParaTabStops" title="see ParaTabStops of type com.sun.star.style.ParagraphProperties">ParaTabStops</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B19">
     <p class="TextInTable"><span class="Codeintext">[optional] sequence &lt; <a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/TabStop.html" title="see type com.sun.star.style.TabStop">com.sun.star.style.TabStop</a> &gt;</span>. Specifies the positions and kinds of the tab stops within this paragraph. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A19">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#ParaStyleName" title="see ParaStyleName of type com.sun.star.style.ParagraphProperties">ParaStyleName</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B19">
     <p class="TextInTable"><span class="Codeintext">[optional] string</span> <span class="T8">— </span>Contains the name of the current paragraph style. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A19">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#DropCapFormat" title="see DropCapFormat of type com.sun.star.style.ParagraphProperties">DropCapFormat</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B19">
     <p class="TextInTable"><span class="Codeintext">[optional] </span>struct <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/DropCapFormat.html" title="see type com.sun.star.style.DropCapFormat">com.sun.star.style.DropCapFormat</a></span> specifies whether the first characters of the paragraph are displayed in capital letters and how they are formatted. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A19">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#DropCapWholeWord" title="see DropCapWholeWord of type com.sun.star.style.ParagraphProperties">DropCapWholeWord</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B19">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">— </span>Specifies if the property <span class="Codeintext">DropCapFormat</span> is applied to the whole first word. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A19">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#ParaKeepTogether" title="see ParaKeepTogether of type com.sun.star.style.ParagraphProperties">ParaKeepTogether</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B19">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span>  <span class="T8">— </span>Setting this property to <span class="Codeintext">true</span> prevents page or column breaks between this and the following paragraph. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A19">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#ParaSplit" title="see ParaSplit of type com.sun.star.style.ParagraphProperties">ParaSplit</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B19">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">— </span>Setting this property to <span class="Codeintext">false</span> prevents the paragraph from getting split into two pages or columns. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A19">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#NumberingLevel" title="see NumberingLevel of type com.sun.star.style.ParagraphProperties">NumberingLevel</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B19">
     <p class="TextInTable"><span class="Codeintext">[optional] short</span> <span class="T8">— </span>Specifies the numbering level of the paragraph. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A19">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#NumberingRules" title="see NumberingRules of type com.sun.star.style.ParagraphProperties">NumberingRules</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B19">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XIndexReplace.html" title="see type com.sun.star.container.XIndexReplace">com.sun.star.container.XIndexReplace</a></span>. Contains the numbering rules applied to this paragraph. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A19">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#NumberingStartValue" title="see NumberingStartValue of type com.sun.star.style.ParagraphProperties">NumberingStartValue</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B19">
     <p class="TextInTable"><span class="Codeintext">[optional] short</span> <span class="T8">— </span>Specifies the start value for numbering if a new numbering starts at this paragraph. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A19">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#ParaIsNumberingRestart" title="see ParaIsNumberingRestart of type com.sun.star.style.ParagraphProperties">ParaIsNumberingRestart</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B19">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">— </span>Determines if the numbering rules restart, counting at the current paragraph. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A19">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#NumberingStyleName" title="see NumberingStyleName of type com.sun.star.style.ParagraphProperties">NumberingStyleName</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B19">
     <p class="TextInTable"><span class="Codeintext">[optional] string</span> <span class="T8">— S</span>pecifies the name of the style for the numbering. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A19">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#ParaOrphans" title="see ParaOrphans of type com.sun.star.style.ParagraphProperties">ParaOrphans</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B19">
     <p class="TextInTable"><span class="Codeintext">[optional] byte</span> <span class="T8">— </span>Specifies the minimum number of lines of the paragraph that have to be at bottom of a page if the paragraph is spread over more than one page. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A19">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#ParaWidows" title="see ParaWidows of type com.sun.star.style.ParagraphProperties">ParaWidows</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B19">
     <p class="TextInTable"><span class="Codeintext">[optional] byte</span> <span class="T8">—</span> Specifies the minimum number of lines of the paragraph that have to be at top of a page if the paragraph is spread over more than one page. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A19">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html#ParaShadowFormat" title="see ParaShadowFormat of type com.sun.star.style.ParagraphProperties">ParaShadowFormat</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B19">
     <p class="TextInTable"><span class="Codeintext">[optional] </span>struct <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/table/ShadowFormat.html" title="see type com.sun.star.table.ShadowFormat">com.sun.star.table.ShadowFormat</a></span>. Determines the type, color, and size of the shadow. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A19">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphPropertiesAsian.html#ParaIsHangingPunctuation" title="see ParaIsHangingPunctuation of type com.sun.star.style.ParagraphPropertiesAsian">ParaIsHangingPunctuation</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B19">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">—</span> Determines if hanging punctuation is allowed. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A19">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphPropertiesAsian.html#ParaIsCharacterDistance" title="see ParaIsCharacterDistance of type com.sun.star.style.ParagraphPropertiesAsian">ParaIsCharacterDistance</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B19">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">—</span> Determines if a distance between Asian text, western text or complex text is set. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table33A19">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphPropertiesAsian.html#ParaIsForbiddenRules" title="see ParaIsForbiddenRules of type com.sun.star.style.ParagraphPropertiesAsian">ParaIsForbiddenRules</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table33B19">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">— </span>Determines if the the rules for forbidden characters at the start or end of text lines are considered. </p>
    </td></tr></table></div>
  <p class="Paragraph"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphPropertiesAsian.html" title="see type com.sun.star.style.ParagraphPropertiesAsian">com.sun.star.style.ParagraphPropertiesAsian</a></span> describes some further properties used in Asian text.</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table13"><colgroup><col width="197" /><col width="508" /></colgroup><tr><td colspan="2" style="text-align:left;width:4.311cm; " class="Table13A1">
      <p class="TableHead">Properties of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphPropertiesAsian.html" title="see type com.sun.star.style.ParagraphPropertiesAsian">com.sun.star.style.ParagraphPropertiesAsian</a></span></p>
     </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table13A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphPropertiesAsian.html#ParaIsHangingPunctuation" title="see ParaIsHangingPunctuation of type com.sun.star.style.ParagraphPropertiesAsian">ParaIsHangingPunctuation</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table13B2">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">—</span> Determines if hanging punctuation is allowed. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table13A3">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphPropertiesAsian.html#ParaIsCharacterDistance" title="see ParaIsCharacterDistance of type com.sun.star.style.ParagraphPropertiesAsian">ParaIsCharacterDistance</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table13B3">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">—</span> Determines if a distance between Asian text, western text or complex text is set. </p>
    </td></tr><tr><td style="text-align:left;width:4.311cm; " class="Table13A3">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphPropertiesAsian.html#ParaIsForbiddenRules" title="see ParaIsForbiddenRules of type com.sun.star.style.ParagraphPropertiesAsian">ParaIsForbiddenRules</a></span></p>
    </td><td style="text-align:left;width:11.128cm; " class="Table13B3">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">— </span>Determines if the the rules for forbidden characters at the start or end of text lines are considered. </p>
    </td></tr></table></div>
  <p class="Paragraph">Objects supporting these properties support <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/beans/XPropertySet.html" title="see type com.sun.star.beans.XPropertySet">com.sun.star.beans.XPropertySet</a></span>, as well. To change the properties, use the method  <span class="Codeintext">setPropertyValue().</span></p>
  <p class="Code">/** This snippet shows the necessary steps to set a property at the  </p>
  <p class="Code">    current position of a given text cursor mxDocCursor</p>
  <p class="Code">*/ </p>
  <p class="Code"> </p>
  <p class="Code">// query the XPropertySet interface </p>
  <p class="Code">XPropertySet xCursorProps = (XPropertySet) UnoRuntime.queryInterface(XPropertySet.class, mxDocCursor); </p>
  <p class="Code"> </p>
  <p class="Code">// call setPropertyValue, passing in a Float object </p>
  <p class="Code">xCursorProps.setPropertyValue("CharWeight", new Float ( com.sun.star.awt.FontWeight.BOLD)); </p>
  <p class="Paragraph">The same procedure is used for all properties. The more complex properties are described here.  </p>
  <p class="Paragraph">If a change of the page style is required the paragraph property <span class="Codeintext">PageDescName</span>  has to be set using an existing page style name. This forces a page break at the cursor position and the new inserted page uses the requested  page style. The property <span class="Codeintext">PageNumberOffset</span> has to be set to start with a new page count. If inserting an additional paragraph should be avoided, the cursor must be placed at the beginning of the first paragraph before inserting it.</p>
  <p class="Paragraph">If a page break (or a column break) without a change in the used style is required, the property <span class="Codeintext">BreakType</span> is set using the values of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/BreakType.html" title="see type com.sun.star.style.BreakType">com.sun.star.style.BreakType</a></span>:</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table34"><colgroup><col width="132" /><col width="573" /></colgroup><tr><td style="text-align:left;width:2.886cm; " class="Table34A1">
      <p class="TableHead">Page break </p>
     </td><td style="text-align:left;width:12.554cm; " class="Table34B1">
      <p class="TableHead">Description </p>
     </td></tr><tr><td style="text-align:left;width:2.886cm; " class="Table34A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/BreakType.html" title="see type com.sun.star.style.BreakType">BreakType</a></span></p>
    </td><td style="text-align:left;width:12.554cm; " class="Table34B2">
     <p class="TextInTable">Page or column break as described in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/BreakType.html" title="see type com.sun.star.style.BreakType">com.sun.star.style.BreakType</a></span>. Possible values are NONE, COLUMN_BEFORE, COLUMN_AFTER, COLUMN_BOTH, PAGE_BEFORE, PAGE_AFTER, and PAGE_BOTH. Setting the property forces a page or column break at the current text cursor position, paragraph or text table.</p>
    </td></tr></table></div>
  <p class="Paragraph">The property <span class="Codeintext">ParaLineNumberCount</span> is used to include a paragraph in the line numbering. The setting of the line numbering options is done using the property set provided by the <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XLineNumberingProperties.html" title="see type com.sun.star.text.XLineNumberingProperties">com.sun.star.text.XLineNumberingProperties</a></span> interface implemented at the text document model. </p>
  <p class="Paragraph">To create a hyperlink these properties are set at the current cursor position or the current <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Paragraph.html" title="see type com.sun.star.text.Paragraph">com.sun.star.text.Paragraph</a></span> service.</p>
  <p class="Paragraph">Hyperlink properties are not specified for paragraphs in the API reference. </p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table36"><colgroup><col width="310" /><col width="395" /></colgroup><tr><td style="text-align:left;width:6.782cm; " class="Table36A1">
      <p class="TableHead">Hyperlink Properties </p>
     </td><td style="text-align:left;width:8.657cm; " class="Table36B1">
      <p class="TableHead">Description </p>
     </td></tr><tr><td style="text-align:left;width:6.782cm; " class="Table36A2">
     <p class="TextInTable"><span class="Codeintext">HyperLinkURL</span></p>
    </td><td style="text-align:left;width:8.657cm; " class="Table36B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">—</span> Contains the URL.</p>
    </td></tr><tr><td style="text-align:left;width:6.782cm; " class="Table36A2">
     <p class="TextInTable"><span class="Codeintext">HyperLinkTarget</span></p>
    </td><td style="text-align:left;width:8.657cm; " class="Table36B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">—</span> Contains the name of the target frame and can be left blank.</p>
    </td></tr><tr><td style="text-align:left;width:6.782cm; " class="Table36A2">
     <p class="TextInTable"><span class="Codeintext">HyperLinkName</span></p>
    </td><td style="text-align:left;width:8.657cm; " class="Table36B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">—</span> The name of the hyperlink can be left blank.</p>
    </td></tr><tr><td style="text-align:left;">
     <table border="0" cellspacing="0" cellpadding="0" width="100%"><colgroup><col width="310" /></colgroup><tr><td style="text-align:left;width:6.782cm; " class="Table36A2">
        <p class="TextInTable"><span class="Codeintext">UnvisitedCharStyleName</span></p>
       </td></tr><tr><td style="text-align:left;width:6.782cm; " class="Table36A2">
        <p class="TextInTable"><span class="Codeintext">VisitedCharStyleName</span></p>
       </td></tr></table>
    </td><td style="text-align:left;width:8.657cm; " class="Table36B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">—</span> The names of the character styles used to emphasize visited or not visited links. If left blank, the default character styles Internet Link/Visited Internet Link are applied automatically.</p>
    </td></tr><tr><td style="text-align:left;width:6.782cm; " class="Table36A2">
     <p class="TextInTable"><span class="Codeintext">HyperLinkEvents</span></p>
    </td><td style="text-align:left;width:8.657cm; " class="Table36B2">
     <p class="TextInTable">Events attached to the hyperlink. The names of the events are OnClick, OnMouseOver, and OnMouseOut. Each returned event is a sequence of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/beans/PropertyValue.html" title="see type com.sun.star.beans.PropertyValue">com.sun.star.beans.PropertyValue</a></span>, with three elements named EventType, MacroName and Library. All elements contain string values. The EventType contains the value "StarBasic" for OpenOffice.org Basic macros . The macro name contains the path to the macro, for example,  Standard.Module1.Main. The library contains the name of the library.</p>
    </td></tr></table></div>
  <p class="Paragraph">Some properties are connected with each other. There may be side effects or dependencies between the following properties: </p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table38"><colgroup><col width="705" /></colgroup><tr><td style="text-align:left;width:15.439cm; " class="Table38A1">
      <p class="TableHead">Interdependencies between Properties </p>
     </td></tr><tr><td style="text-align:left;width:15.439cm; " class="Table38A2">
     <p class="TextInTable"><span class="Codeintext">ParaRightMargin, ParaLeftMargin, ParaFirstLineIndent, ParaIsAutoFirstLineIndent</span></p>
    </td></tr><tr><td style="text-align:left;width:15.439cm; " class="Table38A2">
     <p class="TextInTable"><span class="Codeintext">ParaTopMargin, ParaBottomMargin</span></p>
    </td></tr><tr><td style="text-align:left;width:15.439cm; " class="Table38A2">
     <p class="TextInTable"><span class="Codeintext">ParaGraphicURL/Filter/Location, ParaBackColor, ParaBackTransparent</span></p>
    </td></tr><tr><td style="text-align:left;width:15.439cm; " class="Table38A2">
     <p class="TextInTable"><span class="Codeintext">ParaIsHyphenation, ParaHyphenationMaxLeadingChars/MaxTrailingChars/MaxHyphens</span></p>
    </td></tr><tr><td style="text-align:left;width:15.439cm; " class="Table38A2">
     <p class="TextInTable"><span class="Codeintext">Left/Right/Top/BottomBorder, Left/Right/Top/BottomBorderDistance, BorerDistance</span></p>
    </td></tr><tr><td style="text-align:left;width:15.439cm; " class="Table38A2">
     <p class="TextInTable"><span class="Codeintext">DropCapFormat, DropCapWholeWord, DropCapCharStyleName</span></p>
    </td></tr><tr><td style="text-align:left;width:15.439cm; " class="Table38A2">
     <p class="TextInTable"><span class="Codeintext">PageDescName, PageNumberOffset, </span><span class="Codeintext"><span class="Codeintext">PageStyleName</span></span></p>
    </td></tr><tr><td style="text-align:left;width:15.439cm; " class="Table38A2">
     <p class="TextInTable"><span class="Codeintext">HyperLinkURL/Name/Target, UnvisitedCharStyleName, VisitedCharStyleName</span></p>
    </td></tr><tr><td style="text-align:left;width:15.439cm; " class="Table38A2">
     <p class="TextInTable"><span class="Codeintext">CharEscapement, CharAutoEscapement, CharEscapementHeight</span></p>
    </td></tr><tr><td style="text-align:left;width:15.439cm; " class="Table38A2">
     <p class="TextInTable"><span class="Codeintext">CharFontName, CharFontStyleName, CharFontFamily, CharFontPitch</span></p>
    </td></tr><tr><td style="text-align:left;width:15.439cm; " class="Table38A2">
     <p class="TextInTable"><span class="Codeintext">CharStrikeOut, CharCrossedOut</span></p>
    </td></tr><tr><td style="text-align:left;width:15.439cm; " class="Table38A2">
     <p class="TextInTable"><span class="Codeintext">CharUnderline, CharUnderlineColor, CharUnderlineHasColor</span></p>
    </td></tr><tr><td style="text-align:left;width:15.439cm; " class="Table38A2">
     <p class="TextInTable"><span class="Codeintext">CharCombineIsOn, CharCombinePrefix, CharCombineSuffix</span></p>
    </td></tr><tr><td style="text-align:left;width:15.439cm; " class="Table38A2">
     <p class="TextInTable"><span class="Codeintext">RubyText, RubyAdjust, RubyCharStyleName, RubyIsAbove</span></p>
    </td></tr></table></div>
  <h3 class="Head3"><a name="1_3_3_Navigating" />8.3.3  Navigating</h3>
  <h4 class="Head4"><a name="1_3_3_1_Cursors" />Cursors</h4>
  <p class="Paragraph">The text <span class="Emphasis">model</span> cursor allows for free navigation over the model by character, words, sentences, or  paragraphs. There can be several model cursors at the same time.  Model cursor creation, movement and usage is discussed in the section <span class="ChapterRef"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/Text/Text.xhtml#1_3_1_Word_Processing" title="see chapter 8.3.1 Text Documents - Working with Text Documents - Word Processing">8.3.1 Text Documents - Working with Text Documents - Word Processing</a></span> <a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/Text/Text.xhtml#TextWork" />. The text model cursors are <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextCursor.html" title="see type com.sun.star.text.TextCursor">com.sun.star.text.TextCursor</a></span> services that are based on the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextCursor.html" title="see type com.sun.star.text.XTextCursor">com.sun.star.text.XTextCursor</a></span>, which is based on <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextRange.html" title="see type com.sun.star.text.XTextRange">com.sun.star.text.XTextRange</a></span>.</p>
  <p class="Paragraph">The text <span class="Emphasis">view</span> cursor enables the user to travel over the document in the view by character, line, screen page and document page. There is only one text view cursor. Certain information about the current layout, such as the number of lines and page number must be retrieved at the view cursor. The chapter <span class="ChapterRef"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/Text/Text.xhtml#1_5_Text_Document_Controller" title="see chapter 8.5 Text Documents - Text Document Controller">8.5 Text Documents - Text Document Controller</a></span> below discusses the view cursor in detail. The text view cursor is a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextViewCursor.html" title="see type com.sun.star.text.TextViewCursor">com.sun.star.text.TextViewCursor</a></span> service that includes <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextLayoutCursor.html" title="see type com.sun.star.text.TextLayoutCursor">com.sun.star.text.TextLayoutCursor</a></span>. </p>
  <h4 class="Head4"><a name="1_3_3_2_Locating_Text_Contents" />Locating Text Contents</h4>
  <p class="Paragraph">The text document model has suppliers that yield all text contents in a document as collections. To find a particular text content, such as bookmarks or text fields, use the appropriate supplier interface. The following supplier interfaces are available at the model: </p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Tabelle1"><colgroup><col width="235" /><col width="470" /></colgroup><tr><td style="text-align:left;width:5.138cm; " class="Tabelle1A1">
      <p class="TableHead">Supplier interfaces </p>
     </td><td style="text-align:left;width:10.301cm; " class="Tabelle1B1">
      <p class="TableHead">Methods </p>
     </td></tr><tr><td style="text-align:left;width:5.138cm; " class="Tabelle1A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextTablesSupplier.html" title="see type com.sun.star.text.XTextTablesSupplier">XTextTablesSupplier</a></span></p>
    </td><td style="text-align:left;width:10.301cm; " class="Tabelle1B2">
     <p class="TextInTable"><span class="T10">Com.sun.star.container.XNameAccess </span><span class="T11">getTextTables</span><span class="T10">() </span></p>
    </td></tr><tr><td style="text-align:left;width:5.138cm; " class="Tabelle1A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextFramesSupplier.html" title="see type com.sun.star.text.XTextFramesSupplier">XTextFramesSupplier</a></span></p>
    </td><td style="text-align:left;width:10.301cm; " class="Tabelle1B2">
     <p class="TextInTable"><span class="T10">com.sun.star.container.XNameAccess </span><span class="T11">getTextFrames</span><span class="T10">()</span></p>
    </td></tr><tr><td style="text-align:left;width:5.138cm; " class="Tabelle1A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextGraphicObjectsSupplier.html" title="see type com.sun.star.text.XTextGraphicObjectsSupplier">XTextGraphicObjectsSupplier</a></span></p>
    </td><td style="text-align:left;width:10.301cm; " class="Tabelle1B2">
     <p class="TextInTable"><span class="T10">com.sun.star.container.XNameAccess </span><span class="T11">getGraphicObjects</span><span class="T10">() </span></p>
    </td></tr><tr><td style="text-align:left;width:5.138cm; " class="Tabelle1A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextEmbeddedObjectsSupplier.html" title="see type com.sun.star.text.XTextEmbeddedObjectsSupplier">XTextEmbeddedObjectsSupplier</a></span></p>
    </td><td style="text-align:left;width:10.301cm; " class="Tabelle1B2">
     <p class="TextInTable"><span class="T10">com.sun.star.container.XNameAccess </span><span class="T11">getEmbeddedObjects</span><span class="T10">() </span></p>
    </td></tr><tr><td style="text-align:left;width:5.138cm; " class="Tabelle1A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextFieldsSupplier.html" title="see type com.sun.star.text.XTextFieldsSupplier">XTextFieldsSupplier</a></span></p>
    </td><td style="text-align:left;width:10.301cm; " class="Tabelle1B2">
     <p class="TextInTable"><span class="T10">com.sun.star.container.XEnumerationAccess </span><span class="T11">getTextFields</span><span class="T10">()<br />com.sun.star.container.XNameAccess </span><span class="T11">getTextFieldMasters</span><span class="T10">()  </span></p>
    </td></tr><tr><td style="text-align:left;width:5.138cm; " class="Tabelle1A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XBookmarksSupplier.html" title="see type com.sun.star.text.XBookmarksSupplier">XBookmarksSupplier</a></span></p>
    </td><td style="text-align:left;width:10.301cm; " class="Tabelle1B2">
     <p class="TextInTable"><span class="T10">com.sun.star.container.XNameAccess </span><span class="T11">getBookmarks</span><span class="T10">()</span></p>
    </td></tr><tr><td style="text-align:left;width:5.138cm; " class="Tabelle1A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XReferenceMarksSupplier.html" title="see type com.sun.star.text.XReferenceMarksSupplier">XReferenceMarksSupplier</a></span></p>
    </td><td style="text-align:left;width:10.301cm; " class="Tabelle1B2">
     <p class="TextInTable"><span class="T10">com.sun.star.container.XNameAccess </span><span class="T11">getReferenceMarks</span><span class="T10">() </span></p>
    </td></tr><tr><td style="text-align:left;width:5.138cm; " class="Tabelle1A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XFootnotesSupplier.html" title="see type com.sun.star.text.XFootnotesSupplier">XFootnotesSupplier</a></span></p>
    </td><td style="text-align:left;width:10.301cm; " class="Tabelle1B2">
     <p class="TextInTable"><span class="T10">com.sun.star.container.XIndexAccess </span><span class="T11">getFootnotes</span><span class="T10">() com.sun.star.beans.XPropertySet </span><span class="T11">getFootnoteSettings</span><span class="T10">()</span></p>
    </td></tr><tr><td style="text-align:left;width:5.138cm; " class="Tabelle1A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XEndnotesSupplier.html" title="see type com.sun.star.text.XEndnotesSupplier">XEndnotesSupplier</a></span></p>
    </td><td style="text-align:left;width:10.301cm; " class="Tabelle1B2">
     <p class="TextInTable"><span class="T10">com.sun.star.container.XIndexAccess </span><span class="T11">getEndnotes</span><span class="T10">()<br />com.sun.star.beans.XPropertySet </span><span class="T11">getEndnoteSettings</span><span class="T10">()</span></p>
    </td></tr><tr><td style="text-align:left;width:5.138cm; " class="Tabelle1A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextSectionsSupplier.html" title="see type com.sun.star.text.XTextSectionsSupplier">XTextSectionsSupplier</a></span></p>
    </td><td style="text-align:left;width:10.301cm; " class="Tabelle1B2">
     <p class="TextInTable"><span class="T10">com.sun.star.container.XNameAccess </span><span class="T11">getTextSections</span><span class="T10">() </span></p>
    </td></tr><tr><td style="text-align:left;width:5.138cm; " class="Tabelle1A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XDocumentIndexesSupplier.html" title="see type com.sun.star.text.XDocumentIndexesSupplier">XDocumentIndexesSupplier</a></span></p>
    </td><td style="text-align:left;width:10.301cm; " class="Tabelle1B2">
     <p class="TextInTable"><span class="T10">com.sun.star.container.XIndexAccess </span><span class="T11">getDocumentIndexes</span><span class="T10">()</span></p>
    </td></tr><tr><td style="text-align:left;width:5.138cm; " class="Tabelle1A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/document/XRedlinesSupplier.html" title="see type com.sun.star.document.XRedlinesSupplier">XRedlinesSupplier</a></span></p>
    </td><td style="text-align:left;width:10.301cm; " class="Tabelle1B2">
     <p class="TextInTable"><span class="T10">com.sun.star.container.XEnumerationAccess </span><span class="T11">getRedlines</span><span class="T10">()</span></p>
    </td></tr></table></div>
  <p class="Paragraph">You can work with text content directly, set properties and use its interfaces, or find out where it is and do an action at the text content location in the text. To find out where a text content is located call the <span class="Codeintext">getAnchor()</span> method at the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextContent.html" title="see type com.sun.star.text.XTextContent">com.sun.star.text.XTextContent</a></span>, which every text content must support.</p>
  <p class="Paragraph">In addition, text contents located at the current text cursor position or the content where the cursor is currently located are provided in the <span class="Codeintext">PropertySet</span> of the cursor. The corresponding cursor properties are:</p>
  <ul style="margin-left:0.5cm;">
   <li class="P10" style="margin-left:2.5cm;"><p class="P10" style="margin-left:0cm;"><span class="Codeintext">DocumentIndexMark</span></p></li>
   <li class="P10" style="margin-left:2.5cm;"><p class="P10" style="margin-left:0cm;"><span class="Codeintext">TextField</span></p></li>
   <li class="P10" style="margin-left:2.5cm;"><p class="P10" style="margin-left:0cm;"><span class="Codeintext">ReferenceMark</span></p></li>
   <li class="P10" style="margin-left:2.5cm;"><p class="P10" style="margin-left:0cm;"><span class="Codeintext">Footnote</span></p></li>
   <li class="P10" style="margin-left:2.5cm;"><p class="P10" style="margin-left:0cm;"><span class="Codeintext">Endnote</span></p></li>
   <li class="P10" style="margin-left:2.5cm;"><p class="P10" style="margin-left:0cm;"><span class="Codeintext">DocumentIndex</span></p></li>
   <li class="P10" style="margin-left:2.5cm;"><p class="P10" style="margin-left:0cm;"><span class="Codeintext">TextTable</span></p></li>
   <li class="P10" style="margin-left:2.5cm;"><p class="P10" style="margin-left:0cm;"><span class="Codeintext">TextFrame</span></p></li>
   <li class="P10" style="margin-left:2.5cm;"><p class="P10" style="margin-left:0cm;"><span class="Codeintext">Cell</span></p></li>
   <li class="P10" style="margin-left:2.5cm;"><p class="P10" style="margin-left:0cm;"><span class="Codeintext">TextSection</span></p></li>
  </ul>
  <h4 class="Head4"><a name="1_3_3_3_Search_and_Replace" />Search and Replace</h4>
  <p class="Paragraph">The writer model supports the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/util/XReplaceable.html" title="see type com.sun.star.util.XReplaceable">com.sun.star.util.XReplaceable</a></span> that inherits from the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/util/XSearchable.html" title="see type com.sun.star.util.XSearchable">com.sun.star.util.XSearchable</a></span> for searching and replacing in text. It contains the following methods:</p>
  <p class="MethodSignatures">com::sun::star::util::util.XSearchDescriptor <span class="T2">createSearchDescriptor</span>() </p>
  <p class="MethodSignatures">com::sun::star::util::XReplaceDescriptor <span class="T2">createReplaceDescriptor</span>() </p>
  <p class="MethodSignatures"> </p>
  <p class="MethodSignatures">com::sun::star::uno::XInterface <span class="T2">findFirst</span>( [in] com::sun::star::util::XSearchDescriptor xDesc) </p>
  <p class="MethodSignatures">com::sun::star::uno::XInterface <span class="T2">findNext</span>( [in] com::sun::star::uno::XInterface xStartAt,</p>
  <p class="MethodSignatures">                                          [in] com::sun::star::util::XSearchDescriptor xDesc) </p>
  <p class="MethodSignatures">com::sun::star::container::XIndexAccess <span class="T2">findAll</span>( [in] com::sun::star::util::XSearchDescriptor xDesc) </p>
  <p class="MethodSignatures"> </p>
  <p class="MethodSignatures">long <span class="T2">replaceAll</span>( [in] com::sun::star::util::XSearchDescriptor xDesc)</p>
  <p class="Paragraph">To search or replace text, first create a descriptor service using <span class="Codeintext">createSearchDescriptor()</span> or <span class="Codeintext">createReplaceDescriptor()</span>. You receive a service that supports the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/util/XPropertyReplace.html" title="see type com.sun.star.util.XPropertyReplace">com.sun.star.util.XPropertyReplace</a></span> with methods to describe what you are searching for, what you want to replace with and what attributes you are looking for. It is described in detail below.</p>
  <p class="Paragraph">Pass in this descriptor to the methods <span class="Codeintext">findFirst()</span>, <span class="Codeintext">findNext()</span>, <span class="Codeintext">findAll()</span> or <span class="Codeintext">replaceAll()</span>.</p>
  <p class="Paragraph">The methods <span class="Codeintext">findFirst()</span> and <span class="Codeintext">findNext()</span> return a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/uno/XInterface.html" title="see type com.sun.star.uno.XInterface">com.sun.star.uno.XInterface</a></span> pointing to an object that contains the found item. If the search is not successful, a null reference to  an <span class="Codeintext">XInterface </span>is returned, that is, if you try to query other interfaces from it, <span class="Codeintext">null </span>is returned. The method <span class="Codeintext">findAll()</span> returns a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XIndexAccess.html" title="see type com.sun.star.container.XIndexAccess">com.sun.star.container.XIndexAccess</a></span> containing one or more <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/uno/XInterface.html" title="see type com.sun.star.uno.XInterface">com.sun.star.uno.XInterface</a></span> pointing to the found text ranges or if they failed an empty interface. The method <span class="Codeintext">replaceAll()</span> returns the number of replaced occurrences only.</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Tabelle2"><colgroup><col width="821" /></colgroup><tr><td style="text-align:left;width:17.979cm; " class="Tabelle2A1">
      <div class="Paragraph"><div style="width: 9.239cm; " id="Frame3" class="fr6">
        <div class="Illustration"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/Text/XPropertyReplace.png" title="link to the full-sized graphic &quot;./XPropertyReplace.png&quot;"><img border="0" width="416" height="733" alt="UML diagram showing the com.sun.star.util.XPropertyReplace interface" src="./8 Text Documents_files/XPropertyReplace.png" class="fr7" /></a>Illustration <a name="refIllustration2">8.3</a>: XPropertyReplace</div>
       </div></div>
     </td></tr></table></div>
  <p class="Paragraph">The interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/util/XPropertyReplace.html" title="see type com.sun.star.util.XPropertyReplace">com.sun.star.util.XPropertyReplace</a></span> is required to describe your search. It is a powerful interface and inherits from <span class="Codeintext">XReplaceDescriptor</span>, <span class="Codeintext">XSearchDescriptor</span> and <span class="Codeintext">XPropertySet.</span></p>
  <p class="Paragraph">The target of your search is described by a string containing a search text or a style name using <span class="Codeintext">setSearchString()</span>. Correspondingly, provide the text string or style name that should replace the found occurrence of the search target to the <span class="Codeintext">XReplaceDescriptor</span> using <span class="Codeintext">setReplaceString()</span>. Refine the search mode through the properties included in the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/util/SearchDescriptor.html" title="see type com.sun.star.util.SearchDescriptor">com.sun.star.util.SearchDescriptor</a></span>:</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Tabelle3"><colgroup><col width="351" /><col width="354" /></colgroup><tr><td colspan="2" style="text-align:left;width:7.682cm; " class="Tabelle3A1">
      <p class="TableHead">Properties of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/util/SearchDescriptor.html" title="see type com.sun.star.util.SearchDescriptor">com.sun.star.util.SearchDescriptor</a></span></p>
     </td></tr><tr><td style="text-align:left;width:7.682cm; " class="Tabelle3A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/util/SearchDescriptor.html#SearchBackwards" title="see SearchBackwards of type com.sun.star.util.SearchDescriptor">SearchBackwards</a></span></p>
    </td><td style="text-align:left;width:7.758cm; " class="Tabelle3B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> Search backward</p>
    </td></tr><tr><td style="text-align:left;width:7.682cm; " class="Tabelle3A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/util/SearchDescriptor.html#SearchCaseSensitive" title="see SearchCaseSensitive of type com.sun.star.util.SearchDescriptor">SearchCaseSensitive</a></span></p>
    </td><td style="text-align:left;width:7.758cm; " class="Tabelle3B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span>  <span class="T8">—</span>Search is case sensitive.</p>
    </td></tr><tr><td style="text-align:left;width:7.682cm; " class="Tabelle3A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/util/SearchDescriptor.html#SearchRegularExpression" title="see SearchRegularExpression of type com.sun.star.util.SearchDescriptor">SearchRegularExpression</a></span></p>
    </td><td style="text-align:left;width:7.758cm; " class="Tabelle3B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span>  <span class="T8">—</span>Search interpreting the search string as a  regular expression.</p>
    </td></tr><tr><td style="text-align:left;width:7.682cm; " class="Tabelle3A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/util/SearchDescriptor.html#SearchSimilarity" title="see SearchSimilarity of type com.sun.star.util.SearchDescriptor">SearchSimilarity</a></span></p>
    </td><td style="text-align:left;width:7.758cm; " class="Tabelle3B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> Use similarity search using the four following options:</p>
    </td></tr><tr><td style="text-align:left;width:7.682cm; " class="Tabelle3A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/util/SearchDescriptor.html#SearchSimilarityAdd" title="see SearchSimilarityAdd of type com.sun.star.util.SearchDescriptor">SearchSimilarityAdd</a></span></p>
    </td><td style="text-align:left;width:7.758cm; " class="Tabelle3B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">—</span> Determines the number of characters the word in the document may be longer than the search string for it to remain valid.</p>
    </td></tr><tr><td style="text-align:left;width:7.682cm; " class="Tabelle3A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/util/SearchDescriptor.html#SearchSimilarityExchange" title="see SearchSimilarityExchange of type com.sun.star.util.SearchDescriptor">SearchSimilarityExchange</a></span></p>
    </td><td style="text-align:left;width:7.758cm; " class="Tabelle3B2">
     <p class="TextInTable"><span class="Codeintext">short</span>  <span class="T8">—</span>Determines how many characters in the search term can be exchanged.</p>
    </td></tr><tr><td style="text-align:left;width:7.682cm; " class="Tabelle3A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/util/SearchDescriptor.html#SearchSimilarityRelax" title="see SearchSimilarityRelax of type com.sun.star.util.SearchDescriptor">SearchSimilarityRelax</a></span></p>
    </td><td style="text-align:left;width:7.758cm; " class="Tabelle3B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span>, the values of added, exchanged, and removed characters are combined The search term is then found if the word in the document can be generated through any combination of these three conditions.</p>
    </td></tr><tr><td style="text-align:left;width:7.682cm; " class="Tabelle3A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/util/SearchDescriptor.html#SearchSimilarityRemove" title="see SearchSimilarityRemove of type com.sun.star.util.SearchDescriptor">SearchSimilarityRemove</a></span></p>
    </td><td style="text-align:left;width:7.758cm; " class="Tabelle3B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">—</span> Determines how many characters the word in the document may be shorter than the search string for it to remain valid. The characters may be removed from the word at any position.</p>
    </td></tr><tr><td style="text-align:left;width:7.682cm; " class="Tabelle3A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/util/SearchDescriptor.html#SearchStyles" title="see SearchStyles of type com.sun.star.util.SearchDescriptor">SearchStyles</a></span></p>
    </td><td style="text-align:left;width:7.758cm; " class="Tabelle3B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span>  <span class="T8">—</span>Determines if the search and replace string should be interpreted as paragraph style names.  Note that the Display Name of the style has to be used.</p>
    </td></tr><tr><td style="text-align:left;width:7.682cm; " class="Tabelle3A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/util/SearchDescriptor.html#SearchWords" title="see SearchWords of type com.sun.star.util.SearchDescriptor">SearchWords</a></span></p>
    </td><td style="text-align:left;width:7.758cm; " class="Tabelle3B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span>Determines if the search should find complete words only.</p>
    </td></tr></table></div>
  <p class="Paragraph">In <span class="Codeintext">XPropertyReplace,</span> the methods to get and set search attributes, and replace attributes allow the attributes to search for to be defined and the attributes to insert instead of the existing attributes. All of these methods expect a sequence of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/beans/PropertyValue.html" title="see type com.sun.star.beans.PropertyValue">com.sun.star.beans.PropertyValue</a></span> structs.</p>
  <p class="Paragraph">Any properties contained in the services <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html" title="see type com.sun.star.style.CharacterProperties">com.sun.star.style.CharacterProperties</a></span>, <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterPropertiesAsian.html" title="see type com.sun.star.style.CharacterPropertiesAsian">com.sun.star.style.CharacterPropertiesAsian</a></span> and <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html" title="see type com.sun.star.style.ParagraphProperties">com.sun.star.style.ParagraphProperties</a></span> can be used for an attribute search. If <span class="Codeintext">setValueSearch(false)</span>is used, OpenOffice.org  checks if an attribute exists, whereas <span class="Codeintext">setValueSearch(true)</span> finds specific attribute values. If only searching to see if an attribute exists at all, it is sufficient to pass a <span class="Codeintext">PropertyValue</span> struct with the <span class="Codeintext">Name </span>field set to the name of the required attribute.  </p>
  <p class="Paragraph">The following code snippet replaces all occurrences of the text "random numbers" by the bold text "replaced numbers" in a given document <span class="Codeintext">mxDoc</span>.</p>
  <p class="Code">XReplaceable xReplaceable = (XReplaceable) UnoRuntime.queryInterface(XReplaceable.class, mxDoc); </p>
  <p class="Code">XReplaceDescriptor xRepDesc = xReplaceable.createReplaceDescriptor(); </p>
  <p class="Code"> </p>
  <p class="Code">// set a string to search for </p>
  <p class="Code">xRepDesc.setSearchString("random numbers"); </p>
  <p class="Code"> </p>
  <p class="Code">// set the string to be inserted </p>
  <p class="Code">xRepDesc.setReplaceString("replaced numbers"); </p>
  <p class="Code"> </p>
  <p class="Code">// create an array of one property value for a CharWeight property </p>
  <p class="Code">PropertyValue[] aReplaceArgs = new PropertyValue[1]; </p>
  <p class="Code"> </p>
  <p class="Code">// create PropertyValue struct </p>
  <p class="Code">aReplaceArgs[0] = new PropertyValue(); </p>
  <p class="Code">// CharWeight should be bold </p>
  <p class="Code">aReplaceArgs[0].Name = "CharWeight"; </p>
  <p class="Code">aReplaceArgs[0].Value = new Float(com.sun.star.awt.FontWeight.BOLD); </p>
  <p class="Code"> </p>
  <p class="Code">// set our sequence with one property value as ReplaceAttribute </p>
  <p class="Code">XPropertyReplace xPropRepl = (XPropertyReplace) UnoRuntime.queryInterface( </p>
  <p class="Code">        XPropertyReplace.class, xRepDesc);</p>
  <p class="Code">xPropRepl.setReplaceAttributes(aReplaceArgs); </p>
  <p class="Code"> </p>
  <p class="Code">// replace </p>
  <p class="Code">long nResult = xReplaceable.replaceAll(xRepDesc); </p>
  <h3 class="Head3"><a name="1_3_4_Tables" />8.3.4  Tables</h3>
  <h4 class="Head4"><a name="1_3_4_1_Table_Architecture" />Table Architecture</h4>
  <p class="Paragraph">OpenOffice.org text tables consist of rows, rows consist of one or more cells, and cells can contain text or rows. There is no logical concept of columns. From the API's perspective, a table acts as if it had columns, as long as there are no split or merged cells.  </p>
  <p class="P11">Cells in a row are counted alphabetically starting from A, where rows are counted numerically, starting from 1. This results in a cell-row addressing pattern, where the cell letter is denoted first (A-Zff.), followed by the row number (1ff.): </p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table12"><colgroup><col width="103" /><col width="338" /><col width="70" /><col width="194" /></colgroup><tr><td style="text-align:left;width:2.261cm; " class="Table12A1">
      <p class="TextInTable">A1 </p>
     </td><td style="text-align:left;width:7.391cm; " class="Table12A1">
      <p class="TextInTable">B1 </p>
     </td><td style="text-align:left;width:1.543cm; " class="Table12A1">
      <p class="TextInTable">C1 </p>
     </td><td style="text-align:left;width:4.242cm; " class="Table12D1">
      <p class="TextInTable">D1 </p>
     </td></tr><tr><td style="text-align:left;width:2.261cm; " class="Table12A2">
     <p class="TextInTable">A2 </p>
    </td><td style="text-align:left;width:7.391cm; " class="Table12B2">
     <p class="TextInTable">B2 </p>
    </td><td style="text-align:left;width:1.543cm; " class="Table12B2">
     <p class="TextInTable">C2 </p>
    </td><td style="text-align:left;width:4.242cm; " class="Table12D2">
     <p class="TextInTable">D2 </p>
    </td></tr><tr><td style="text-align:left;width:2.261cm; " class="Table12A2">
     <p class="TextInTable">A3 </p>
    </td><td style="text-align:left;width:7.391cm; " class="Table12B2">
     <p class="TextInTable">B3 </p>
    </td><td style="text-align:left;width:1.543cm; " class="Table12B2">
     <p class="TextInTable">C3 </p>
    </td><td style="text-align:left;width:4.242cm; " class="Table12D2">
     <p class="TextInTable">D3 </p>
    </td></tr><tr><td style="text-align:left;width:2.261cm; " class="Table12A2">
     <p class="TextInTable">A4 </p>
    </td><td style="text-align:left;width:7.391cm; " class="Table12B2">
     <p class="TextInTable">B4 </p>
    </td><td style="text-align:left;width:1.543cm; " class="Table12B2">
     <p class="TextInTable">C4 </p>
    </td><td style="text-align:left;width:4.242cm; " class="Table12D2">
     <p class="TextInTable">D4 </p>
    </td></tr></table></div>
  <p class="Paragraph">When a cell is <span class="T3">split</span> vertically, the new cell gets the letter of the former right-hand-side neighbor cell and the former neighbor cell gets the next letter in the alphabet. Consider the example table below: B2 was split vertically, a new cell C2 is inserted and the former C2 became D2, D2 became E2, and so forth.</p>
  <p class="Paragraph">When cells are <span class="T3">merged</span> vertically, the resulting cell counts as one cell and gets one letter. The neighbor cell to the right gets the subsequent letter. B4 in the table below shows this. The former B4 and C4 have been merged, so the former D4 could become C4. The cell name D4 is no longer required.</p>
  <p class="P9">As shown, there is no way to address a column C anymore, for the cells C1 to C4 no longer form a column: </p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table16"><colgroup><col width="105" /><col width="136" /><col width="201" /><col width="70" /><col width="194" /></colgroup><tr><td style="text-align:left;width:2.295cm; " class="Table16A1">
      <p class="TextInTable">A1 </p>
     </td><td colspan="2" style="text-align:left;width:2.969cm; " class="Table16A1">
      <p class="TextInTable">B1 </p>
     </td><td style="text-align:left;width:1.538cm; " class="Table16A1">
      <p class="TextInTable">C1 </p>
     </td><td style="text-align:left;width:4.237cm; " class="Table16E1">
      <p class="TextInTable">D1 </p>
     </td></tr><tr><td style="text-align:left;width:2.295cm; " class="Table16A2">
     <p class="TextInTable">A2 </p>
    </td><td style="text-align:left;width:2.969cm; " class="Table16B2">
     <p class="TextInTable">B2 vertically split in two </p>
    </td><td style="text-align:left;width:4.401cm; " class="Table16C2">
     <p class="TextInTable">C2 newly inserted </p>
    </td><td style="text-align:left;width:1.538cm; " class="Table16B2">
     <p class="TextInTable">D2 </p>
    </td><td style="text-align:left;width:4.237cm; " class="Table16E2">
     <p class="TextInTable">E2 </p>
    </td></tr><tr><td style="text-align:left;width:2.295cm; " class="Table16A2">
     <p class="TextInTable">A3 </p>
    </td><td colspan="2" style="text-align:left;width:2.969cm; " class="Table16B2">
     <p class="TextInTable">B3 </p>
    </td><td style="text-align:left;width:1.538cm; " class="Table16B2">
     <p class="TextInTable">C3 </p>
    </td><td style="text-align:left;width:4.237cm; " class="Table16E2">
     <p class="TextInTable">D3 </p>
    </td></tr><tr><td style="text-align:left;width:2.295cm; " class="Table16A2">
     <p class="TextInTable">A4 </p>
    </td><td colspan="3" style="text-align:left;width:2.969cm; " class="Table16C2">
     <p class="TextInTable">B4 merged with C4 </p>
    </td><td style="text-align:left;width:4.237cm; " class="Table16E2">
     <p class="TextInTable">C4 </p>
    </td></tr></table></div>
  <p class="Paragraph">When cells are split horizontally, OpenOffice.org simply inserts as many rows into the cell as required. </p>
  <p class="Paragraph">In our example table, we continued by splitting C2 first horizontally and then vertically so that there is a range of four cells. </p>
  <p class="Paragraph">The writer treats the content of C2 as two rows and starts counting cells within rows. To address the new cells, it extends the original cell name C2 by new addresses following the cell-row pattern. The upper row gets row number 1 and the first cell in the row gets cell number 1, resulting in the cell address <a href="http://replay.waybackmachine.org/20090501191804/http://c2.1.1/"><span class="T12">C2.1.1</span></a><span class="T13">,</span> where the latter 1 indicates the row and the former 1 indicates the first cell in the row. The right neighbor of C2.1.1 is C2.2.1. The subaddress 2.1 means the second cell in the first row.</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table17"><colgroup><col width="105" /><col width="137" /><col width="200" /><col width="70" /><col width="194" /></colgroup><tr><td style="text-align:left;width:2.295cm; " class="Table17A1">
      <p class="TextInTable">A1 </p>
     </td><td colspan="2" style="text-align:left;width:2.99cm; " class="Table17A1">
      <p class="TextInTable">B1 </p>
     </td><td style="text-align:left;width:1.538cm; " class="Table17A1">
      <p class="TextInTable">C1 </p>
     </td><td style="text-align:left;width:4.237cm; " class="Table17E1">
      <p class="TextInTable">D1 </p>
     </td></tr><tr><td style="text-align:left;width:2.295cm; " class="Table17A2">
     <p class="TextInTable">A2 </p>
    </td><td style="text-align:left;width:2.99cm; " class="Table17B2">
     <p class="TextInTable">B2 vertically split in two </p>
    </td><td style="text-align:left;">
     <table border="0" cellspacing="0" cellpadding="0" width="100%"><colgroup><col width="96" /><col width="104" /></colgroup><tr><td style="text-align:left;width:2.103cm; " class="Table17C211">
        <p class="TextInTable">C2.1.1 </p>
       </td><td style="text-align:left;width:2.275cm; " class="Table17C211">
        <p class="TextInTable">C2.2.1 </p>
       </td></tr><tr><td style="text-align:left;width:2.103cm; " class="Table17C211">
        <p class="TextInTable">C2.1.2 </p>
       </td><td style="text-align:left;width:2.275cm; " class="Table17C211">
        <p class="TextInTable">C2.2.2 </p>
       </td></tr></table>
    </td><td style="text-align:left;width:1.538cm; " class="Table17B2">
     <p class="TextInTable">D2 </p>
    </td><td style="text-align:left;width:4.237cm; " class="Table17E2">
     <p class="TextInTable">E2 </p>
    </td></tr><tr><td style="text-align:left;width:2.295cm; " class="Table17A2">
     <p class="TextInTable">A3 </p>
    </td><td colspan="2" style="text-align:left;width:2.99cm; " class="Table17B2">
     <p class="TextInTable">B3 </p>
    </td><td style="text-align:left;width:1.538cm; " class="Table17B2">
     <p class="TextInTable">C3 </p>
    </td><td style="text-align:left;width:4.237cm; " class="Table17E2">
     <p class="TextInTable">D3 </p>
    </td></tr><tr><td style="text-align:left;width:2.295cm; " class="Table17A2">
     <p class="TextInTable">A4 </p>
    </td><td colspan="3" style="text-align:left;width:2.99cm; " class="Table17B4">
     <p class="TextInTable">B4 merged with C4 </p>
    </td><td style="text-align:left;width:4.237cm; " class="Table17E2">
     <p class="TextInTable">C4 </p>
    </td></tr></table></div>
  <p class="Paragraph">The cell-row pattern is used for all further subaddressing as the cells are split and merged. The cell addresses can change radically depending on the table structure generated by OpenOffice.org. The next table shows what happens when E2 is merged with D3. The table is reorganized, so that it has three rows instead of four. The second row contains <span class="Emphasis">two</span> cells, A2 and B2 (sic!). The cell A2 has two rows, as shown from the cell subaddresses: The upper row consists of four cells, namely A2.1.1 through A2.4.1, whereas the lower row consists of the three cells A2.1.2 through A2.3.2. </p>
  <p class="P9">The cell range C2.1.1:C2.2.2 that was formerly contained in cell C2 is now in cell A2.3.1 that  denotes the third cell in the first row of A2. Within the address of the cell A2.3.1, OpenOffice.org has started a new subaddressing level using the cell-row pattern again.</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table53"><colgroup><col width="105" /><col width="337" /><col width="70" /><col width="194" /></colgroup><tr><td style="text-align:left;width:2.295cm; " class="Table53A1">
      <p class="TextInTable">A1 </p>
     </td><td style="text-align:left;width:7.37cm; " class="Table53A1">
      <p class="TextInTable">B1 </p>
     </td><td style="text-align:left;width:1.538cm; " class="Table53A1">
      <p class="TextInTable">C1 </p>
     </td><td style="text-align:left;width:4.237cm; " class="Table53D1">
      <p class="TextInTable">D1 </p>
     </td></tr><tr><td colspan="3" style="text-align:left;">
     <table border="0" cellspacing="0" cellpadding="0" width="100%"><colgroup><col width="105" /><col width="137" /><col width="200" /><col width="70" /></colgroup><tr><td style="text-align:left;width:2.295cm; " class="Table53A211">
        <p class="TextInTable">A2.1.1 </p>
       </td><td style="text-align:left;width:2.992cm; " class="Table53A221">
        <p class="TextInTable">A2.2.1 </p>
       </td><td style="text-align:left;">
        <table border="0" cellspacing="0" cellpadding="0" width="100%"><colgroup><col width="96" /><col width="104" /></colgroup><tr><td style="text-align:left;width:2.103cm; " class="Table53A23111">
           <p class="TextInTable">A2.3.1.1.1 </p>
          </td><td style="text-align:left;width:2.275cm; " class="Table53A23111">
           <p class="TextInTable">A2.3.1.2.1 </p>
          </td></tr><tr><td style="text-align:left;width:2.103cm; " class="Table53A23111">
           <p class="TextInTable">A2.3.1.1.2 </p>
          </td><td style="text-align:left;width:2.275cm; " class="Table53A23111">
           <p class="TextInTable">A2.3.1.2.2 </p>
          </td></tr></table>
       </td><td style="text-align:left;width:1.538cm; " class="Table53A221">
        <p class="TextInTable">A2.4.1 </p>
       </td></tr><tr><td style="text-align:left;width:2.295cm; " class="Table53A212">
        <p class="TextInTable">A2.1.2 </p>
       </td><td colspan="2" style="text-align:left;width:2.992cm; " class="Table53A222">
        <p class="TextInTable">A2.2.2 </p>
       </td><td style="text-align:left;width:1.538cm; " class="Table53A222">
        <p class="TextInTable">A2.3.2 </p>
       </td></tr></table>
    </td><td style="text-align:left;width:4.237cm; " class="Table53D2">
     <p class="TextInTable">Former E2 merged with former D3  </p>
     <p class="TextInTable">Becomes B2! </p>
    </td></tr><tr><td style="text-align:left;width:2.295cm; " class="Table53A212">
     <p class="TextInTable">A3 </p>
    </td><td colspan="2" style="text-align:left;width:7.37cm; " class="Table53B3">
     <p class="TextInTable">B3 </p>
    </td><td style="text-align:left;width:4.237cm; " class="Table53D3">
     <p class="TextInTable">C3 </p>
    </td></tr></table></div>
  <p class="P12">Cell addresses can become complicated. The cell address can be looked up in the user interface. Set the GUI text cursor in the desired cell and observe the lower-right corner of the status bar in the text document.  </p>
  <p class="Paragraph">Remember that there are only "columns" in a text table, as long as there are no split or merged cells. </p>
  <p class="Paragraph">Text tables support the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html" title="see type com.sun.star.text.TextTable">com.sun.star.text.TextTable</a></span>, which includes the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextContent.html" title="see type com.sun.star.text.TextContent">com.sun.star.text.TextContent</a></span>:</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table58"><colgroup><col width="821" /></colgroup><tr><td style="text-align:left;width:17.979cm; " class="Table58A1">
      <div class="Paragraph"><div style="width: 11.532cm; " id="Frame41" class="fr4">
        <div class="Illustration"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/Text/TextTable.png" title="link to the full-sized graphic &quot;./TextTable.png&quot;"><img border="0" width="523" height="679" alt="UML diagram showing the com.sun.star.text.TextTable service" src="./8 Text Documents_files/TextTable.png" class="fr3" /></a>Illustration <a name="refIllustration3">8.4</a> Service com.sun.star.text.TextTable</div>
       </div></div>
     </td></tr></table></div>
  <p class="P12">The service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html" title="see type com.sun.star.text.TextTable">com.sun.star.text.TextTable</a></span> offers access to table cells in two different ways::</p>
  <ul style="margin-left:0.5cm;">
   <li class="P13" style="margin-left:2.5cm;"><p class="P13" style="margin-left:0cm;">Yields named table cells which are organized in rows and columns. </p></li>
   <li class="P13" style="margin-left:2.5cm;"><p class="P13" style="margin-left:0cm;">Provides a table cursor to travel through the table cells and alter the cell properties. </p></li>
  </ul>
  <p class="Paragraph">These aspects are reflected in the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextTable.html" title="see type com.sun.star.text.XTextTable">com.sun.star.text.XTextTable</a></span> which inherits from <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextContent.html" title="see type com.sun.star.text.XTextContent">com.sun.star.text.XTextContent</a></span>. It can be seen as a rectangular range of cells defined by numeric column indexes, as described by <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/table/XCellRange.html" title="see type com.sun.star.table.XCellRange">com.sun.star.table.XCellRange</a></span>. This aspect makes text tables compatible with spreadsheet tables. Also, text tables have a name, can be sorted, charts can be based on them, and predefined formats can be applied to the tables. The latter aspects are covered by the interfaces <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XNamed.html" title="see type com.sun.star.container.XNamed">com.sun.star.container.XNamed</a></span>, <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/util/XSortable.html" title="see type com.sun.star.util.XSortable">com.sun.star.util.XSortable</a></span>, <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/chart/XChartDataArray.html" title="see type com.sun.star.chart.XChartDataArray">com.sun.star.chart.XChartDataArray</a></span> and <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/table/XAutoFormattable.html" title="see type com.sun.star.table.XAutoFormattable">com.sun.star.table.XAutoFormattable</a></span>.</p>
  <p class="Paragraph">The usage of these interfaces and the properties of the TextTable service are discussed below. </p>
  <h4 class="Head4"><a name="1_3_4_2_Named_Table_Cells_in_Rows_2C_Columns_and_the_Table_Cursor" />Named Table Cells in Rows, Columns and the Table Cursor</h4>
  <p class="Paragraph">The interface <span class="Codeintext">XTextTable</span> introduces the following methods to initialize a table, work with table cells, rows and columns, and create a table cursor:</p>
  <p class="MethodSignatures">void <span class="T2">initia</span><span class="T14">lize</span><span class="T15">( [in] long nRows,  [in] long nColumns) </span></p>
  <p class="MethodSignatures"> </p>
  <p class="MethodSignatures">sequence&lt; string &gt; <span class="T2">getCellNames</span>() </p>
  <p class="MethodSignatures">com::sun::star::table::XCell <span class="T2">getCellByName</span>( [in] string aCellName) </p>
  <p class="MethodSignatures"> </p>
  <p class="MethodSignatures">com::sun::star::table::XTableRows <span class="T2">getRows</span>() </p>
  <p class="MethodSignatures">com::sun::star::table::XTableColumns <span class="T2">getColumns</span>() </p>
  <p class="MethodSignatures"> </p>
  <p class="MethodSignatures">com::sun::star::text::XTextTableCursor <span class="T2">createCursorByCellName</span>( [in] string aCellName) </p>
  <p class="Paragraph">The method <span class="Codeintext">initialize() </span>sets the number of rows and columns prior to inserting the table into the text. Non-initialized tables default to two rows and two columns.</p>
  <p class="Paragraph">The method <span class="Codeintext">getCellNames()</span> returns a sequence of strings containing the names of all cells in the table in A1[.1.1] notation.</p>
  <p class="Paragraph">The method <span class="Codeintext">getCellByName()</span> expects a cell name in A1[.1.1] notation, and returns a cell object that is a  <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/table/XCell.html" title="see type com.sun.star.table.XCell">com.sun.star.table.XCell</a></span> and a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XText.html" title="see type com.sun.star.text.XText">com.sun.star.text.XText</a></span>. The advantage of <span class="Codeintext">getCellByName()</span> is its ability to retrieve cells even in tables with split or merged cells.</p>
  <p class="Paragraph">The method <span class="Codeintext">getRows() </span>returns a table row container supporting <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/table/XTableRows.html" title="see type com.sun.star.table.XTableRows">com.sun.star.table.XTableRows</a></span> that is a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XIndexAccess.html" title="see type com.sun.star.container.XIndexAccess">com.sun.star.container.XIndexAccess</a></span>, and introduces the following methods to insert an arbitrary number of table rows below a given row index position and remove rows from a certain position:</p>
  <p class="MethodSignatures">void <span class="T2">insertByIndex</span> ( [in] long nIndex,  [in] long nCount)</p>
  <p class="MethodSignatures">void <span class="T2">removeByIndex</span> ( [in] long nIndex,  [in] long nCount)</p>
  <p class="Paragraph">The following table shows which <span class="Codeintext">XTableRows </span>methods work under which circumstances.</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table22"><colgroup><col width="238" /><col width="345" /><col width="122" /></colgroup><tr><td style="text-align:left;width:5.214cm; " class="Table22A1">
      <p class="TableHead">Method in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/table/XTableRows.html" title="see type com.sun.star.table.XTableRows">com.sun.star.table.XTableRows</a></span></p>
     </td><td style="text-align:left;width:7.551cm; " class="Table22A1">
      <p class="TableHead">In Simple table </p>
     </td><td style="text-align:left;width:2.674cm; " class="Table22C1">
      <p class="TableHead">In Complex Table </p>
     </td></tr><tr><td style="text-align:left;width:5.214cm; " class="Table22A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XElementAccess.html#getElementType" title="see getElementType of type com.sun.star.container.XElementAccess">getElementType</a>()</span></p>
    </td><td style="text-align:left;width:7.551cm; " class="Table22A2">
     <p class="TextInTable">X </p>
    </td><td style="text-align:left;width:2.674cm; " class="Table22C2">
     <p class="TextInTable">X </p>
    </td></tr><tr><td style="text-align:left;width:5.214cm; " class="Table22A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XElementAccess.html#hasElements" title="see hasElements of type com.sun.star.container.XElementAccess">hasElements</a>()</span></p>
    </td><td style="text-align:left;width:7.551cm; " class="Table22A2">
     <p class="TextInTable">X </p>
    </td><td style="text-align:left;width:2.674cm; " class="Table22C2">
     <p class="TextInTable">X </p>
    </td></tr><tr><td style="text-align:left;width:5.214cm; " class="Table22A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XIndexAccess.html#getByIndex" title="see getByIndex of type com.sun.star.container.XIndexAccess">getByIndex</a>()</span></p>
    </td><td style="text-align:left;width:7.551cm; " class="Table22A2">
     <p class="TextInTable">X </p>
    </td><td style="text-align:left;width:2.674cm; " class="Table22C2">
     <p class="TextInTable">X </p>
    </td></tr><tr><td style="text-align:left;width:5.214cm; " class="Table22A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XIndexAccess.html#getCount" title="see getCount of type com.sun.star.container.XIndexAccess">getCount</a>()</span></p>
    </td><td style="text-align:left;width:7.551cm; " class="Table22A2">
     <p class="TextInTable">X </p>
    </td><td style="text-align:left;width:2.674cm; " class="Table22C2">
     <p class="TextInTable">X </p>
    </td></tr><tr><td style="text-align:left;width:5.214cm; " class="Table22A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/table/XTableRows.html#insertByIndex" title="see insertByIndex of type com.sun.star.table.XTableRows">insertByIndex</a>()</span></p>
    </td><td style="text-align:left;width:7.551cm; " class="Table22A2">
     <p class="TextInTable">X </p>
    </td><td style="text-align:left;width:2.674cm; " class="Table22C2">
     <p class="TextInTable">- </p>
    </td></tr><tr><td style="text-align:left;width:5.214cm; " class="Table22A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/table/XTableRows.html#removeByIndex" title="see removeByIndex of type com.sun.star.table.XTableRows">removeByIndex</a>()</span></p>
    </td><td style="text-align:left;width:7.551cm; " class="Table22A2">
     <p class="TextInTable">X </p>
    </td><td style="text-align:left;width:2.674cm; " class="Table22C2">
     <p class="TextInTable">- </p>
    </td></tr></table></div>
  <p class="P9">Every row returned by <span class="Codeintext">getRows()</span> supports the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTableRow.html" title="see type com.sun.star.text.TextTableRow">com.sun.star.text.TextTableRow</a></span>, that is, it is a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/beans/XPropertySet.html" title="see type com.sun.star.beans.XPropertySet">com.sun.star.beans.XPropertySet</a></span> which features these properties:</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table19"><colgroup><col width="238" /><col width="467" /></colgroup><tr><td colspan="2" style="text-align:left;width:5.219cm; " class="Table19A1">
      <p class="TableHead">Properties of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTableRow.html" title="see type com.sun.star.text.TextTableRow">com.sun.star.text.TextTableRow</a></span></p>
     </td></tr><tr><td style="text-align:left;width:5.219cm; " class="Table19A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTableRow.html#BackColor" title="see BackColor of type com.sun.star.text.TextTableRow">BackColor</a></span></p>
    </td><td style="text-align:left;width:10.22cm; " class="Table19B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">—</span> Specifies the color of the background in 0xAARRGGBB notation.</p>
    </td></tr><tr><td style="text-align:left;width:5.219cm; " class="Table19A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTableRow.html#BackTransparent" title="see BackTransparent of type com.sun.star.text.TextTableRow">BackTransparent</a></span></p>
    </td><td style="text-align:left;width:10.22cm; " class="Table19B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span>, the background color value in "<span class="Codeintext">BackColor</span>" is not visible.</p>
    </td></tr><tr><td style="text-align:left;width:5.219cm; " class="Table19A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTableRow.html#BackGraphicURL" title="see BackGraphicURL of type com.sun.star.text.TextTableRow">BackGraphicURL</a></span></p>
    </td><td style="text-align:left;width:10.22cm; " class="Table19B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">—</span> Contains the URL of a background graphic.</p>
    </td></tr><tr><td style="text-align:left;width:5.219cm; " class="Table19A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTableRow.html#BackGraphicFilter" title="see BackGraphicFilter of type com.sun.star.text.TextTableRow">BackGraphicFilter</a></span></p>
    </td><td style="text-align:left;width:10.22cm; " class="Table19B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">—</span> Contains the name of the file filter of a background graphic.</p>
    </td></tr><tr><td style="text-align:left;width:5.219cm; " class="Table19A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTableRow.html#BackGraphicLocation" title="see BackGraphicLocation of type com.sun.star.text.TextTableRow">BackGraphicLocation</a></span></p>
    </td><td style="text-align:left;width:10.22cm; " class="Table19B2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/GraphicLocation.html" title="see type com.sun.star.style.GraphicLocation">com.sun.star.style.GraphicLocation</a></span>. Determines the position of the background graphic.</p>
    </td></tr><tr><td style="text-align:left;width:5.219cm; " class="Table19A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTableRow.html#TableColumnSeparators" title="see TableColumnSeparators of type com.sun.star.text.TextTableRow">TableColumnSeparators</a></span></p>
    </td><td style="text-align:left;width:10.22cm; " class="Table19B2">
     <p class="TextInTable">Defines the column width and its merging behavior. It contains a sequence of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TableColumnSeparator.html" title="see type com.sun.star.text.TableColumnSeparator">com.sun.star.text.TableColumnSeparator</a></span> structs with the fields Position and IsVisible. The value of Position is relative to the table property <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html#TableColumnRelativeSum" title="see TableColumnRelativeSum of type com.sun.star.text.TextTable:TableColumnRelativeSum">com.sun.star.text.TextTable:TableColumnRelativeSum</a></span>. IsVisible refers to merged cells where the separator becomes invisible.</p>
    </td></tr><tr><td style="text-align:left;width:5.219cm; " class="Table19A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTableRow.html#Height" title="see Height of type com.sun.star.text.TextTableRow">Height</a></span></p>
    </td><td style="text-align:left;width:10.22cm; " class="Table19B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">—</span> Contains the height of the table row.</p>
    </td></tr><tr><td style="text-align:left;width:5.219cm; " class="Table19A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTableRow.html#IsAutoHeight" title="see IsAutoHeight of type com.sun.star.text.TextTableRow">IsAutoHeight</a></span></p>
    </td><td style="text-align:left;width:10.22cm; " class="Table19B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If the value of this property is <span class="Codeintext">true</span> , the height of the table row depends on the content of the table cells.</p>
    </td></tr></table></div>
  <p class="Paragraph">The method <span class="Codeintext">getColumns()</span>is similar to <span class="Codeintext">getRows()</span>, but restrictions apply. It returns a table column container supporting <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/table/XTableColumns.html" title="see type com.sun.star.table.XTableColumns">com.sun.star.table.XTableColumns</a></span> that is a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XIndexAccess.html" title="see type com.sun.star.container.XIndexAccess">com.sun.star.container.XIndexAccess</a></span> and introduces the following methods to insert an arbitrary number of table columns behind a given column index position and remove columns from a certain position:</p>
  <p class="MethodSignatures">void <span class="T2">insertByIndex</span>( [in] long nIndex,  [in] long nCount)</p>
  <p class="MethodSignatures">void <span class="T2">removeByIndex</span>( [in] long nIndex,  [in] long nCount)</p>
  <p class="Paragraph">The following table shows which <span class="Codeintext">XTableColumns</span> methods work in which situation.</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table21"><colgroup><col width="238" /><col width="345" /><col width="122" /></colgroup><tr><td style="text-align:left;width:5.214cm; " class="Table21A1">
      <p class="TableHead">Methods in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/table/XTableColumns.html" title="see type com.sun.star.table.XTableColumns">com.sun.star.table.XTableColumns</a></span></p>
     </td><td style="text-align:left;width:7.551cm; " class="Table21A1">
      <p class="TableHead">In Simple Table </p>
     </td><td style="text-align:left;width:2.674cm; " class="Table21C1">
      <p class="TableHead">In Complex Table </p>
     </td></tr><tr><td style="text-align:left;width:5.214cm; " class="Table21A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XElementAccess.html#getElementType" title="see getElementType of type com.sun.star.container.XElementAccess">getElementType</a>()</span></p>
    </td><td style="text-align:left;width:7.551cm; " class="Table21A2">
     <p class="TextInTable">X </p>
    </td><td style="text-align:left;width:2.674cm; " class="Table21C2">
     <p class="TextInTable">X </p>
    </td></tr><tr><td style="text-align:left;width:5.214cm; " class="Table21A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XElementAccess.html#hasElements" title="see hasElements of type com.sun.star.container.XElementAccess">hasElements</a>()</span></p>
    </td><td style="text-align:left;width:7.551cm; " class="Table21A2">
     <p class="TextInTable">X </p>
    </td><td style="text-align:left;width:2.674cm; " class="Table21C2">
     <p class="TextInTable">X </p>
    </td></tr><tr><td style="text-align:left;width:5.214cm; " class="Table21A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XIndexAccess.html#getByIndex" title="see getByIndex of type com.sun.star.container.XIndexAccess">getByIndex</a>()</span></p>
    </td><td style="text-align:left;width:7.551cm; " class="Table21A2">
     <p class="TextInTable">X (but returned object supports <span class="Codeintext">XInterface</span> only)</p>
    </td><td style="text-align:left;width:2.674cm; " class="Table21C2">
     <p class="TextInTable">- </p>
    </td></tr><tr><td style="text-align:left;width:5.214cm; " class="Table21A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XIndexAccess.html#getCount" title="see getCount of type com.sun.star.container.XIndexAccess">getCount</a>()</span></p>
    </td><td style="text-align:left;width:7.551cm; " class="Table21A2">
     <p class="TextInTable">X </p>
    </td><td style="text-align:left;width:2.674cm; " class="Table21C2">
     <p class="TextInTable">- </p>
    </td></tr><tr><td style="text-align:left;width:5.214cm; " class="Table21A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/table/XTableColumns.html#insertByIndex" title="see insertByIndex of type com.sun.star.table.XTableColumns">insertByIndex</a>()</span></p>
    </td><td style="text-align:left;width:7.551cm; " class="Table21A2">
     <p class="TextInTable">X </p>
    </td><td style="text-align:left;width:2.674cm; " class="Table21C2">
     <p class="TextInTable">- </p>
    </td></tr><tr><td style="text-align:left;width:5.214cm; " class="Table21A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/table/XTableColumns.html#removeByIndex" title="see removeByIndex of type com.sun.star.table.XTableColumns">removeByIndex</a>()</span></p>
    </td><td style="text-align:left;width:7.551cm; " class="Table21A2">
     <p class="TextInTable">X </p>
    </td><td style="text-align:left;width:2.674cm; " class="Table21C2">
     <p class="TextInTable">- </p>
    </td></tr></table></div>
  <p class="Paragraph">The method <span class="Codeintext">createCursorByCellName()</span> creates a text table cursor that can select a cell range in the table, merge or split cells, and read and write cell properties of the selected cell range. It is a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTableCursor.html" title="see type com.sun.star.text.TextTableCursor">com.sun.star.text.TextTableCursor</a></span> service with the interfaces <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextTableCursor.html" title="see type com.sun.star.text.XTextTableCursor">com.sun.star.text.XTextTableCursor</a></span> and <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/beans/XPropertySet.html" title="see type com.sun.star.beans.XPropertySet">com.sun.star.beans.XPropertySet</a></span>.</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table59"><colgroup><col width="821" /></colgroup><tr><td style="text-align:left;width:17.979cm; " class="Table59A1">
      <div class="Paragraph"><div style="width: 11.114cm; " id="Frame411" class="fr4">
        <div class="Illustration"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/Text/TextTableCursorSimple.png" title="link to the full-sized graphic &quot;./TextTableCursorSimple.png&quot;"><img border="0" width="502" height="495" alt="UML diagram showing the com.sun.star.text.TextTableCursor service" src="./8 Text Documents_files/TextTableCursorSimple.png" class="fr3" /></a>Illustration <a name="refIllustration4">8.5</a> com.sun.star.text.TextTableCursor</div>
       </div></div>
     </td></tr></table></div>
  <p class="Paragraph">These are the methods contained in <span class="Codeintext">XTextTableCursor</span>:</p>
  <p class="MethodSignatures">string <span class="T2">getRangeName</span>() </p>
  <p class="MethodSignatures"> </p>
  <p class="MethodSignatures">boolean <span class="T2">goLeft</span>( [in] short nCount,  [in] boolean bExpand)</p>
  <p class="MethodSignatures">boolean <span class="T2">goRight</span>( [in] short nCount,  [in] boolean bExpand)</p>
  <p class="MethodSignatures">boolean <span class="T2">goUp</span>( [in] short nCount,  [in] boolean bExpand)</p>
  <p class="MethodSignatures">boolean <span class="T2">goDown</span>( [in] short nCount,  [in] boolean bExpand)</p>
  <p class="MethodSignatures"> </p>
  <p class="MethodSignatures">void <span class="T2">gotoStart</span>( [in] boolean bExpand)</p>
  <p class="MethodSignatures">void <span class="T2">gotoEnd</span>( [in] boolean bExpand)</p>
  <p class="MethodSignatures">boolean <span class="T2">gotoCellByName</span>( [in] string aCellName,  [in] boolean bExpand)</p>
  <p class="MethodSignatures"> </p>
  <p class="MethodSignatures">boolean <span class="T2">mergeRange</span>()</p>
  <p class="MethodSignatures">boolean <span class="T2">splitRange</span>( [in] short Count,  [in] boolean Horizontal)</p>
  <p class="Paragraph">Traveling through the table calls the cursor's <span class="Codeintext">goLeft()</span>, <span class="Codeintext">goRight()</span>, <span class="Codeintext">goUp()</span>, <span class="Codeintext">goDown()</span>, <span class="Codeintext">gotoStart()</span>, <span class="Codeintext">gotoEnd()</span>,   and <span class="Codeintext">gotoCellByName()</span> methods, passing <span class="Codeintext">true</span> to select cells on the way. </p>
  <p class="Paragraph">Once a cell range is selected, apply character and paragraph properties to the cells in the range as defined in the services <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html" title="see type com.sun.star.style.CharacterProperties">com.sun.star.style.CharacterProperties</a></span>, <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterPropertiesAsian.html" title="see type com.sun.star.style.CharacterPropertiesAsian">com.sun.star.style.CharacterPropertiesAsian</a></span>, <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterPropertiesComplex.html" title="see type com.sun.star.style.CharacterPropertiesComplex">com.sun.star.style.CharacterPropertiesComplex</a></span> and <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html" title="see type com.sun.star.style.ParagraphProperties">com.sun.star.style.ParagraphProperties</a></span>. Moreover, split and merge cells using the text table cursor. An example is provided below.</p>
  <h4 class="Head4"><a name="1_3_4_3_Indexed_Cells_and_Cell_Ranges" />Indexed Cells and Cell Ranges</h4>
  <p class="Paragraph">The interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/table/XCellRange.html" title="see type com.sun.star.table.XCellRange">com.sun.star.table.XCellRange</a></span> provides access to cells using their row and column index as position, and to create sub ranges of tables:</p>
  <p class="MethodSignatures">com::sun::star::table::XCell <span class="T2">getCellByPosition</span>( [in] long nColumn,  [in] long nRow) </p>
  <p class="MethodSignatures">com::sun::star::table::XCellRange <span class="T2">getCellRangeByPosition</span>( [in] long nLeft,  [in] long nTop,  </p>
  <p class="MethodSignatures">                                                          [in] long nRight, [in] long nBottom) </p>
  <p class="MethodSignatures">com::sun::star::table::XCellRange <span class="T2">getCellRangeByName</span>( [in] string aRange) </p>
  <p class="Paragraph">The method <span class="Codeintext">getCellByPosition()</span> returns a cell object supporting the interfaces <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/table/XCell.html" title="see type com.sun.star.table.XCell">com.sun.star.table.XCell</a></span> and <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XText.html" title="see type com.sun.star.text.XText">com.sun.star.text.XText</a></span>. To find the cell the name is internally created from the position using the naming scheme described above and returns this cell if it exists. Calling <span class="Codeintext">getCellByPosition(1, 1)</span>in the table at the beginning of this chapter returns the cell "B2" .</p>
  <p class="Paragraph">The methods <span class="Codeintext">getCellRangeByPosition()</span> and <span class="Codeintext">getCellRangeByName()</span> return a range object that is described below. The name of the range is created with the top-left cell and bottom-right cell of the table separated by a colon <span class="Codeintext">:</span> as in <span class="Codeintext">A1:B4</span>. Both methods fail when the structure of the table contains merged or split cells.</p>
  <h4 class="Head4"><a name="1_3_4_4_Table_Naming_2C_Sorting_2C_Charting_and_Autoformatting" />Table Naming, Sorting, Charting and Autoformatting</h4>
  <p class="Paragraph">Each table has a unique name that can be read and written using the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XNamed.html" title="see type com.sun.star.container.XNamed">com.sun.star.container.XNamed</a></span>. </p>
  <p class="Paragraph">A text table is a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/util/XSortable.html" title="see type com.sun.star.util.XSortable">com.sun.star.util.XSortable</a></span>. Its method <span class="Codeintext">createSortDescriptor()</span> returns a sequence of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/beans/PropertyValue.html" title="see type com.sun.star.beans.PropertyValue">com.sun.star.beans.PropertyValue</a></span> structs that provides the elements as described in the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextSortDescriptor.html" title="see type com.sun.star.text.TextSortDescriptor">com.sun.star.text.TextSortDescriptor</a></span>. The method <span class="Codeintext">sort()</span> sorts the table content by the given parameters. </p>
  <p class="Paragraph">The interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/chart/XChartDataArray.html" title="see type com.sun.star.chart.XChartDataArray">com.sun.star.chart.XChartDataArray</a></span> is used to connect a table or a range inside of a table to a chart. It reads and writes the values of a range, and sets the column and row labels. The inherited interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/chart/XChartData.html" title="see type com.sun.star.chart.XChartData">com.sun.star.chart.XChartData</a></span> enables the chart to connect listeners to be notified when changes to the values of a table are made. For details about charting, refer to chapter <span class="ChapterRef"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/Charts/Charts.xhtml#1_Charts" title="see chapter 11 Charts">11 Charts</a></span>.</p>
  <p class="Paragraph">The interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/table/XAutoFormattable.html" title="see type com.sun.star.table.XAutoFormattable">com.sun.star.table.XAutoFormattable</a></span> provides in its method <span class="Codeintext">autoFormat()</span> a method to format the table using a predefined table format. To access the available auto formats, the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/sheet/TableAutoFormats.html" title="see type com.sun.star.sheet.TableAutoFormats">com.sun.star.sheet.TableAutoFormats</a></span> has to be accessed. For details, refer to chapter <span class="ChapterRef"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/Spreadsheet/Spreadsheet.xhtml#1_3_2_5_Table_Auto_Formats" title="see chapter 9.3.2 Spreadsheet Documents - Working with Spreadsheets - Formatting - Table Auto Formats">9.3.2 Spreadsheet Documents - Working with Spreadsheets - Formatting - Table Auto Formats</a></span>.</p>
  <h4 class="Head4"><a name="1_3_4_5_Text_Table_Properties" />Text Table Properties</h4>
  <p class="Paragraph">The text table supports the properties described in the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html" title="see type com.sun.star.text.TextTable">com.sun.star.text.TextTable</a></span>:</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table20"><colgroup><col width="192" /><col width="513" /></colgroup><tr><td colspan="2" style="text-align:left;width:4.21cm; " class="Table20A1">
      <p class="TableHead">Properties of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html" title="see type com.sun.star.text.TextTable">com.sun.star.text.TextTable</a></span></p>
     </td></tr><tr><td style="text-align:left;width:4.21cm; " class="Table20A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html#BackColor" title="see BackColor of type com.sun.star.text.TextTable">BackColor</a></span></p>
    </td><td style="text-align:left;width:11.229cm; " class="Table20B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">— C</span>ontains the color of the table background. </p>
    </td></tr><tr><td style="text-align:left;width:4.21cm; " class="Table20A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html#BackGraphicFilter" title="see BackGraphicFilter of type com.sun.star.text.TextTable">BackGraphicFilter</a></span></p>
    </td><td style="text-align:left;width:11.229cm; " class="Table20B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">— </span>Contains the name of the file filter for the background graphic. </p>
    </td></tr><tr><td style="text-align:left;width:4.21cm; " class="Table20A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html#BackGraphicLocation" title="see BackGraphicLocation of type com.sun.star.text.TextTable">BackGraphicLocation</a></span></p>
    </td><td style="text-align:left;width:11.229cm; " class="Table20B2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/GraphicLocation.html" title="see type com.sun.star.style.GraphicLocation">com.sun.star.style.GraphicLocation</a></span>. Determines the position of the background graphic.</p>
    </td></tr><tr><td style="text-align:left;width:4.21cm; " class="Table20A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html#BackGraphicURL" title="see BackGraphicURL of type com.sun.star.text.TextTable">BackGraphicURL</a></span></p>
    </td><td style="text-align:left;width:11.229cm; " class="Table20B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">— </span>Contains the URL for the background graphic. </p>
    </td></tr><tr><td style="text-align:left;width:4.21cm; " class="Table20A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html#BackTransparent" title="see BackTransparent of type com.sun.star.text.TextTable">BackTransparent</a></span></p>
    </td><td style="text-align:left;width:11.229cm; " class="Table20B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">— </span>Determines if the background color is transparent. </p>
    </td></tr><tr><td style="text-align:left;width:4.21cm; " class="Table20A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html#BottomMargin" title="see BottomMargin of type com.sun.star.text.TextTable">BottomMargin</a></span></p>
    </td><td style="text-align:left;width:11.229cm; " class="Table20B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">— </span>Determines the bottom margin. </p>
    </td></tr><tr><td style="text-align:left;width:4.21cm; " class="Table20A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html#BreakType" title="see BreakType of type com.sun.star.text.TextTable">BreakType</a></span></p>
    </td><td style="text-align:left;width:11.229cm; " class="Table20B2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/BreakType.html" title="see type com.sun.star.style.BreakType">com.sun.star.style.BreakType</a></span>. Determines the type of break that is applied at the beginning of the table.</p>
    </td></tr><tr><td style="text-align:left;width:4.21cm; " class="Table20A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html#ChartColumnAsLabel" title="see ChartColumnAsLabel of type com.sun.star.text.TextTable">ChartColumnAsLabel</a></span></p>
    </td><td style="text-align:left;width:11.229cm; " class="Table20B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">— </span>Determines if the first column of the table should be treated as axis labels when a chart is to be created. </p>
    </td></tr><tr><td style="text-align:left;width:4.21cm; " class="Table20A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html#ChartRowAsLabel" title="see ChartRowAsLabel of type com.sun.star.text.TextTable">ChartRowAsLabel</a></span></p>
    </td><td style="text-align:left;width:11.229cm; " class="Table20B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">— </span>Determines if the first row of the table should be treated as axis labels when a chart is to be created. </p>
    </td></tr><tr><td style="text-align:left;width:4.21cm; " class="Table20A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html#HoriOrient" title="see HoriOrient of type com.sun.star.text.TextTable">HoriOrient</a></span></p>
    </td><td style="text-align:left;width:11.229cm; " class="Table20B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">— </span>Contains the horizontal orientation according to <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/HoriOrientation.html" title="see type com.sun.star.text.HoriOrientation">com.sun.star.text.HoriOrientation</a></span>.</p>
    </td></tr><tr><td style="text-align:left;width:4.21cm; " class="Table20A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html#IsWidthRelative" title="see IsWidthRelative of type com.sun.star.text.TextTable">IsWidthRelative</a></span></p>
    </td><td style="text-align:left;width:11.229cm; " class="Table20B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">— </span>Determines if the value of the relative width is valid. </p>
    </td></tr><tr><td style="text-align:left;width:4.21cm; " class="Table20A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html#KeepTogether" title="see KeepTogether of type com.sun.star.text.TextTable">KeepTogether</a></span></p>
    </td><td style="text-align:left;width:11.229cm; " class="Table20B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">— </span>Setting this property to <span class="Codeintext">true</span> prevents page or column breaks between this table and the following paragraph or text table. </p>
    </td></tr><tr><td style="text-align:left;width:4.21cm; " class="Table20A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html#LeftMargin" title="see LeftMargin of type com.sun.star.text.TextTable">LeftMargin</a></span></p>
    </td><td style="text-align:left;width:11.229cm; " class="Table20B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">— </span>Contains the left margin of the table. </p>
    </td></tr><tr><td style="text-align:left;width:4.21cm; " class="Table20A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html#PageDescName" title="see PageDescName of type com.sun.star.text.TextTable">PageDescName</a></span></p>
    </td><td style="text-align:left;width:11.229cm; " class="Table20B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">— </span>If this property is set, it creates a page break before the table and assigns the value as the name of the new page style sheet to use. </p>
    </td></tr><tr><td style="text-align:left;width:4.21cm; " class="Table20A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html#PageNumberOffset" title="see PageNumberOffset of type com.sun.star.text.TextTable">PageNumberOffset</a></span></p>
    </td><td style="text-align:left;width:11.229cm; " class="Table20B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">— </span>If a page break property is set at the table, this property contains the new value for the page number. </p>
    </td></tr><tr><td style="text-align:left;width:4.21cm; " class="Table20A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html#RelativeWidth" title="see RelativeWidth of type com.sun.star.text.TextTable">RelativeWidth</a></span></p>
    </td><td style="text-align:left;width:11.229cm; " class="Table20B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">— </span>Determines the width of the table relative to its environment. </p>
    </td></tr><tr><td style="text-align:left;width:4.21cm; " class="Table20A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html#RepeatHeadline" title="see RepeatHeadline of type com.sun.star.text.TextTable">RepeatHeadline</a></span></p>
    </td><td style="text-align:left;width:11.229cm; " class="Table20B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">— </span>Determines if the first row of the table is repeated on every new page. </p>
    </td></tr><tr><td style="text-align:left;width:4.21cm; " class="Table20A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html#RightMargin" title="see RightMargin of type com.sun.star.text.TextTable">RightMargin</a></span></p>
    </td><td style="text-align:left;width:11.229cm; " class="Table20B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">— </span>Contains the right margin of the table. </p>
    </td></tr><tr><td style="text-align:left;width:4.21cm; " class="Table20A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html#ShadowFormat" title="see ShadowFormat of type com.sun.star.text.TextTable">ShadowFormat</a></span></p>
    </td><td style="text-align:left;width:11.229cm; " class="Table20B2">
     <p class="TextInTable"><span class="Codeintext">struct</span> <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/table/ShadowFormat.html" title="see type com.sun.star.table.ShadowFormat">com.sun.star.table.ShadowFormat</a></span> determines the type, color and size of the shadow.</p>
    </td></tr><tr><td style="text-align:left;width:4.21cm; " class="Table20A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html#Split" title="see Split of type com.sun.star.text.TextTable">Split</a></span></p>
    </td><td style="text-align:left;width:11.229cm; " class="Table20B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">— </span>Setting this property to <span class="Codeintext">false</span> prevents the table from getting spread on two pages. </p>
    </td></tr><tr><td style="text-align:left;width:4.21cm; " class="Table20A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html#TableBorder" title="see TableBorder of type com.sun.star.text.TextTable">TableBorder</a></span></p>
    </td><td style="text-align:left;width:11.229cm; " class="Table20B2">
     <p class="TextInTable"><span class="Codeintext">struct</span> <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/table/TableBorder.html" title="see type com.sun.star.table.TableBorder">com.sun.star.table.TableBorder</a></span>. Contains the description of the table borders.</p>
    </td></tr><tr><td style="text-align:left;width:4.21cm; " class="Table20A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html#TableColumnRelativeSum" title="see TableColumnRelativeSum of type com.sun.star.text.TextTable">TableColumnRelativeSum</a></span></p>
    </td><td style="text-align:left;width:11.229cm; " class="Table20B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">— </span>Contains the sum of the column width values used in TableColumnSeparators. </p>
    </td></tr><tr><td style="text-align:left;width:4.21cm; " class="Table20A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html#TableColumnSeparators" title="see TableColumnSeparators of type com.sun.star.text.TextTable">TableColumnSeparators</a></span></p>
    </td><td style="text-align:left;width:11.229cm; " class="Table20B2">
     <p class="TextInTable"><span class="Codeintext">sequence</span> &lt; <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TableColumnSeparator.html" title="see type com.sun.star.text.TableColumnSeparator">com.sun.star.text.TableColumnSeparator</a></span> &gt;. Defines the column width and its merging behavior. It contains a sequence of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TableColumnSeparator.html" title="see type com.sun.star.text.TableColumnSeparator">com.sun.star.text.TableColumnSeparator</a></span> structs with the fields Position and IsVisible. The value of Position is relative to the table property <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html#TableColumnRelativeSum" title="see TableColumnRelativeSum of type com.sun.star.text.TextTable:TableColumnRelativeSum">com.sun.star.text.TextTable:TableColumnRelativeSum</a></span>. IsVisible refers to merged cells where the separator becomes invisible. In tables with merged or split cells, the sequence TableColumnSeparators is empty.</p>
    </td></tr><tr><td style="text-align:left;width:4.21cm; " class="Table20A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html#TopMargin" title="see TopMargin of type com.sun.star.text.TextTable">TopMargin</a></span></p>
    </td><td style="text-align:left;width:11.229cm; " class="Table20B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">— </span>Determines the top margin. </p>
    </td></tr><tr><td style="text-align:left;width:4.21cm; " class="Table20A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTable.html#Width" title="see Width of type com.sun.star.text.TextTable">Width</a></span></p>
    </td><td style="text-align:left;width:11.229cm; " class="Table20B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">— </span>Contains the absolute table width. </p>
    </td></tr></table></div>
  <h4 class="Head4"><a name="1_3_4_6_Inserting_Tables" />Inserting Tables</h4>
  <p class="Paragraph">To create and insert a new text table, a five-step procedure must be followed: </p>
  <ol style="margin-left:0.5cm;list-style-type:decimal; ">
   <li class="P14" style="margin-left:2.5cm;"><p class="P14" style="margin-left:0cm;">Get the service manager of the text document, querying the document's factory interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/lang/XMultiServiceFactory.html" title="see type com.sun.star.lang.XMultiServiceFactory">com.sun.star.lang.XMultiServiceFactory</a></span>.</p></li>
   <li class="P14" style="margin-left:2.5cm;"><p class="P14" style="margin-left:0cm;">Order a new text table from the factory by its service name <span class="Codeintext">"com.sun.star.text.TextTable"</span>, using the factory method <span class="Codeintext">createInstance().</span></p></li>
   <li class="P14" style="margin-left:2.5cm;"><p class="P14" style="margin-left:0cm;">From the object received, query the <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextTable.html" title="see type com.sun.star.text.XTextTable">com.sun.star.text.XTextTable</a></span> interface that inherits from <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextContent.html" title="see type com.sun.star.text.XTextContent">com.sun.star.text.XTextContent</a></span>.</p></li>
   <li class="P14" style="margin-left:2.5cm;"><p class="P14" style="margin-left:0cm;">If necessary, initialize the table with the number of rows and columns. For this purpose, XTextTable offers the <span class="Codeintext">initialize() </span>method.</p></li>
   <li class="P14" style="margin-left:2.5cm;"><p class="P14" style="margin-left:0cm;">Insert the table into the text using the <span class="Codeintext">insertTextContent()</span> method at its <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XText.html" title="see type com.sun.star.text.XText">com.sun.star.text.XText</a></span> interface. The method <span class="Codeintext">insertTextContent()</span> expects an XTextContent to insert. Since <span class="Codeintext">XTextTable</span> inherits from <span class="Codeintext">XTextContent</span>, pass the <span class="Codeintext">XTextTable</span> interface retrieved previously.</p></li>
  </ol>
  <p class="Paragraph">You are now ready to get cells, fill in text, values and formulas and set the table and cell properties as needed. </p>
  <p class="Paragraph">In the following code sample, there is a small helper function to put random numbers between -1000 and 1000 into the table to demonstrate formulas: (<a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/examples/DevelopersGuide/Text/TextDocuments.java" title="goto source Text/TextDocuments.java">Text/TextDocuments.java</a>) </p>
  <p class="Code">/** This method returns a random double which isn't too high or too low </p>
  <p class="Code"> */</p>
  <p class="Code">protected double getRandomDouble() </p>
  <p class="Code">{ </p>
  <p class="Code">    return ((maRandom.nextInt() % 1000) * maRandom.nextDouble());</p>
  <p class="Code">} </p>
  <p class="Paragraph">The following helper function inserts a string into a cell known by its name and sets its text color to white: (<a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/examples/DevelopersGuide/Text/TextDocuments.java" title="goto source Text/TextDocuments.java">Text/TextDocuments.java</a>) </p>
  <p class="Code">/** This method sets the text colour of the cell refered to by sCellName to white and inserts </p>
  <p class="Code">    the string sText in it</p>
  <p class="Code"> */</p>
  <p class="Code">public static void insertIntoCell(String sCellName, String sText, XTextTable xTable) { </p>
  <p class="Code">    // Access the XText interface of the cell referred to by sCellName        </p>
  <p class="Code">    XText xCellText = (XText) UnoRuntime.queryInterface(</p>
  <p class="Code">        XText.class, xTable.getCellByName(sCellName));</p>
  <p class="Code"> </p>
  <p class="Code">    // create a text cursor from the cells XText interface</p>
  <p class="Code">    XTextCursor xCellCursor = xCellText.createTextCursor();</p>
  <p class="Code"> </p>
  <p class="Code">    // Get the property set of the cell's TextCursor</p>
  <p class="Code">    XPropertySet xCellCursorProps = (XPropertySet)UnoRuntime.queryInterface(</p>
  <p class="Code">        XPropertySet.class, xCellCursor);</p>
  <p class="Code"> </p>
  <p class="Code">    try {</p>
  <p class="Code">        // Set the colour of the text to white</p>
  <p class="Code">        xCellCursorProps.setPropertyValue("CharColor", new Integer(16777215));</p>
  <p class="Code">    } catch (Exception e) {</p>
  <p class="Code">        e.printStackTrace(System.out);</p>
  <p class="Code">    }</p>
  <p class="Code"> </p>
  <p class="Code">    // Set the text in the cell to sText</p>
  <p class="Code">    xCellText.setString(sText);</p>
  <p class="Code">} </p>
  <p class="Paragraph">Using the above helper functions, create a text table and insert it into the text document. (<a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/examples/DevelopersGuide/Text/TextDocuments.java" title="goto source Text/TextDocuments.java">Text/TextDocuments.java</a>) </p>
  <p class="Code">/** This method shows how to create and insert a text table, as well as insert text and formulae </p>
  <p class="Code">                into the cells of the table</p>
  <p class="Code"> */</p>
  <p class="Code">protected void TextTableExample () </p>
  <p class="Code">{ </p>
  <p class="Code">        try </p>
  <p class="Code">        {</p>
  <p class="Code">                // Create a new table from the document's factory</p>
  <p class="Code">                XTextTable xTable = (XTextTable) UnoRuntime.queryInterface( </p>
  <p class="Code">                        XTextTable.class, mxDocFactory .createInstance(</p>
  <p class="Code">                                "com.sun.star.text.TextTable" ) );</p>
  <p class="Code">                </p>
  <p class="Code">                // Specify that we want the table to have 4 rows and 4 columns</p>
  <p class="Code">                xTable.initialize( 4, 4 );</p>
  <p class="Code"> </p>
  <p class="Code">                // Insert the table into the document</p>
  <p class="Code">                mxDocText.insertTextContent( mxDocCursor, xTable, false);</p>
  <p class="Code">                // Get an XIndexAccess of the table rows</p>
  <p class="Code">                XIndexAccess xRows = xTable.getRows();</p>
  <p class="Code">                </p>
  <p class="Code">                // Access the property set of the first row (properties listed in service description:</p>
  <p class="Code">                // com.sun.star.text.TextTableRow)</p>
  <p class="Code">                XPropertySet xRow = (XPropertySet) UnoRuntime.queryInterface( </p>
  <p class="Code">                        XPropertySet.class, xRows.getByIndex ( 0 ) );</p>
  <p class="Code">                // If BackTransparant is false, then the background color is visible</p>
  <p class="Code">                xRow.setPropertyValue( "BackTransparent", new Boolean(false));</p>
  <p class="Code">                // Specify the color of the background to be dark blue</p>
  <p class="Code">                xRow.setPropertyValue( "BackColor", new Integer(6710932));</p>
  <p class="Code"> </p>
  <p class="Code">                // Access the property set of the whole table</p>
  <p class="Code">                XPropertySet xTableProps = (XPropertySet)UnoRuntime.queryInterface( </p>
  <p class="Code">                        XPropertySet.class, xTable );</p>
  <p class="Code">                // We want visible background colors</p>
  <p class="Code">                xTableProps.setPropertyValue( "BackTransparent", new Boolean(false));</p>
  <p class="Code">                // Set the background colour to light blue</p>
  <p class="Code">                xTableProps.setPropertyValue( "BackColor", new Integer(13421823));</p>
  <p class="Code"> </p>
  <p class="Code">                // set the text (and text colour) of all the cells in the first row of the table</p>
  <p class="Code">                insertIntoCell( "A1", "First Column", xTable );</p>
  <p class="Code">                insertIntoCell( "B1", "Second Column", xTable );</p>
  <p class="Code">                insertIntoCell( "C1", "Third Column", xTable );</p>
  <p class="Code">                insertIntoCell( "D1", "Results", xTable );</p>
  <p class="Code"> </p>
  <p class="Code">                // Insert random numbers into the first this three cells of each</p>
  <p class="Code">                // remaining row</p>
  <p class="Code">                xTable.getCellByName( "A2" ).setValue( getRandomDouble() );</p>
  <p class="Code">                xTable.getCellByName( "B2" ).setValue( getRandomDouble() );</p>
  <p class="Code">                xTable.getCellByName( "C2" ).setValue( getRandomDouble() );</p>
  <p class="Code"> </p>
  <p class="Code">                xTable.getCellByName( "A3" ).setValue( getRandomDouble() );</p>
  <p class="Code">                xTable.getCellByName( "B3" ).setValue( getRandomDouble() );</p>
  <p class="Code">                xTable.getCellByName( "C3" ).setValue( getRandomDouble() );</p>
  <p class="Code"> </p>
  <p class="Code">                xTable.getCellByName( "A4" ).setValue( getRandomDouble() );</p>
  <p class="Code">                xTable.getCellByName( "B4" ).setValue( getRandomDouble() );</p>
  <p class="Code">                xTable.getCellByName( "C4" ).setValue( getRandomDouble() );</p>
  <p class="Code"> </p>
  <p class="Code">                // Set the last cell in each row to be a formula that calculates</p>
  <p class="Code">                // the sum of the first three cells</p>
  <p class="Code">                xTable.getCellByName( "D2" ).setFormula( "sum &lt;A2:C2&gt;" );</p>
  <p class="Code">                xTable.getCellByName( "D3" ).setFormula( "sum &lt;A3:C3&gt;" );</p>
  <p class="Code">                xTable.getCellByName( "D4" ).setFormula( "sum &lt;A4:C4&gt;" );</p>
  <p class="Code">        } </p>
  <p class="Code">        catch (Exception e) </p>
  <p class="Code">        {</p>
  <p class="Code">                e.printStackTrace ( System.out );</p>
  <p class="Code">        }</p>
  <p class="Code">} </p>
  <p class="Paragraph">The next sample inserts auto text entries into a table, splitting cells during its course. (<a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/examples/DevelopersGuide/Text/TextDocuments.java" title="goto source Text/TextDocuments.java">Text/TextDocuments.java</a>) </p>
  <p class="Code">/** This example demonstrates the use of the AutoTextContainer, AutoTextGroup and AutoTextEntry services </p>
  <p class="Code">    and shows how to create, insert and modify auto text blocks</p>
  <p class="Code"> */</p>
  <p class="Code">protected void AutoTextExample () </p>
  <p class="Code">{ </p>
  <p class="Code">        try</p>
  <p class="Code">        {</p>
  <p class="Code">                // Go to the end of the document</p>
  <p class="Code">                mxDocCursor.gotoEnd( false );</p>
  <p class="Code">                // Insert two paragraphs</p>
  <p class="Code">                mxDocText.insertControlCharacter ( mxDocCursor, </p>
  <p class="Code">                        ControlCharacter.PARAGRAPH_BREAK, false );</p>
  <p class="Code">                mxDocText.insertControlCharacter ( mxDocCursor, </p>
  <p class="Code">                        ControlCharacter.PARAGRAPH_BREAK, false );</p>
  <p class="Code">                // Position the cursor in the second paragraph</p>
  <p class="Code">                XParagraphCursor xParaCursor = (XParagraphCursor) UnoRuntime.queryInterface(</p>
  <p class="Code">                        XParagraphCursor.class, mxDocCursor );</p>
  <p class="Code">                xParaCursor.gotoPreviousParagraph ( false );</p>
  <p class="Code"> </p>
  <p class="Code">                // Get an XNameAccess interface to all auto text groups from the document factory</p>
  <p class="Code">                XNameAccess xContainer = (XNameAccess) UnoRuntime.queryInterface( </p>
  <p class="Code">                        XNameAccess.class, mxFactory.createInstance (</p>
  <p class="Code">                                "com.sun.star.text.AutoTextContainer" ) );</p>
  <p class="Code"> </p>
  <p class="Code">                // Create a new table at the document factory        </p>
  <p class="Code">                XTextTable xTable = (XTextTable) UnoRuntime.queryInterface( </p>
  <p class="Code">                        XTextTable.class, mxDocFactory .createInstance( </p>
  <p class="Code">                                "com.sun.star.text.TextTable" ) );</p>
  <p class="Code"> </p>
  <p class="Code">                // Store the names of all auto text groups in an array of strings</p>
  <p class="Code">                String[] aGroupNames = xContainer.getElementNames();</p>
  <p class="Code">        </p>
  <p class="Code">                // Make sure we have at least one group name</p>
  <p class="Code">                if ( aGroupNames.length &gt; 0 ) </p>
  <p class="Code">                {</p>
  <p class="Code">                        // initialise the table to have a row for every autotext group </p>
  <p class="Code">                        //in a single column + one</p>
  <p class="Code">                        // additional row for a header</p>
  <p class="Code">                        xTable.initialize( aGroupNames.length+1,1);</p>
  <p class="Code"> </p>
  <p class="Code">                        // Access the XPropertySet of the table</p>
  <p class="Code">                        XPropertySet xTableProps = (XPropertySet)UnoRuntime.queryInterface(</p>
  <p class="Code">                                XPropertySet.class, xTable );</p>
  <p class="Code"> </p>
  <p class="Code">                        // We want a visible background</p>
  <p class="Code">                        xTableProps.setPropertyValue( "BackTransparent", new Boolean(false));</p>
  <p class="Code"> </p>
  <p class="Code">                        // We want the background to be light blue</p>
  <p class="Code">                        xTableProps.setPropertyValue( "BackColor", new Integer(13421823));</p>
  <p class="Code">                                </p>
  <p class="Code">                        // Inser the table into the document</p>
  <p class="Code">                        mxDocText.insertTextContent( mxDocCursor, xTable, false);</p>
  <p class="Code"> </p>
  <p class="Code">                        // Get an XIndexAccess to all table rows</p>
  <p class="Code">                        XIndexAccess xRows = xTable.getRows();</p>
  <p class="Code"> </p>
  <p class="Code">                        // Get the first row in the table</p>
  <p class="Code">                        XPropertySet xRow = (XPropertySet) UnoRuntime.queryInterface(</p>
  <p class="Code">                                XPropertySet.class, xRows.getByIndex ( 0 ) );</p>
  <p class="Code"> </p>
  <p class="Code">                        // We want the background of the first row to be visible too</p>
  <p class="Code">                        xRow.setPropertyValue( "BackTransparent", new Boolean(false));</p>
  <p class="Code">                </p>
  <p class="Code">                        // And let's make it dark blue</p>
  <p class="Code">                        xRow.setPropertyValue( "BackColor", new Integer(6710932));</p>
  <p class="Code">                                </p>
  <p class="Code">                        // Put a description of the table contents into the first cell</p>
  <p class="Code">                        insertIntoCell( "A1", "AutoText Groups", xTable);</p>
  <p class="Code"> </p>
  <p class="Code">                        // Create a table cursor pointing at the second cell in the first column</p>
  <p class="Code">                        XTextTableCursor xTableCursor = xTable.createCursorByCellName ( "A2" );</p>
  <p class="Code"> </p>
  <p class="Code">                        // Loop over the group names</p>
  <p class="Code">                        for ( int i = 0 ; i &lt; aGroupNames.length ; i ++ )</p>
  <p class="Code">                        {</p>
  <p class="Code">                                // Get the name of the current cell</p>
  <p class="Code">                                String sCellName = xTableCursor.getRangeName ();</p>
  <p class="Code"> </p>
  <p class="Code">                                // Get the XText interface of the current cell</p>
  <p class="Code">                                XText xCellText = (XText) UnoRuntime.queryInterface ( </p>
  <p class="Code">                                        XText.class, xTable.getCellByName ( sCellName ) );</p>
  <p class="Code"> </p>
  <p class="Code">                                // Set the cell contents of the current cell to be </p>
  <p class="Code">                                //the name of the of an autotext group</p>
  <p class="Code">                                xCellText.setString ( aGroupNames[i] );</p>
  <p class="Code"> </p>
  <p class="Code">                                // Access the autotext gruop with this name</p>
  <p class="Code">                                XAutoTextGroup xGroup = ( XAutoTextGroup ) UnoRuntime.queryInterface (</p>
  <p class="Code">                                        XAutoTextGroup.class,xContainer.getByName(aGroupNames[i]));</p>
  <p class="Code"> </p>
  <p class="Code">                                // Get the titles of each autotext block in this group</p>
  <p class="Code">                                String [] aBlockNames = xGroup.getTitles();</p>
  <p class="Code"> </p>
  <p class="Code">                                // Make sure that the autotext group contains at least one block</p>
  <p class="Code">                                if ( aBlockNames.length &gt; 0 )</p>
  <p class="Code">                                {</p>
  <p class="Code">                                        // Split the current cell vertically into two seperate cells</p>
  <p class="Code">                                        xTableCursor.splitRange ( (short) 1, false );</p>
  <p class="Code"> </p>
  <p class="Code">                                        // Put the cursor in the newly created right hand cell </p>
  <p class="Code">                                        // and select it</p>
  <p class="Code">                                        xTableCursor.goRight ( (short) 1, false );</p>
  <p class="Code"> </p>
  <p class="Code">                                        // Split this cell horizontally to make a seperate cell </p>
  <p class="Code">                                        // for each Autotext block</p>
  <p class="Code">                                        if ( ( aBlockNames.length -1 ) &gt; 0 )</p>
  <p class="Code">                                                xTableCursor.splitRange ( </p>
  <p class="Code">                                                        (short) (aBlockNames.length - 1), true );</p>
  <p class="Code"> </p>
  <p class="Code">                                        // loop over the block names</p>
  <p class="Code">                                        for ( int j = 0 ; j &lt; aBlockNames.length ; j ++ )</p>
  <p class="Code">                                        {</p>
  <p class="Code">                                                // Get the XText interface of the current cell</p>
  <p class="Code">                                                xCellText = (XText) UnoRuntime.queryInterface (</p>
  <p class="Code">                                                        XText.class, xTable.getCellByName (</p>
  <p class="Code">                                                                xTableCursor.getRangeName() ) );</p>
  <p class="Code"> </p>
  <p class="Code">                                                // Set the text contents of the current cell to the</p>
  <p class="Code">                                                  // title of an Autotext block</p>
  <p class="Code">                                                xCellText.setString ( aBlockNames[j] );</p>
  <p class="Code"> </p>
  <p class="Code">                                                // Move the cursor down one cell</p>
  <p class="Code">                                                xTableCursor.goDown( (short)1, false);</p>
  <p class="Code">                                        }</p>
  <p class="Code">                                }</p>
  <p class="Code">                                // Go back to the cell we originally split</p>
  <p class="Code">                                xTableCursor.gotoCellByName ( sCellName, false );</p>
  <p class="Code"> </p>
  <p class="Code">                                // Go down one cell</p>
  <p class="Code">                                xTableCursor.goDown( (short)1, false);</p>
  <p class="Code">                        }</p>
  <p class="Code"> </p>
  <p class="Code">                        XAutoTextGroup xGroup;</p>
  <p class="Code">                        String [] aBlockNames;</p>
  <p class="Code"> </p>
  <p class="Code">                        // Add a depth so that we only generate 200 numbers before </p>
  <p class="Code">                        // giving up on finding a random autotext group that contains autotext blocks</p>
  <p class="Code">                        int nDepth = 0;</p>
  <p class="Code">                        do</p>
  <p class="Code">                        {</p>
  <p class="Code">                                // Generate a random, positive number which is lower than </p>
  <p class="Code">                                // the number of autotext groups</p>
  <p class="Code">                                int nRandom = Math.abs ( maRandom.nextInt() % aGroupNames.length );</p>
  <p class="Code"> </p>
  <p class="Code">                                // Get the autotext group at this name</p>
  <p class="Code">                                xGroup         = ( XAutoTextGroup ) UnoRuntime.queryInterface (</p>
  <p class="Code">                                        XAutoTextGroup.class, xContainer.getByName (</p>
  <p class="Code">                                                aGroupNames[ nRandom ] ) );</p>
  <p class="Code">                                        </p>
  <p class="Code">                                // Fill our string array with the names of all the blocks in this</p>
  <p class="Code">                                // group</p>
  <p class="Code">                                aBlockNames = xGroup.getElementNames();</p>
  <p class="Code">                                </p>
  <p class="Code">                                // increment our depth counter</p>
  <p class="Code">                                ++nDepth;</p>
  <p class="Code">                        }</p>
  <p class="Code">                        while ( nDepth &lt; 200 &amp;&amp; aBlockNames.length == 0 );</p>
  <p class="Code">                        // If we managed to find a group containg blocks...</p>
  <p class="Code">                        if ( aBlockNames.length &gt; 0 )</p>
  <p class="Code">                        {</p>
  <p class="Code">                                // Pick a random block in this group and get it's</p>
  <p class="Code">                                // XAutoTextEntry interface</p>
  <p class="Code">                                int nRandom = Math.abs ( maRandom.nextInt() </p>
  <p class="Code">                                                        % aBlockNames.length );</p>
  <p class="Code">                                XAutoTextEntry xEntry = ( XAutoTextEntry )</p>
  <p class="Code">                                         UnoRuntime.queryInterface ( </p>
  <p class="Code">                                                XAutoTextEntry.class, xGroup.getByName (</p>
  <p class="Code">                                                         aBlockNames[ nRandom ] ) );</p>
  <p class="Code">                                // insert the modified autotext block at the end of the document</p>
  <p class="Code">                                xEntry.applyTo ( mxDocCursor );</p>
  <p class="Code">                                        </p>
  <p class="Code">                                // Get the titles of all text blocks in this AutoText group</p>
  <p class="Code">                                String [] aBlockTitles = xGroup.getTitles();</p>
  <p class="Code"> </p>
  <p class="Code">                                // Get the XNamed interface of the autotext group</p>
  <p class="Code">                                XNamed xGroupNamed = ( XNamed ) UnoRuntime.queryInterface (</p>
  <p class="Code">                                         XNamed.class, xGroup );</p>
  <p class="Code"> </p>
  <p class="Code">                                // Output the short cut and title of the random block </p>
  <p class="Code">                                //and the name of the group it's from</p>
  <p class="Code">                                System.out.println ( "Inserted the Autotext '" + aBlockTitles[nRandom] </p>
  <p class="Code">                                        + "', shortcut '" + aBlockNames[nRandom] + "' from group '" </p>
  <p class="Code">                                        + xGroupNamed.getName() );</p>
  <p class="Code">                        }</p>
  <p class="Code">                }</p>
  <p class="Code"> </p>
  <p class="Code">                // Go to the end of the document</p>
  <p class="Code">                mxDocCursor.gotoEnd( false );</p>
  <p class="Code">                // Insert new paragraph</p>
  <p class="Code">                mxDocText.insertControlCharacter ( </p>
  <p class="Code">                        mxDocCursor, ControlCharacter.PARAGRAPH_BREAK, false );</p>
  <p class="Code"> </p>
  <p class="Code">                // Position cursor in new paragraph</p>
  <p class="Code">                xParaCursor.gotoPreviousParagraph ( false );</p>
  <p class="Code"> </p>
  <p class="Code">                // Insert a string in the new paragraph</p>
  <p class="Code">                mxDocText.insertString ( mxDocCursor, "Some text for a new autotext block", false );</p>
  <p class="Code"> </p>
  <p class="Code">                // Go to the end of the document</p>
  <p class="Code">                mxDocCursor.gotoEnd( false );</p>
  <p class="Code">        }</p>
  <p class="Code">        catch (Exception e) </p>
  <p class="Code">        {</p>
  <p class="Code">                e.printStackTrace ( System.out );</p>
  <p class="Code">        }</p>
  <p class="Code">} </p>
  <h4 class="Head4"><a name="1_3_4_7_Accessing_Existing_Tables" />Accessing Existing Tables</h4>
  <p class="Paragraph">To access the tables contained in a text document, the text document model supports the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextTablesSupplier.html" title="see type com.sun.star.text.XTextTablesSupplier">com.sun.star.text.XTextTablesSupplier</a></span> with one single method <span class="Codeintext">getTextTables()</span>. It returns a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextTables.html" title="see type com.sun.star.text.TextTables">com.sun.star.text.TextTables</a></span> service, which is a named and indexed collection, that is, tables are retrieved using <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XNameAccess.html" title="see type com.sun.star.container.XNameAccess">com.sun.star.container.XNameAccess</a></span> or <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XIndexAccess.html" title="see type com.sun.star.container.XIndexAccess">com.sun.star.container.XIndexAccess</a></span>.</p>
  <p class="Paragraph">The following snippet iterates over the text tables in a given text document object <span class="Codeintext">mxDoc</span> and colors them green.</p>
  <p class="Code">import com.sun.star.text.XTextTablesSupplier; </p>
  <p class="Code">import com.sun.star.container.XNameAccess; </p>
  <p class="Code">import com.sun.star.container.XIndexAccess; </p>
  <p class="Code">import com.sun.star.beans.XPropertySet; </p>
  <p class="Code"> </p>
  <p class="Code">... </p>
  <p class="Code"> </p>
  <p class="Code">// first query the XTextTablesSupplier interface from our document </p>
  <p class="Code">XTextTablesSupplier xTablesSupplier = (XTextTablesSupplier) UnoRuntime.queryInterface( </p>
  <p class="Code">        XTextTablesSupplier.class, mxDoc );</p>
  <p class="Code">// get the tables collection </p>
  <p class="Code">XNameAccess xNamedTables = xTablesSupplier.getTextTables(); </p>
  <p class="Code"> </p>
  <p class="Code">// now query the XIndexAccess from the tables collection </p>
  <p class="Code">XIndexAccess xIndexedTables = (XIndexAccess) UnoRuntime.queryInterface( </p>
  <p class="Code">        XIndexAccess.class, xNamedTables);</p>
  <p class="Code"> </p>
  <p class="Code">// we need properties </p>
  <p class="Code">XPropertySet xTableProps = null; </p>
  <p class="Code"> </p>
  <p class="Code">// get the tables </p>
  <p class="Code">for (int i = 0; i &lt; xIndexedTables.getCount(); i++) { </p>
  <p class="Code">        Object table = xIndexedTables.getByIndex(i);</p>
  <p class="Code">        // the properties, please!</p>
  <p class="Code">        xTableProps = (XPropertySet) UnoRuntime.queryInterface(</p>
  <p class="Code">                XPropertySet.class, table);</p>
  <p class="Code">        </p>
  <p class="Code">        // color the table light green in format 0xRRGGBB</p>
  <p class="Code">        xTableProps.setPropertyValue("BackColor", new Integer(0xC8FFB9));</p>
  <p class="Code">}       </p>
  <h3 class="Head3"><a name="1_3_5_Text_Fields" />8.3.5  Text Fields</h3>
  <p class="Paragraph">Text fields are text contents that add a second level of information to text ranges. Usually their appearance fuses together with the surrounding text, but actually the presented text comes from elsewhere. Field commands can insert the current date, page number, total page numbers, a cross-reference to another area of text, the content of certain database fields, and many variables, such as fields with changing values, into the document. There are some fields that contain their own data, where others get the data from an attached field master. </p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table60"><colgroup><col width="821" /></colgroup><tr><td style="text-align:left;width:17.979cm; " class="Table60A1">
      <div class="Paragraph"><div style="width: 14.448cm; " id="Frame4" class="fr8">
        <div class="Illustration"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/Text/TextFields.png" title="link to the full-sized graphic &quot;./TextFields.png&quot;"><img border="0" width="654" height="751" alt="UML diagram showing the text field and text filed master services" src="./8 Text Documents_files/TextFields.png" class="fr9" /></a>Illustration <a name="refIllustration5">8.6</a>Text Fields and Text Field Masters</div>
       </div></div>
     </td></tr></table></div>
  <p class="Paragraph">Fields are created using the <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/lang/XMultiServiceFactory.html" title="see type com.sun.star.lang.XMultiServiceFactory">com.sun.star.lang.XMultiServiceFactory</a></span> of the model before inserting them using <span class="Codeintext">insertTextContent()</span>. The following text field services are available: </p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table4"><colgroup><col width="386" /><col width="319" /></colgroup><tr><td style="text-align:left;width:8.449cm; " class="Table4A1">
      <p class="TableHead">Text Field Service Name </p>
     </td><td style="text-align:left;width:6.99cm; " class="Table4B1">
      <p class="TableHead">Description </p>
     </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/Annotation.html" title="see type com.sun.star.text.textfield.Annotation">com.sun.star.text.textfield.Annotation</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Annotation created through  <span class="T2">Insert – Note.</span></p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/Author.html" title="see type com.sun.star.text.textfield.Author">com.sun.star.text.textfield.Author</a></span>        </p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the author of the document. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/Bibliography.html" title="see type com.sun.star.text.textfield.Bibliography">com.sun.star.text.textfield.Bibliography</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Bibliographic entry created by <span class="T2">Insert – Indexes and Tables – Bibliography Entry</span>. The content is the source of the creation of bibliographic indexes. The <span class="Codeintext">sequence &lt;PropertyValue&gt;</span> in the property "<span class="Codeintext">Fields</span>" contains pairs of the name of the field and its content, such as: </p>
     <ol style="margin-left:0.5cm;list-style-type:decimal; ">
      <li class="P15" style="margin-left:0cm;"><p class="P15" style="margin-left:0cm;">Identifier=ABC99 </p><p class="P16" style="margin-left:0cm;">BibliographicType=1 </p></li>
     </ol>
     <p class="TextInTable">The names of the fields are defined in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BibliographyDataField.html" title="see type com.sun.star.text.BibliographyDataField">com.sun.star.text.BibliographyDataField</a></span>. A bibliographic entry depends on <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/FieldMaster/Bibliography.html" title="see type com.sun.star.text.FieldMaster.Bibliography">com.sun.star.text.FieldMaster.Bibliography</a></span></p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/Chapter.html" title="see type com.sun.star.text.textfield.Chapter">com.sun.star.text.textfield.Chapter</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Show the chapter information. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/CharacterCount.html" title="see type com.sun.star.text.textfield.CharacterCount">com.sun.star.text.textfield.CharacterCount</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Show the character count of the document. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/CombinedCharacters.html" title="see type com.sun.star.text.textfield.CombinedCharacters">com.sun.star.text.textfield.CombinedCharacters</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Combines up to six characters as one text object that is formatted in two lines. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/ConditionalText.html" title="see type com.sun.star.text.textfield.ConditionalText">com.sun.star.text.textfield.ConditionalText</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Inserts text depending on a condition. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/Database.html" title="see type com.sun.star.text.textfield.Database">com.sun.star.text.textfield.Database</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">The form letter field showing the  content from a database. Depends on <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/FieldMaster/Database.html" title="see type com.sun.star.text.FieldMaster.Database">com.sun.star.text.FieldMaster.Database</a></span>.</p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/DatabaseName.html" title="see type com.sun.star.text.textfield.DatabaseName">com.sun.star.text.textfield.DatabaseName</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the name of a database. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/DatabaseNextSet.html" title="see type com.sun.star.text.textfield.DatabaseNextSet">com.sun.star.text.textfield.DatabaseNextSet</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Increments the cursor that points to a database selection. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/DatabaseNumberOfSet.html" title="see type com.sun.star.text.textfield.DatabaseNumberOfSet">com.sun.star.text.textfield.DatabaseNumberOfSet</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the set number of a database cursor. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/DatabaseSetNumber.html" title="see type com.sun.star.text.textfield.DatabaseSetNumber">com.sun.star.text.textfield.DatabaseSetNumber</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Databases - Any Record. Sets the number of a database cursor. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/DateTime.html" title="see type com.sun.star.text.textfield.DateTime">com.sun.star.text.textfield.DateTime</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows a date or time value. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/DDE.html" title="see type com.sun.star.text.textfield.DDE">com.sun.star.text.textfield.DDE</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the result of a DDE operation. Depends on <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/FieldMaster/DDE.html" title="see type com.sun.star.text.FieldMaster.DDE">com.sun.star.text.FieldMaster.DDE</a></span>.</p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/docinfo/ChangeAuthor.html" title="see type com.sun.star.text.textfield.docinfo.ChangeAuthor">com.sun.star.text.textfield.docinfo.ChangeAuthor</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the name of the author of the last change of the document. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/docinfo/ChangeDateTime.html" title="see type com.sun.star.text.textfield.docinfo.ChangeDateTime">com.sun.star.text.textfield.docinfo.ChangeDateTime</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the date and time of the last change of the document. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/docinfo/CreateAuthor.html" title="see type com.sun.star.text.textfield.docinfo.CreateAuthor">com.sun.star.text.textfield.docinfo.CreateAuthor</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the name of the creator of the document. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/docinfo/CreateDateTime.html" title="see type com.sun.star.text.textfield.docinfo.CreateDateTime">com.sun.star.text.textfield.docinfo.CreateDateTime</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the date and time of the document creation. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/docinfo/Description.html" title="see type com.sun.star.text.textfield.docinfo.Description">com.sun.star.text.textfield.docinfo.Description</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the description contained in the document information. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/docinfo/EditTime.html" title="see type com.sun.star.text.textfield.docinfo.EditTime">com.sun.star.text.textfield.docinfo.EditTime</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the time of the editing of the document. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/docinfo/Info0.html" title="see type com.sun.star.text.textfield.docinfo.Info0">com.sun.star.text.textfield.docinfo.Info0</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the content of the first user defined info field of the document info. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/docinfo/Info1.html" title="see type com.sun.star.text.textfield.docinfo.Info1">com.sun.star.text.textfield.docinfo.Info1</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the content of the second user defined info field of the document info. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/docinfo/Info2.html" title="see type com.sun.star.text.textfield.docinfo.Info2">com.sun.star.text.textfield.docinfo.Info2</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the content of the third user defined info field of the document info. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/docinfo/Info3.html" title="see type com.sun.star.text.textfield.docinfo.Info3">com.sun.star.text.textfield.docinfo.Info3</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the content of the fourth user defined info field of the document info. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/docinfo/Keywords.html" title="see type com.sun.star.text.textfield.docinfo.Keywords">com.sun.star.text.textfield.docinfo.Keywords</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the keywords contained in the document info. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/docinfo/PrintAuthor.html" title="see type com.sun.star.text.textfield.docinfo.PrintAuthor">com.sun.star.text.textfield.docinfo.PrintAuthor</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the name of the author of the last printing. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/docinfo/PrintDateTime.html" title="see type com.sun.star.text.textfield.docinfo.PrintDateTime">com.sun.star.text.textfield.docinfo.PrintDateTime</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the date and time of the last printing. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/docinfo/Revision.html" title="see type com.sun.star.text.textfield.docinfo.Revision">com.sun.star.text.textfield.docinfo.Revision</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the revision contained in the document info. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/docinfo/Subject.html" title="see type com.sun.star.text.textfield.docinfo.Subject">com.sun.star.text.textfield.docinfo.Subject</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the subject contained in the document info. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/docinfo/Title.html" title="see type com.sun.star.text.textfield.docinfo.Title">com.sun.star.text.textfield.docinfo.Title</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the title contained in the document info. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/EmbeddedObjectCount.html" title="see type com.sun.star.text.textfield.EmbeddedObjectCount">com.sun.star.text.textfield.EmbeddedObjectCount</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the number of embedded objects contained in the document. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/ExtendedUser.html" title="see type com.sun.star.text.textfield.ExtendedUser">com.sun.star.text.textfield.ExtendedUser</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the user data of the Office user. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/FileName.html" title="see type com.sun.star.text.textfield.FileName">com.sun.star.text.textfield.FileName</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the file name (URL) of the document. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/GetExpression.html" title="see type com.sun.star.text.textfield.GetExpression">com.sun.star.text.textfield.GetExpression</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable"><span class="T1">Variables – Show Variable</span>. Shows the value set by the previous occurrence of SetExpression.</p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/GetReference.html" title="see type com.sun.star.text.textfield.GetReference">com.sun.star.text.textfield.GetReference</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">References – Insert Reference. Shows a reference to a reference mark, bookmark, number range field, footnote or an endnote. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/GraphicObjectCount.html" title="see type com.sun.star.text.textfield.GraphicObjectCount">com.sun.star.text.textfield.GraphicObjectCount</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the number of graphic object in the document. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/HiddenParagraph.html" title="see type com.sun.star.text.textfield.HiddenParagraph">com.sun.star.text.textfield.HiddenParagraph</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Depending on a condition, the field hides the paragraph it is contained in. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/HiddenText.html" title="see type com.sun.star.text.textfield.HiddenText">com.sun.star.text.textfield.HiddenText</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Depending on a condition the field shows or hides a text. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/Input.html" title="see type com.sun.star.text.textfield.Input">com.sun.star.text.textfield.Input</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">The field activates a dialog to input a value that changes a related User field or <span class="Codeintext">SetExpression</span> field.</p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/InputUser.html" title="see type com.sun.star.text.textfield.InputUser">com.sun.star.text.textfield.InputUser</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">The field activates a dialog to input a string that is displayed by the field. This field is not connected to variables. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/JumpEdit.html" title="see type com.sun.star.text.textfield.JumpEdit">com.sun.star.text.textfield.JumpEdit</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">A placeholder field with an attached interaction to insert text, a text table, text frame, graphic object or an OLE object. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/Macro.html" title="see type com.sun.star.text.textfield.Macro">com.sun.star.text.textfield.Macro</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">A field connected to a macro that is executed on a click to the field. To execute such a macro, use the dispatch (cf. Appendix). </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/PageCount.html" title="see type com.sun.star.text.textfield.PageCount">com.sun.star.text.textfield.PageCount</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the number of pages of the  document.</p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/PageNumber.html" title="see type com.sun.star.text.textfield.PageNumber">com.sun.star.text.textfield.PageNumber</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the page number (current, previous, next). </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/ParagraphCount.html" title="see type com.sun.star.text.textfield.ParagraphCount">com.sun.star.text.textfield.ParagraphCount</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the number of paragraphs contained in the document. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/ReferencePageGet.html" title="see type com.sun.star.text.textfield.ReferencePageGet">com.sun.star.text.textfield.ReferencePageGet</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Displays the page number with respect to the reference point, that is determined by the text field <span class="Codeintext">ReferencePageSet</span>.</p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/ReferencePageSet.html" title="see type com.sun.star.text.textfield.ReferencePageSet">com.sun.star.text.textfield.ReferencePageSet</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Inserts a starting point for additional page numbers that can be switched on or off. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/Script.html" title="see type com.sun.star.text.textfield.Script">com.sun.star.text.textfield.Script</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Contains a script or a URL to a script. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/SetExpression.html" title="see type com.sun.star.text.textfield.SetExpression">com.sun.star.text.textfield.SetExpression</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Variables – Set Variable. A variable field. The value is valid until the next occurrence of SetExpression field. The actual value depends on <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/FieldMaster/SetExpression.html" title="see type com.sun.star.text.FieldMaster.SetExpression">com.sun.star.text.FieldMaster.SetExpression</a></span>.</p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/TableCount.html" title="see type com.sun.star.text.textfield.TableCount">com.sun.star.text.textfield.TableCount</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the number of text tables of the document. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/TableFormula.html" title="see type com.sun.star.text.textfield.TableFormula">com.sun.star.text.textfield.TableFormula</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Contains a formula to calculate in a text table. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/TemplateName.html" title="see type com.sun.star.text.textfield.TemplateName">com.sun.star.text.textfield.TemplateName</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the name of the template the current document is created from. </p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/User.html" title="see type com.sun.star.text.textfield.User">com.sun.star.text.textfield.User</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Variables - User Field. Creates a global document variable and displays it whenever this field occurs in the text. Depends on <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/FieldMaster/User.html" title="see type com.sun.star.text.FieldMaster.User">com.sun.star.text.FieldMaster.User</a></span>.</p>
    </td></tr><tr><td style="text-align:left;width:8.449cm; " class="Table4A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/WordCount.html" title="see type com.sun.star.text.textfield.WordCount">com.sun.star.text.textfield.WordCount</a></span></p>
    </td><td style="text-align:left;width:6.99cm; " class="Table4B2">
     <p class="TextInTable">Shows the number of words contained in the document. </p>
    </td></tr></table></div>
  <p class="Paragraph">All fields support the interfaces <span class="T16"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextField.html" title="see type com.sun.star.text.XTextField">com.sun.star.text.XTextField</a></span><span class="T17">, </span><span class="T16"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/util/XUpdatable.html" title="see type com.sun.star.util.XUpdatable">com.sun.star.util.XUpdatable</a></span><span class="T17">, </span><span class="T16"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XDependentTextField.html" title="see type com.sun.star.text.XDependentTextField">com.sun.star.text.XDependentTextField</a></span><span class="T17"> and the service </span><span class="T16"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextContent.html" title="see type com.sun.star.text.TextContent">com.sun.star.text.TextContent</a></span><span class="T17">.</span></p>
  <p class="Paragraph"><span class="T17">The method </span><span class="T16">getPresentation()</span><span class="T17"> of the interface </span><span class="T16"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextField.html" title="see type com.sun.star.text.XTextField">com.sun.star.text.XTextField</a></span><span class="T17"> returns the textual representation of the result of the text field operation, such as a date, time, variable value, or the command, such as CHAPTER, TIME (fixed)</span> depending on the boolean parameter.</p>
  <p class="P17">The method <span class="Codeintext">update()</span> of the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/util/XUpdatable.html" title="see type com.sun.star.util.XUpdatable">com.sun.star.util.XUpdatable</a></span> affects only the following field types:</p>
  <ul style="margin-left:0.5cm;">
   <li class="P18" style="margin-left:2.5cm;"><p class="P18" style="margin-left:0cm;">Date and time fields are set to the current date and time. </p></li>
   <li class="P18" style="margin-left:2.5cm;"><p class="P18" style="margin-left:0cm;">The <span class="Codeintext">ExtendedUser</span> fields that show parts of the user data set for OpenOffice.org, such as the Name, City, Phone No. and the Author fields that are set to the current values.</p></li>
   <li class="P19" style="margin-left:2.5cm;"><p class="P19" style="margin-left:0cm;"><span class="T17">The </span><span class="T16">FileName</span><span class="T17"> fields are updated with the current name of the file.</span></p></li>
   <li class="P19" style="margin-left:2.5cm;"><p class="P19" style="margin-left:0cm;"><span class="T17">The </span><span class="T16">DocInfo.XXX</span><span class="T17"> fields are updated with the current document info of the document.</span></p></li>
  </ul>
  <p class="P17">All other fields ignore calls to <span class="Codeintext">update()</span>.</p>
  <p class="Paragraph"><span class="T17">Some of these fields need a field master that provides the data that appears in the field. This applies to the field types </span><span class="Codeintext">Database</span>, <span class="Codeintext">SetExpression</span>, <span class="Codeintext">DDE</span>, <span class="Codeintext">User</span> and <span class="Codeintext">Bibliography</span>. <span class="T17">The interface </span><span class="T16"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XDependentTextField.html" title="see type com.sun.star.text.XDependentTextField">com.sun.star.text.XDependentTextField</a></span><span class="T17"> handles these pairs of FieldMasters and TextFields. The method </span><span class="T16">attachTextFieldMaster()</span><span class="T17"> must be called prior to inserting the field into the document. The method </span><span class="T16">getTextFieldMaster()</span><span class="T17"> does not work unless the dependent field is inserted into the document.</span></p>
  <p class="Paragraph">To create a valid text field master, the instance has to be created using the <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/lang/XMultiServiceFactory.html" title="see type com.sun.star.lang.XMultiServiceFactory">com.sun.star.lang.XMultiServiceFactory</a></span> interface of the model with the appropriate service name:</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table42"><colgroup><col width="353" /><col width="353" /></colgroup><tr><td style="text-align:left;width:7.719cm; " class="Table42A1">
      <p class="TableHead">Text Field Master Service Names </p>
     </td><td style="text-align:left;width:7.721cm; " class="Table42B1">
      <p class="TableHead">Description </p>
     </td></tr><tr><td style="text-align:left;width:7.719cm; " class="Table42A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/FieldMaster/User.html" title="see type com.sun.star.text.FieldMaster.User">com.sun.star.text.FieldMaster.User</a></span></p>
    </td><td style="text-align:left;width:7.721cm; " class="Table42B2">
     <p class="TextInTable">Contains the global variable that is created and displayed by the fieldtype <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/User.html" title="see type com.sun.star.text.textfield.User">com.sun.star.text.textfield.User</a></span>.</p>
    </td></tr><tr><td style="text-align:left;width:7.719cm; " class="Table42A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/FieldMaster/DDE.html" title="see type com.sun.star.text.FieldMaster.DDE">com.sun.star.text.FieldMaster.DDE</a></span></p>
    </td><td style="text-align:left;width:7.721cm; " class="Table42B2">
     <p class="TextInTable">The DDE command for a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/DDE.html" title="see type com.sun.star.text.textfield.DDE">com.sun.star.text.textfield.DDE</a></span>.</p>
    </td></tr><tr><td style="text-align:left;width:7.719cm; " class="Table42A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/FieldMaster/SetExpression.html" title="see type com.sun.star.text.FieldMaster.SetExpression">com.sun.star.text.FieldMaster.SetExpression</a></span></p>
    </td><td style="text-align:left;width:7.721cm; " class="Table42B2">
     <p class="TextInTable">Numbering settings if the corresponding <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/SetExpression.html" title="see type com.sun.star.text.textfield.SetExpression">com.sun.star.text.textfield.SetExpression</a></span> is a number range. A sub type of expression.</p>
    </td></tr><tr><td style="text-align:left;width:7.719cm; " class="Table42A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/FieldMaster/Database.html" title="see type com.sun.star.text.FieldMaster.Database">com.sun.star.text.FieldMaster.Database</a></span></p>
    </td><td style="text-align:left;width:7.721cm; " class="Table42B2">
     <p class="TextInTable">Data source definition for a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/Database.html" title="see type com.sun.star.text.textfield.Database">com.sun.star.text.textfield.Database</a></span>.</p>
    </td></tr><tr><td style="text-align:left;width:7.719cm; " class="Table42A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/FieldMaster/Bibliography.html" title="see type com.sun.star.text.FieldMaster.Bibliography">com.sun.star.text.FieldMaster.Bibliography</a></span></p>
    </td><td style="text-align:left;width:7.721cm; " class="Table42B2">
     <p class="TextInTable">Display settings and sorting for <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/Bibliography.html" title="see type com.sun.star.text.textfield.Bibliography">com.sun.star.text.textfield.Bibliography</a></span>.</p>
    </td></tr></table></div>
  <p class="Paragraph">The property <span class="Codeintext">Name</span> has to be set after the field instance is created, except for the <span class="Codeintext">Database</span> field master type where the properties <span class="Codeintext">DatabaseName</span>, <span class="Codeintext">DatabaseTableName</span>, <span class="Codeintext">DataColumnName</span> and <span class="Codeintext">DatabaseCommandType</span> are set instead of the <span class="Codeintext">Name</span> property.</p>
  <p class="Paragraph">To access existing text fields and field masters, use the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextFieldsSupplier.html" title="see type com.sun.star.text.XTextFieldsSupplier">com.sun.star.text.XTextFieldsSupplier</a></span> that is implemented at the text document model. </p>
  <p class="Paragraph">Its method <span class="Codeintext">getTextFields()</span> returns a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextFields.html" title="see type com.sun.star.text.TextFields">com.sun.star.text.TextFields</a></span> container which is a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XEnumerationAccess.html" title="see type com.sun.star.container.XEnumerationAccess">com.sun.star.container.XEnumerationAccess</a></span> and can be refreshed through the <span class="Codeintext">refresh()</span> method in its interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/util/XRefreshable.html" title="see type com.sun.star.util.XRefreshable">com.sun.star.util.XRefreshable</a></span>.</p>
  <p class="Paragraph">Its method <span class="Codeintext">getTextFieldMasters()</span> returns a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextFieldMasters.html" title="see type com.sun.star.text.TextFieldMasters">com.sun.star.text.TextFieldMasters</a></span> container holding the text field masters of the document. This container provides a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XNameAccess.html" title="see type com.sun.star.container.XNameAccess">com.sun.star.container.XNameAccess</a></span> interface. All field masters, except for <span class="Codeintext">Database</span> are named by the service name followed by the name of the field master. The <span class="Codeintext">Database</span> field masters create their names by appending the <span class="Codeintext">DatabaseName</span>, <span class="Codeintext">DataTableName</span> and <span class="Codeintext">DataColumnName</span> to the service name. </p>
  <p class="P20">Consider the following examples for this naming convention: </p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table43"><colgroup><col width="479" /><col width="226" /></colgroup><tr><td style="text-align:left;width:10.492cm; " class="Table43A1">
      <p class="TextInTable">"com.sun.star.text.FieldMaster.SetExpression.Illustration" </p>
     </td><td style="text-align:left;width:4.948cm; " class="Table43B1">
      <p class="TextInTable">Master for Illustration number range. Number ranges are built-in <span class="Codeintext">SetExpression</span> fields present in every document.</p>
     </td></tr><tr><td style="text-align:left;width:10.492cm; " class="Table43A2">
     <p class="TextInTable">"com.sun.star.text.FieldMaster.User.Company" </p>
    </td><td style="text-align:left;width:4.948cm; " class="Table43B2">
     <p class="TextInTable">Master for User field (global document variable), inserted with display name Company. </p>
    </td></tr><tr><td style="text-align:left;width:10.492cm; " class="Table43A2">
     <p class="TextInTable">"com.sun.star.text.FieldMaster.Database.Bibliography.biblio.Identifier" </p>
    </td><td style="text-align:left;width:4.948cm; " class="Table43B2">
     <p class="TextInTable">Master for form letter field referring to the column Identifier in the built-in dbase database table biblio. </p>
    </td></tr></table></div>
  <p class="P21">Each text field master has a property <span class="Codeintext">InstanceName</span> that contains its name in the format of the related container. </p>
  <p class="P21">Some <span class="Codeintext">SetExpression</span> text field masters are always available if they are not deleted. These are the masters with the names Text, Illustration, Table and Drawing. They are predefined as number range field masters used for captions of text frames, graphics, text tables and drawings. Note that these predefined names are internal names that are usually not used at the user interface. </p>
  <p class="Paragraph">The following methods show how to create and insert text fields. (<a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/examples/DevelopersGuide/Text/TextDocuments.java" title="goto source Text/TextDocuments.java">Text/TextDocuments.java</a>) </p>
  <p class="Code">/** This method inserts both a date field and a user field containing the number '42' </p>
  <p class="Code"> */</p>
  <p class="Code">protected void TextFieldExample() { </p>
  <p class="Code">    try {</p>
  <p class="Code">        // Use the text document's factory to create a DateTime text field, </p>
  <p class="Code">        // and access it's</p>
  <p class="Code">        // XTextField interface</p>
  <p class="Code">        XTextField xDateField = (XTextField) UnoRuntime.queryInterface(</p>
  <p class="Code">            XTextField.class, mxDocFactory.createInstance(</p>
  <p class="Code">                "com.sun.star.text.TextField.DateTime"));</p>
  <p class="Code"> </p>
  <p class="Code">        // Insert it at the end of the document</p>
  <p class="Code">        mxDocText.insertTextContent ( mxDocText.getEnd(), xDateField, false );</p>
  <p class="Code"> </p>
  <p class="Code">        // Use the text document's factory to create a user text field, </p>
  <p class="Code">        // and access it's XDependentTextField interface</p>
  <p class="Code">        XDependentTextField xUserField = (XDependentTextField) UnoRuntime.queryInterface (</p>
  <p class="Code">            XDependentTextField.class, mxDocFactory.createInstance(</p>
  <p class="Code">                "com.sun.star.text.textField.User"));</p>
  <p class="Code"> </p>
  <p class="Code">        // Create a fieldmaster for our newly created User Text field, and access it's </p>
  <p class="Code">        // XPropertySet interface</p>
  <p class="Code">        XPropertySet xMasterPropSet = (XPropertySet) UnoRuntime.queryInterface(</p>
  <p class="Code">            XPropertySet.class, mxDocFactory.createInstance(</p>
  <p class="Code">                "com.sun.star.text.FieldMaster.User"));</p>
  <p class="Code"> </p>
  <p class="Code">        // Set the name and value of the FieldMaster</p>
  <p class="Code">        xMasterPropSet.setPropertyValue ("Name", "UserEmperor");</p>
  <p class="Code">        xMasterPropSet.setPropertyValue ("Value", new Integer(42));</p>
  <p class="Code"> </p>
  <p class="Code">        // Attach the field master to the user field</p>
  <p class="Code">        xUserField.attachTextFieldMaster (xMasterPropSet);</p>
  <p class="Code"> </p>
  <p class="Code">        // Move the cursor to the end of the document</p>
  <p class="Code">        mxDocCursor.gotoEnd(false);</p>
  <p class="Code">        // insert a paragraph break using the XSimpleText interface</p>
  <p class="Code">        mxDocText.insertControlCharacter( </p>
  <p class="Code">            mxDocCursor, ControlCharacter.PARAGRAPH_BREAK, false);</p>
  <p class="Code"> </p>
  <p class="Code">        // Insert the user field at the end of the document</p>
  <p class="Code">        mxDocText.insertTextContent(mxDocText.getEnd(), xUserField, false);</p>
  <p class="Code">    } catch (Exception e) {</p>
  <p class="Code">        e.printStackTrace (System.out);</p>
  <p class="Code">    }</p>
  <p class="Code">} </p>
  <h3 class="Head3"><a name="1_3_6_Bookmarks" />8.3.6  Bookmarks</h3>
  <p class="Paragraph">A Bookmark is a text content that marks a position inside of a paragraph or a text selection that supports the <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextContent.html" title="see type com.sun.star.text.TextContent">com.sun.star.text.TextContent</a></span> service. To search for a bookmark, the text document model implements the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XBookmarksSupplier.html" title="see type com.sun.star.text.XBookmarksSupplier">com.sun.star.text.XBookmarksSupplier</a></span> that supplies a collection of the bookmarks. The collection supports the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Bookmarks.html" title="see type com.sun.star.text.Bookmarks">com.sun.star.text.Bookmarks</a></span> which consists of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XNameAccess.html" title="see type com.sun.star.container.XNameAccess">com.sun.star.container.XNameAccess</a></span> and <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XIndexAccess.html" title="see type com.sun.star.container.XIndexAccess">com.sun.star.container.XIndexAccess</a></span>.</p>
  <p class="Paragraph">The bookmark name can be read and changed through its (<span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XNamed.html" title="see type com.sun.star.container.XNamed">com.sun.star.container.XNamed</a></span>) interface. </p>
  <p class="Paragraph">To insert, remove or change text, or attributes starting from the position of a bookmark, retrieve its <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextRange.html" title="see type com.sun.star.text.XTextRange">com.sun.star.text.XTextRange</a></span> by calling <span class="Codeintext">getAnchor()</span> at its <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextContent.html" title="see type com.sun.star.text.XTextContent">com.sun.star.text.XTextContent</a></span> interface. Then use <span class="Codeintext">getString()</span> or <span class="Codeintext">setString()</span> at the <span class="Codeintext">XTextRange,</span> or pass this <span class="Codeintext">XTextRange</span> to methods expecting a text range, such as <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XSimpleText.html#createTextCursorByRange" title="see createTextCursorByRange of type com.sun.star.text.XSimpleText:createTextCursorByRange">com.sun.star.text.XSimpleText:createTextCursorByRange</a>()</span>, <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XSimpleText.html#insertString" title="see insertString of type com.sun.star.text.XSimpleText:insertString">com.sun.star.text.XSimpleText:insertString</a>()</span> or <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XText.html#insertTextContent" title="see insertTextContent of type com.sun.star.text.XText:insertTextContent">com.sun.star.text.XText:insertTextContent</a>()</span>.</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table2"><colgroup><col width="112" /><col width="709" /></colgroup><tr><td style="text-align:left;width:2.45cm; " class="Table2A1">
      <div class="TextInTable"><img width="39" height="39" alt="Tip graphics marks a hint section in the text" src="./8 Text Documents_files/tip.gif" class="fr5" /></div>
     </td><td style="text-align:left;width:15.529cm; " class="Table2B1">
      <p class="TipInTable">Make sure that the access to the bookmark anchor position always uses the correct text object. Since every <span class="Codeintext">XTextRange</span> knows its surrounding text, use the <span class="Codeintext">getText() </span>method of the bookmark's anchor. It is not allowed to call <span class="Codeintext">aText.createTextCursorByRange(oAnchor)</span> when <span class="Codeintext">aText</span> represents a different area of the document than the bookmark (different text frames, body text and text frame...)</p>
     </td></tr></table></div>
  <p class="Paragraph">Use the <span class="Codeintext">createInstance </span>method of the <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/lang/XMultiServiceFactory.html" title="see type com.sun.star.lang.XMultiServiceFactory">com.sun.star.lang.XMultiServiceFactory</a></span> interface provided by the text document model to insert an new bookmark into the document. The service name is <span class="Codeintext">"com.sun.star.text.Bookmark"</span>. Then use the bookmark's <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XNamed.html" title="see type com.sun.star.container.XNamed">com.sun.star.container.XNamed</a></span> interface and call <span class="Codeintext">setName()</span>. If no name is set, OpenOffice.org makes up generic names, such as Bookmark1 and Bookmark2. Similarly, if a name is used that is not unique, writer automatically appends a number to the bookmark name. The bookmark object obtained from <span class="Codeintext">createInstance()</span> can only be inserted once. </p>
  <p class="Code">// inserting and retrieving a bookmark </p>
  <p class="Code">Object bookmark = mxDocFactory.createInstance ( "com.sun.star.text.Bookmark" ); </p>
  <p class="Code"> </p>
  <p class="Code">// name the bookmark </p>
  <p class="Code">XNamed xNamed = (XNamed) UnoRuntime.queryInterface (  </p>
  <p class="Code">        XNamed.class, bookmark );</p>
  <p class="Code">xNamed.setName("MyUniqueBookmarkName"); </p>
  <p class="P22"> </p>
  <p class="Code">// get XTextContent interface  </p>
  <p class="Code">XTextContent xTextContent = (XTextContent) UnoRuntime.queryInterface (  </p>
  <p class="Code">        XTextContent.class, bookmark );</p>
  <p class="Code"> </p>
  <p class="Code">// insert bookmark at the end of the document </p>
  <p class="Code">// instead of mxDocText.getEnd you could use a text cursor's XTextRange interface or any XTextRange </p>
  <p class="Code">mxDocText.insertTextContent ( mxDocText.getEnd(), xTextContent, false );            </p>
  <p class="Code">            </p>
  <p class="Code">// query XBookmarksSupplier from document model and get bookmarks collection </p>
  <p class="Code">XBookmarksSupplier xBookmarksSupplier = (XBookmarksSupplier)UnoRuntime.queryInterface( </p>
  <p class="Code">        XBookmarksSupplier.class, xWriterComponent);</p>
  <p class="Code">XNameAccess xNamedBookmarks = xBookmarksSupplier.getBookmarks(); </p>
  <p class="Code"> </p>
  <p class="Code">// retrieve bookmark by name </p>
  <p class="Code">Object foundBookmark = xNamedBookmarks.getByName("MyUniqueBookmarkName"); </p>
  <p class="Code">XTextContent xFoundBookmark = (XTextContent)UnoRuntime.queryInterface( </p>
  <p class="Code">        XTextContent.class, foundBookmark);</p>
  <p class="Code"> </p>
  <p class="Code">// work with bookmark </p>
  <p class="Code">XTextRange xFound = xFoundBookmark.getAnchor(); </p>
  <p class="Code">xFound.setString(" The throat mike, glued to her neck, "  </p>
  <p class="Code">        + "looked as much as possible like an analgesic dermadisk.");</p>
  <h3 class="Head3"><a name="1_3_7_Indexes_and_Index_Marks" />8.3.7  Indexes and Index Marks</h3>
  <p class="Paragraph">Indexes are text contents that pull together information that is dispersed over the document. They can contain chapter headings, locations of key words, locations of arbitrary index marks and locations of text objects, such as illustrations, objects or tables. In addition, OpenOffice.org features a bibliographical index.  </p>
  <h4 class="Head4"><a name="1_3_7_1_Indexes" />Indexes</h4>
  <p class="Paragraph">The following index services are available in OpenOffice.org: </p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table8"><colgroup><col width="351" /><col width="354" /></colgroup><tr><td style="text-align:left;width:7.694cm; " class="Table8A1">
      <p class="TableHead">Index Service Name </p>
     </td><td style="text-align:left;width:7.749cm; " class="Table8B1">
      <p class="TableHead">Description </p>
     </td></tr><tr><td style="text-align:left;width:7.694cm; " class="Table8A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/DocumentIndex.html" title="see type com.sun.star.text.DocumentIndex">com.sun.star.text.DocumentIndex</a></span></p>
    </td><td style="text-align:left;width:7.749cm; " class="Table8B2">
     <p class="TextInTable">alphabetical index </p>
    </td></tr><tr><td style="text-align:left;width:7.694cm; " class="Table8A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ContentIndex.html" title="see type com.sun.star.text.ContentIndex">com.sun.star.text.ContentIndex</a></span></p>
    </td><td style="text-align:left;width:7.749cm; " class="Table8B2">
     <p class="TextInTable">table of contents </p>
    </td></tr><tr><td style="text-align:left;width:7.694cm; " class="Table8A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/UserIndex.html" title="see type com.sun.star.text.UserIndex">com.sun.star.text.UserIndex</a></span></p>
    </td><td style="text-align:left;width:7.749cm; " class="Table8B2">
     <p class="TextInTable">user defined index </p>
    </td></tr><tr><td style="text-align:left;width:7.694cm; " class="Table8A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/IllustrationIndex.html" title="see type com.sun.star.text.IllustrationIndex">com.sun.star.text.IllustrationIndex</a></span></p>
    </td><td style="text-align:left;width:7.749cm; " class="Table8B2">
     <p class="TextInTable">table of all illustrations contained in the document </p>
    </td></tr><tr><td style="text-align:left;width:7.694cm; " class="Table8A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ObjectIndex.html" title="see type com.sun.star.text.ObjectIndex">com.sun.star.text.ObjectIndex</a></span></p>
    </td><td style="text-align:left;width:7.749cm; " class="Table8B2">
     <p class="TextInTable">table of all objects contained in the document </p>
    </td></tr><tr><td style="text-align:left;width:7.694cm; " class="Table8A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TableIndex.html" title="see type com.sun.star.text.TableIndex">com.sun.star.text.TableIndex</a></span></p>
    </td><td style="text-align:left;width:7.749cm; " class="Table8B2">
     <p class="TextInTable">table of all text tables contained in the document </p>
    </td></tr><tr><td style="text-align:left;width:7.694cm; " class="Table8A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Bibliography.html" title="see type com.sun.star.text.Bibliography">com.sun.star.text.Bibliography</a></span></p>
    </td><td style="text-align:left;width:7.749cm; " class="Table8B2">
     <p class="TextInTable">bibliographical index </p>
    </td></tr></table></div>
  <p class="Paragraph">To access the indexes of a document, the text document model supports the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XDocumentIndexesSupplier.html" title="see type com.sun.star.text.XDocumentIndexesSupplier">com.sun.star.text.XDocumentIndexesSupplier</a></span> with a single method <span class="Codeintext">getDocumentIndexes()</span>. The returned object is a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/DocumentIndexes.html" title="see type com.sun.star.text.DocumentIndexes">com.sun.star.text.DocumentIndexes</a></span> service supporting the interfaces <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XIndexAccess.html" title="see type com.sun.star.container.XIndexAccess">com.sun.star.container.XIndexAccess</a></span> and <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XNameAccess.html" title="see type com.sun.star.container.XNameAccess">com.sun.star.container.XNameAccess</a></span>.</p>
  <p class="Paragraph">All indexes support the services <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextContent.html" title="see type com.sun.star.text.TextContent">com.sun.star.text.TextContent</a></span> and <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseIndex.html" title="see type com.sun.star.text.BaseIndex">com.sun.star.text.BaseIndex</a></span> that include the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XDocumentIndex.html" title="see type com.sun.star.text.XDocumentIndex">com.sun.star.text.XDocumentIndex</a></span>. This interface is used to access the service name of the index and update the current content of an index:</p>
  <p class="MethodSignatures">string <span class="T2">getServiceName</span>()</p>
  <p class="MethodSignatures">void <span class="T2">update</span>()</p>
  <p class="Paragraph">Furthermore, indexes have properties and a name, and support: </p>
  <ul style="margin-left:0.5cm;">
   <li class="P23" style="margin-left:2.5cm;"><p class="P23" style="margin-left:0cm;"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/beans/XPropertySet.html" title="see type com.sun.star.beans.XPropertySet">com.sun.star.beans.XPropertySet</a></span><br />provides the properties that determine how the index is created and which elements are included into the index.</p></li>
   <li class="P23" style="margin-left:2.5cm;"><p class="P23" style="margin-left:0cm;"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XNamed.html" title="see type com.sun.star.container.XNamed">com.sun.star.container.XNamed</a></span><br />provides a unique name of the index, not necessarily the title of the index.</p></li>
  </ul>
  <p class="Paragraph">An index is usually composed of two text sections which are provided as properties. The provided property <span class="Codeintext">ContentSection</span> includes the complete index and the property <span class="Codeintext">HeaderSection</span> contains the title if there is one. They enable the index to have background or column attributes independent of the surrounding page format valid at the index position. In addition, there may be different settings for the content and the heading of the index. However, these text sections are not part of the document's text section container. </p>
  <p class="Paragraph">The indexes are structured by levels. The number of levels depends on the index type. The content index has ten levels, corresponding to the number of available chapter numbering levels, which is ten. Alphabetical indexes have four levels, one of which is used to insert separators, that are usually characters that show the alphabet. The bibliography has 22 levels, according to the number of available bibliographical type entries (<span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BibliographyDataType.html" title="see type com.sun.star.text.BibliographyDataType">com.sun.star.text.BibliographyDataType</a></span>). All other index types only have one level. </p>
  <p class="Paragraph">For all levels, define a separate structure that is provided by the property <span class="Codeintext">LevelFormat</span> of the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseIndex.html" title="see type com.sun.star.text.BaseIndex">com.sun.star.text.BaseIndex</a></span>. <span class="Codeintext">LevelFormat</span> contains the various levels as a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XIndexReplace.html" title="see type com.sun.star.container.XIndexReplace">com.sun.star.container.XIndexReplace</a></span> object. Each level is a sequence of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/beans/PropertyValues.html" title="see type com.sun.star.beans.PropertyValues">com.sun.star.beans.PropertyValues</a></span> which are defined in the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/DocumentIndexLevelFormat.html" title="see type com.sun.star.text.DocumentIndexLevelFormat">com.sun.star.text.DocumentIndexLevelFormat</a></span>. Although <span class="Codeintext">LevelFormat</span> provides a level for the heading, changing that level is not supported. </p>
  <p class="Paragraph">Each <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/beans/PropertyValues.html" title="see type com.sun.star.beans.PropertyValues">com.sun.star.beans.PropertyValues</a></span> sequence has to contain at least one <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/beans/PropertyValue.html" title="see type com.sun.star.beans.PropertyValue">com.sun.star.beans.PropertyValue</a></span> with the name <span class="Codeintext">TokenType</span>. This <span class="Codeintext">PropertyValue</span> struct must contain one of the following string values in its <span class="Codeintext">Value</span> member variable:</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table9"><colgroup><col width="199" /><col width="320" /><col width="186" /></colgroup><tr><td style="text-align:left;width:4.353cm; " class="Table9A1">
      <p class="TableHead">TokenType Value (String) </p>
     </td><td style="text-align:left;width:7.015cm; " class="Table9A1">
      <p class="TableHead">Meaning </p>
     </td><td style="text-align:left;width:4.071cm; " class="Table9C1">
      <p class="TableHead">Additional Sequence Members (optional) </p>
     </td></tr><tr><td style="text-align:left;width:4.353cm; " class="Table9A2">
     <p class="P24">“TokenEntryNumber” </p>
    </td><td style="text-align:left;width:7.015cm; " class="Table9A2">
     <p class="P24">The number of an entry. This is only supported in tables of content and it marks the appearance of the chapter number.  </p>
    </td><td style="text-align:left;width:4.071cm; " class="Table9C2">
     <p class="P24">CharacterStyleName </p>
    </td></tr><tr><td style="text-align:left;width:4.353cm; " class="Table9A2">
     <p class="P24">“TokenEntryText” </p>
    </td><td style="text-align:left;width:7.015cm; " class="Table9A2">
     <p class="P24">Text of the entry, for example, it might contain the heading text in tables of content or the name of a text reference in a bibliography. </p>
    </td><td style="text-align:left;width:4.071cm; " class="Table9C2">
     <p class="P24">CharacterStyleName </p>
    </td></tr><tr><td style="text-align:left;width:4.353cm; " class="Table9A2">
     <p class="P24">“TokenTabStop” </p>
    </td><td style="text-align:left;width:7.015cm; " class="Table9A2">
     <p class="P24">Marks a tab stop to be inserted.  </p>
    </td><td style="text-align:left;width:4.071cm; " class="Table9C2">
     <p class="P24">TabStopPosition<br />TabStopRightAligned<br />TabStopFillCharacters<br />CharacterStyleName</p>
    </td></tr><tr><td style="text-align:left;width:4.353cm; " class="Table9A2">
     <p class="P24">“TokenText” </p>
    </td><td style="text-align:left;width:7.015cm; " class="Table9A2">
     <p class="P24">Inserted text. </p>
    </td><td style="text-align:left;width:4.071cm; " class="Table9C2">
     <p class="P24">CharacterStyleName<br />Text</p>
    </td></tr><tr><td style="text-align:left;width:4.353cm; " class="Table9A2">
     <p class="P24">“TokenPageNumber” </p>
    </td><td style="text-align:left;width:7.015cm; " class="Table9A2">
     <p class="P24">Marks the insertion of the page number.  </p>
    </td><td style="text-align:left;width:4.071cm; " class="Table9C2">
     <p class="P24">CharacterStyleName </p>
    </td></tr><tr><td style="text-align:left;width:4.353cm; " class="Table9A2">
     <p class="P24">“TokenChapterInfo” </p>
    </td><td style="text-align:left;width:7.015cm; " class="Table9A2">
     <p class="P24">Marks the insertion of a chapter field to be inserted. Only supported in alphabetical indexes. </p>
    </td><td style="text-align:left;width:4.071cm; " class="Table9C2">
     <p class="P24">CharacterStyleName </p>
     <p class="P24">ChapterFormat </p>
    </td></tr><tr><td style="text-align:left;width:4.353cm; " class="Table9A2">
     <p class="P24">“TokenHyperlinkStart” </p>
    </td><td style="text-align:left;width:7.015cm; " class="Table9A2">
     <p class="P24">Start of a hyperlink to jump to the referred heading. Only supported in tables of content. </p>
    </td><td style="text-align:left;width:4.071cm; " class="Table9C2">
     <p class="P24"> </p>
    </td></tr><tr><td style="text-align:left;width:4.353cm; " class="Table9A2">
     <p class="P24">“TokenHyperlinkEnd” </p>
    </td><td style="text-align:left;width:7.015cm; " class="Table9A2">
     <p class="P24">End of a hyperlink to jump to the referred heading. Only supported in tables of content. </p>
    </td><td style="text-align:left;width:4.071cm; " class="Table9C2">
     <p class="P24"> </p>
    </td></tr><tr><td style="text-align:left;width:4.353cm; " class="Table9A2">
     <p class="P24">“TokenBibliographyDataField” </p>
    </td><td style="text-align:left;width:7.015cm; " class="Table9A2">
     <p class="P24">Identifies one of the 30 possible BibliographyDataFields. The number 30 comes from the IDL reference of BilbliographyDataFields. </p>
     <p class="P24"> </p>
    </td><td style="text-align:left;width:4.071cm; " class="Table9C2">
     <p class="P24">BibliographyDataField<br />CharacterStyleName</p>
    </td></tr></table></div>
  <p class="Paragraph">An example for such a sequence of <span class="Codeintext">PropertyValue</span> struct could be constructed like this:</p>
  <p class="Code">PropertyValue[] indexTokens = new PropertyValue[1]; </p>
  <p class="Code">indexTokens [0] = new PropertyValue(); </p>
  <p class="Code">indexTokens [0].Name = "TokenType"; </p>
  <p class="Code">indexTokens [0].Value = "TokenHyperlinkStart";  </p>
  <p class="Paragraph">The following table explains the sequence members which can be present, in addition to the <span class="Codeintext">TokenType</span> member, as mentioned above. </p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table10"><colgroup><col width="198" /><col width="507" /></colgroup><tr><td colspan="2" style="text-align:left;width:4.332cm; " class="Table10A1">
      <p class="TableHead">Additional Properties of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/DocumentIndexLevelFormat.html" title="see type com.sun.star.text.DocumentIndexLevelFormat">com.sun.star.text.DocumentIndexLevelFormat</a></span></p>
     </td></tr><tr><td style="text-align:left;width:4.332cm; " class="Table10A2">
     <p class="TextInTable"><span class="Codeintext">CharacterStyleName</span></p>
    </td><td style="text-align:left;width:11.107cm; " class="Table10B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">—</span> Name of the character style that has to be applied to the appearance of the entry.</p>
    </td></tr><tr><td style="text-align:left;width:4.332cm; " class="Table10A2">
     <p class="TextInTable"><span class="Codeintext">TabStopPosition</span></p>
    </td><td style="text-align:left;width:11.107cm; " class="Table10B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">—</span> Position of the tab stop in 1/100 mm.</p>
    </td></tr><tr><td style="text-align:left;width:4.332cm; " class="Table10A2">
     <p class="TextInTable"><span class="Codeintext">TabStopRightAligned</span></p>
    </td><td style="text-align:left;width:11.107cm; " class="Table10B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> The tab stop is to be inserted at the end of the line and right aligned. This is used before page number entries.</p>
    </td></tr><tr><td style="text-align:left;width:4.332cm; " class="Table10A2">
     <p class="TextInTable"><span class="Codeintext">TabStopFillCharacters</span></p>
    </td><td style="text-align:left;width:11.107cm; " class="Table10B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">—</span> The first character of this string is used as a fill character for the tab stop. </p>
    </td></tr><tr><td style="text-align:left;width:4.332cm; " class="Table10A2">
     <p class="TextInTable"><span class="Codeintext">ChapterFormat</span></p>
    </td><td style="text-align:left;width:11.107cm; " class="Table10B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">—</span> Type of the chapter info as defined in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ChapterFormat.html" title="see type com.sun.star.text.ChapterFormat">com.sun.star.text.ChapterFormat</a></span>. </p>
    </td></tr><tr><td style="text-align:left;width:4.332cm; " class="Table10A2">
     <p class="TextInTable"><span class="Codeintext">BibliographyDataField</span></p>
    </td><td style="text-align:left;width:11.107cm; " class="Table10B2">
     <p class="TextInTable">Type of the bibliographical entry as defined in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BibliographyDataField.html" title="see type com.sun.star.text.BibliographyDataField">com.sun.star.text.BibliographyDataField</a></span>.</p>
    </td></tr></table></div>
  <h4 class="Head4"><a name="1_3_7_2_Index_marks" />Index marks</h4>
  <p class="Paragraph">Index marks are text contents whose contents and positions are collected and displayed in indexes. </p>
  <p class="Paragraph">To access all index marks that are related to an index, use the property <span class="Codeintext">IndexMarks</span> of the index. It contains a sequence of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XDocumentIndexMark.html" title="see type com.sun.star.text.XDocumentIndexMark">com.sun.star.text.XDocumentIndexMark</a></span> interfaces.</p>
  <p class="Paragraph">All index marks support the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseIndexMark.html" title="see type com.sun.star.text.BaseIndexMark">com.sun.star.text.BaseIndexMark</a></span> that includes <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextContent.html" title="see type com.sun.star.text.TextContent">com.sun.star.text.TextContent</a></span>. Also, they all implement the interfaces <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XDocumentIndexMark.html" title="see type com.sun.star.text.XDocumentIndexMark">com.sun.star.text.XDocumentIndexMark</a></span> and <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/beans/XPropertySet.html" title="see type com.sun.star.beans.XPropertySet">com.sun.star.beans.XPropertySet</a></span>.</p>
  <p class="Paragraph">The <span class="Codeintext">XDocumentIndexMark</span> inherits from <span class="Codeintext">XTextContent</span> and defines two methods:</p>
  <p class="MethodSignatures">string <span class="MethodSignatureEmphasis">getMarkEntry</span>()</p>
  <p class="MethodSignatures">void <span class="MethodSignatureEmphasis">setMarkEntry</span>( [in] string anIndexEntry)</p>
  <p class="Paragraph">OpenOffice.org supports three different index mark services:  </p>
  <ul style="margin-left:0.5cm;">
   <li class="P25" style="margin-left:2.5cm;"><p class="P25" style="margin-left:0cm;"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/DocumentIndexMark.html" title="see type com.sun.star.text.DocumentIndexMark">com.sun.star.text.DocumentIndexMark</a></span> for entries in alphabetical indexes.</p></li>
   <li class="P25" style="margin-left:2.5cm;"><p class="P25" style="margin-left:0cm;"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/UserIndexMark.html" title="see type com.sun.star.text.UserIndexMark">com.sun.star.text.UserIndexMark</a></span> for user defined indexes.</p></li>
   <li class="P25" style="margin-left:2.5cm;"><p class="P25" style="margin-left:0cm;"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ContentIndexMark.html" title="see type com.sun.star.text.ContentIndexMark">com.sun.star.text.ContentIndexMark</a></span> for entries in tables of content which are independent from chapter headings. </p></li>
  </ul>
  <p class="Paragraph">An index mark can be set at a point in text or it can mark a portion of a paragraph, usually a word. It cannot contain text across paragraph breaks. If the index mark does not include text, the <span class="Codeintext">BaseIndexMark</span> property <span class="Codeintext">AlternativeText</span> has to be set, otherwise there will be no string to insert into the index.</p>
  <p class="Paragraph">Inserting <span class="Codeintext">ContentIndexMarks</span> and a table of contents index: (<a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/examples/DevelopersGuide/Text/TextDocuments.java" title="goto source Text/TextDocuments.java">Text/TextDocuments.java</a>)</p>
  <p class="Code">/** This method demonstrates how to insert indexes and index marks </p>
  <p class="Code"> */</p>
  <p class="Code">protected void IndexExample () </p>
  <p class="Code">{ </p>
  <p class="Code">        try</p>
  <p class="Code">        {</p>
  <p class="Code">                // Go to the end of the document</p>
  <p class="Code">                mxDocCursor.gotoEnd( false );</p>
  <p class="Code">                // Insert a new paragraph and position the cursor in it</p>
  <p class="Code">                mxDocText.insertControlCharacter ( mxDocCursor, ControlCharacter.PARAGRAPH_BREAK, false );</p>
  <p class="Code">                XParagraphCursor xParaCursor = (XParagraphCursor) </p>
  <p class="Code">                        UnoRuntime.queryInterface( XParagraphCursor.class, mxDocCursor );</p>
  <p class="Code">                xParaCursor.gotoPreviousParagraph ( false );</p>
  <p class="Code"> </p>
  <p class="Code">                // Create a new ContentIndexMark and get it's XPropertySet interface</p>
  <p class="Code">                XPropertySet xEntry = (XPropertySet) UnoRuntime.queryInterface( XPropertySet.class, </p>
  <p class="Code">                        mxDocFactory.createInstance ( "com.sun.star.text.ContentIndexMark" ) );</p>
  <p class="Code"> </p>
  <p class="Code">                // Set the text to be displayed in the index</p>
  <p class="Code">                xEntry.setPropertyValue ( "AlternativeText", "Big dogs! Falling on my head!" );</p>
  <p class="Code"> </p>
  <p class="Code">                // The Level property _must_ be set</p>
  <p class="Code">                xEntry.setPropertyValue ( "Level", new Short ( (short) 1 ) );</p>
  <p class="Code"> </p>
  <p class="Code">                // Create a ContentIndex and access it's XPropertySet interface</p>
  <p class="Code">                XPropertySet xIndex = (XPropertySet) UnoRuntime.queryInterface( XPropertySet.class, </p>
  <p class="Code">                        mxDocFactory.createInstance ( "com.sun.star.text.ContentIndex" ) );</p>
  <p class="Code">                        </p>
  <p class="Code">                // Again, the Level property _must_ be set</p>
  <p class="Code">                xIndex.setPropertyValue ( "Level", new Short ( (short) 10 ) );</p>
  <p class="Code"> </p>
  <p class="Code">                // Access the XTextContent interfaces of both the Index and the IndexMark</p>
  <p class="Code">                XTextContent xIndexContent = (XTextContent) UnoRuntime.queryInterface( </p>
  <p class="Code">                        XTextContent.class, xIndex );</p>
  <p class="Code">                XTextContent xEntryContent = (XTextContent) UnoRuntime.queryInterface( </p>
  <p class="Code">                        XTextContent.class, xEntry );</p>
  <p class="Code"> </p>
  <p class="Code">                // Insert both in the document</p>
  <p class="Code">                mxDocText.insertTextContent ( mxDocCursor, xEntryContent, false );</p>
  <p class="Code">                mxDocText.insertTextContent ( mxDocCursor, xIndexContent, false );</p>
  <p class="Code"> </p>
  <p class="Code">                // Get the XDocumentIndex interface of the Index</p>
  <p class="Code">                XDocumentIndex xDocIndex = (XDocumentIndex) UnoRuntime.queryInterface( </p>
  <p class="Code">                        XDocumentIndex.class, xIndex );</p>
  <p class="Code"> </p>
  <p class="Code">                // And call it's update method</p>
  <p class="Code">                xDocIndex.update();</p>
  <p class="Code">        }</p>
  <p class="Code">        catch (Exception e) </p>
  <p class="Code">        {</p>
  <p class="Code">                e.printStackTrace ( System.out );</p>
  <p class="Code">        }</p>
  <p class="Code"> </p>
  <p class="Code">} </p>
  <h3 class="Head3"><a name="1_3_8_Reference_Marks" />8.3.8  Reference Marks</h3>
  <p class="Paragraph">A reference mark is a text content that is used as a target for <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/GetReference.html" title="see type com.sun.star.text.textfield.GetReference">com.sun.star.text.textfield.GetReference</a></span> text fields. These text fields show the contents of reference marks in a text document and allows the user to jump to the reference mark. Reference marks support the <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextContent.html" title="see type com.sun.star.text.XTextContent">com.sun.star.text.XTextContent</a></span> and <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XNamed.html" title="see type com.sun.star.container.XNamed">com.sun.star.container.XNamed</a></span> interfaces. They can be accessed by using the text document's <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XReferenceMarksSupplier.html" title="see type com.sun.star.text.XReferenceMarksSupplier">com.sun.star.text.XReferenceMarksSupplier</a></span> interface that defines a single method <span class="Codeintext">getReferenceMarks()</span>. </p>
  <p class="Paragraph">The returned collection is a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ReferenceMarks.html" title="see type com.sun.star.text.ReferenceMarks">com.sun.star.text.ReferenceMarks</a></span> service which has a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XNameAccess.html" title="see type com.sun.star.container.XNameAccess">com.sun.star.container.XNameAccess</a></span> and a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XIndexAccess.html" title="see type com.sun.star.container.XIndexAccess">com.sun.star.container.XIndexAccess</a></span> interface. (<a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/examples/DevelopersGuide/Text/TextDocuments.java" title="goto source Text/TextDocuments.java">Text/TextDocuments.java</a>)</p>
  <p class="Code">/** This method demonstrates how to create and insert reference marks, and GetReference Text Fields </p>
  <p class="Code"> */</p>
  <p class="Code">protected void ReferenceExample () { </p>
  <p class="Code">    try {</p>
  <p class="Code">        // Go to the end of the document</p>
  <p class="Code">        mxDocCursor.gotoEnd(false);</p>
  <p class="Code">                        </p>
  <p class="Code">        // Insert a paragraph break</p>
  <p class="Code">        mxDocText.insertControlCharacter( </p>
  <p class="Code">            mxDocCursor, ControlCharacter.PARAGRAPH_BREAK, false);</p>
  <p class="Code">                        </p>
  <p class="Code">        // Get the Paragraph cursor</p>
  <p class="Code">        XParagraphCursor xParaCursor = (XParagraphCursor) UnoRuntime.queryInterface(</p>
  <p class="Code">            XParagraphCursor.class, mxDocCursor);</p>
  <p class="Code"> </p>
  <p class="Code">        // Move the cursor into the new paragraph</p>
  <p class="Code">        xParaCursor.gotoPreviousParagraph(false);</p>
  <p class="Code"> </p>
  <p class="Code">        // Create a new ReferenceMark and get it's XNamed interface</p>
  <p class="Code">        XNamed xRefMark = (XNamed) UnoRuntime.queryInterface(XNamed.class, </p>
  <p class="Code">            mxDocFactory.createInstance("com.sun.star.text.ReferenceMark"));</p>
  <p class="Code"> </p>
  <p class="Code">        // Set the name to TableHeader</p>
  <p class="Code">        xRefMark.setName("TableHeader");</p>
  <p class="Code">        </p>
  <p class="Code">        // Get the TextTablesSupplier interface of the document</p>
  <p class="Code">        XTextTablesSupplier xTableSupplier = (XTextTablesSupplier) UnoRuntime.queryInterface(</p>
  <p class="Code">            XTextTablesSupplier.class, mxDoc);</p>
  <p class="Code"> </p>
  <p class="Code">        // Get an XIndexAccess of TextTables</p>
  <p class="Code">        XIndexAccess xTables = (XIndexAccess) UnoRuntime.queryInterface(</p>
  <p class="Code">            XIndexAccess.class, xTableSupplier.getTextTables());</p>
  <p class="Code">                        </p>
  <p class="Code">        // We've only inserted one table, so get the first one from index zero</p>
  <p class="Code">        XTextTable xTable = (XTextTable) UnoRuntime.queryInterface(</p>
  <p class="Code">            XTextTable.class, xTables.getByIndex(0));</p>
  <p class="Code"> </p>
  <p class="Code">        // Get the first cell from the table</p>
  <p class="Code">        XText xTableText = (XText) UnoRuntime.queryInterface(</p>
  <p class="Code">            XText.class, xTable.getCellByName("A1"));</p>
  <p class="Code"> </p>
  <p class="Code">        // Get a text cursor for the first cell</p>
  <p class="Code">        XTextCursor xTableCursor = xTableText.createTextCursor();</p>
  <p class="Code"> </p>
  <p class="Code">        // Get the XTextContent interface of the reference mark so we can insert it</p>
  <p class="Code">        XTextContent xContent = (XTextContent) UnoRuntime.queryInterface(</p>
  <p class="Code">            XTextContent.class, xRefMark);</p>
  <p class="Code"> </p>
  <p class="Code">        // Insert the reference mark into the first cell of the table</p>
  <p class="Code">        xTableText.insertTextContent (xTableCursor, xContent, false);</p>
  <p class="Code"> </p>
  <p class="Code">        // Create a 'GetReference' text field to refer to the reference mark we just inserted,</p>
  <p class="Code">        // and get it's XPropertySet interface</p>
  <p class="Code">        XPropertySet xFieldProps = (XPropertySet) UnoRuntime.queryInterface(</p>
  <p class="Code">            XPropertySet.class, mxDocFactory.createInstance(</p>
  <p class="Code">                "com.sun.star.text.TextField.GetReference"));</p>
  <p class="Code"> </p>
  <p class="Code">        // Get the XReferenceMarksSupplier interface of the document</p>
  <p class="Code">        XReferenceMarksSupplier xRefSupplier = (XReferenceMarksSupplier) UnoRuntime.queryInterface(</p>
  <p class="Code">            XReferenceMarksSupplier.class, mxDoc);</p>
  <p class="Code"> </p>
  <p class="Code">        // Get an XNameAccess which refers to all inserted reference marks</p>
  <p class="Code">        XNameAccess xMarks = (XNameAccess) UnoRuntime.queryInterface(XNameAccess.class,</p>
  <p class="Code">            xRefSupplier.getReferenceMarks());</p>
  <p class="Code"> </p>
  <p class="Code">        // Put the names of each reference mark into an array of strings</p>
  <p class="Code">        String[] aNames = xMarks.getElementNames();</p>
  <p class="Code"> </p>
  <p class="Code">        // Make sure that at least 1 reference mark actually exists </p>
  <p class="Code">        // (well, we just inserted one!)</p>
  <p class="Code">        if (aNames.length &gt; 0) {</p>
  <p class="Code">            // Output the name of the first reference mark ('TableHeader')</p>
  <p class="Code">            System.out.println ("GetReference text field inserted for ReferenceMark : " </p>
  <p class="Code">                + aNames[0]);</p>
  <p class="Code"> </p>
  <p class="Code">            // Set the SourceName of the GetReference text field to 'TableHeader'</p>
  <p class="Code">            xFieldProps.setPropertyValue("SourceName", aNames[0]);</p>
  <p class="Code"> </p>
  <p class="Code">            // specify that the source is a reference mark (could also be a footnote,</p>
  <p class="Code">            // bookmark or sequence field)</p>
  <p class="Code">            xFieldProps.setPropertyValue ("ReferenceFieldSource", new Short(</p>
  <p class="Code">                ReferenceFieldSource.REFERENCE_MARK));</p>
  <p class="Code"> </p>
  <p class="Code">            // We want the reference displayed as 'above' or 'below'</p>
  <p class="Code">            xFieldProps.setPropertyValue("ReferenceFieldPart", </p>
  <p class="Code">                new Short (ReferenceFieldPart.UP_DOWN));</p>
  <p class="Code"> </p>
  <p class="Code">            // Get the XTextContent interface of the GetReference text field</p>
  <p class="Code">            XTextContent xRefContent = (XTextContent) UnoRuntime.queryInterface(</p>
  <p class="Code">                XTextContent.class, xFieldProps);</p>
  <p class="Code"> </p>
  <p class="Code">            // Go to the end of the document</p>
  <p class="Code">            mxDocCursor.gotoEnd(false);</p>
  <p class="Code"> </p>
  <p class="Code">            // Make some text to precede the reference</p>
  <p class="Code">            mxDocText.insertString(mxDocText.getEnd(), "The table ", false);</p>
  <p class="Code"> </p>
  <p class="Code">            // Insert the text field</p>
  <p class="Code">            mxDocText.insertTextContent(mxDocText.getEnd(), xRefContent, false);</p>
  <p class="Code"> </p>
  <p class="Code">            // And some text after the reference..</p>
  <p class="Code">            mxDocText.insertString( mxDocText.getEnd(), </p>
  <p class="Code">                " contains the sum of some random numbers.", false);</p>
  <p class="Code"> </p>
  <p class="Code">            // Refresh the document</p>
  <p class="Code">            XRefreshable xRefresh = (XRefreshable) UnoRuntime.queryInterface(</p>
  <p class="Code">                XRefreshable.class, mxDoc);</p>
  <p class="Code">            xRefresh.refresh();</p>
  <p class="Code">        }</p>
  <p class="Code">    } catch (Exception e) {</p>
  <p class="Code">        e.printStackTrace(System.out);</p>
  <p class="Code">    }</p>
  <p class="Code">} </p>
  <p class="Paragraph">The name of a reference mark can be used in a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/textfield/GetReference.html" title="see type com.sun.star.text.textfield.GetReference">com.sun.star.text.textfield.GetReference</a></span> text field to refer to the position of the reference mark. </p>
  <h3 class="Head3"><a name="1_3_9_Footnotes_and_Endnotes" />8.3.9  Footnotes and Endnotes</h3>
  <p class="Paragraph">Footnotes and endnotes are text contents that provide background information for the reader that appears in page footers or at the end of a document. </p>
  <p class="Paragraph">Footnotes and endnotes  implement the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Footnote.html" title="see type com.sun.star.text.Footnote">com.sun.star.text.Footnote</a></span> that includes <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextContent.html" title="see type com.sun.star.text.TextContent">com.sun.star.text.TextContent</a></span>. The <span class="Codeintext">Footnote</span> service has the interfaces <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XText.html" title="see type com.sun.star.text.XText">com.sun.star.text.XText</a></span> and <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XFootnote.html" title="see type com.sun.star.text.XFootnote">com.sun.star.text.XFootnote</a></span> that inherit from <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextContent.html" title="see type com.sun.star.text.XTextContent">com.sun.star.text.XTextContent</a></span>. The <span class="Codeintext">XFootnote</span> introduces the following methods:</p>
  <p class="MethodSignatures">string <span class="T2">getLabel</span>()</p>
  <p class="MethodSignatures">void <span class="T2">setLabel</span>( [in] string aLabel)</p>
  <p class="Paragraph">The <span class="Codeintext">Footnote</span> service defines a property <span class="Codeintext">ReferenceId</span> that is used for import and export, and contains an internal sequential number.</p>
  <p class="Paragraph">The interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XText.html" title="see type com.sun.star.text.XText">com.sun.star.text.XText</a></span> which is provided by the <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Footnote.html" title="see type com.sun.star.text.Footnote">com.sun.star.text.Footnote</a></span> service accesses the text object in the footnote area where the footnote text is located. It is not allowed to insert text tables into this text object. </p>
  <p class="Paragraph">While footnotes can be placed at the end of a page or the end of a document, endnotes always appear at the end of a document. Endnote numbering is separate from footnote numbering. Footnotes are accessed using the <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XFootnotesSupplier.html" title="see type com.sun.star.text.XFootnotesSupplier">com.sun.star.text.XFootnotesSupplier</a></span> interface of the text document through the method <span class="Codeintext">getFootNotes()</span><span class="T18">. </span><span class="T19">E</span>ndnotes are accessed similarly by calling <span class="Codeintext">getEndnotes()</span>at the text document's <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XEndnotesSupplier.html" title="see type com.sun.star.text.XEndnotesSupplier">com.sun.star.text.XEndnotesSupplier</a></span> interface. Both of these methods return a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XIndexAccess.html" title="see type com.sun.star.container.XIndexAccess">com.sun.star.container.XIndexAccess</a></span>.</p>
  <p class="Paragraph">A label is set for a footnote or endnote to determine if automatic footnote numbering is used. If no label is set (= empty string), the footnote is labeled automatically. There are footnote and endnote settings that specify how the automatic labeling is formatted. These settings are obtained from the document model using the interfaces <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XFootnotesSupplier.html" title="see type com.sun.star.text.XFootnotesSupplier">com.sun.star.text.XFootnotesSupplier</a></span> and <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XEndnotesSupplier.html" title="see type com.sun.star.text.XEndnotesSupplier">com.sun.star.text.XEndnotesSupplier</a></span>. The corresponding methods are <span class="Codeintext">getFootnoteSettings()</span> and <span class="Codeintext">getEndnoteSettings()</span>. The object received is a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/beans/XPropertySet.html" title="see type com.sun.star.beans.XPropertySet">com.sun.star.beans.XPropertySet</a></span> and has the properties described in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/FootnoteSettings.html" title="see type com.sun.star.text.FootnoteSettings">com.sun.star.text.FootnoteSettings</a></span>:</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table3"><colgroup><col width="193" /><col width="512" /></colgroup><tr><td colspan="2" style="text-align:left;width:4.225cm; " class="Table3A1">
     <p class="TableHead">Properties of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/FootnoteSettings.html" title="see type com.sun.star.text.FootnoteSettings">com.sun.star.text.FootnoteSettings</a></span></p>
    </td></tr><tr><td style="text-align:left;width:4.225cm; " class="Table3A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/FootnoteSettings.html#AnchorCharStyleName" title="see AnchorCharStyleName of type com.sun.star.text.FootnoteSettings">AnchorCharStyleName</a></span></p>
    </td><td style="text-align:left;width:11.215cm; " class="Table3B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">— </span>Contains the name of the character style that is used for the label in the document text.</p>
    </td></tr><tr><td style="text-align:left;width:4.225cm; " class="Table3A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/FootnoteSettings.html#CharStyleName" title="see CharStyleName of type com.sun.star.text.FootnoteSettings">CharStyleName</a></span></p>
    </td><td style="text-align:left;width:11.215cm; " class="Table3B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">— </span>Contains the name of the character style that is used for the label in front of the footnote/endnote text. </p>
    </td></tr><tr><td style="text-align:left;width:4.225cm; " class="Table3A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/FootnoteSettings.html#NumberingType" title="see NumberingType of type com.sun.star.text.FootnoteSettings">NumberingType</a></span></p>
    </td><td style="text-align:left;width:11.215cm; " class="Table3B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">— </span>Contains the numbering type for the numbering of the footnotes or endnotes. </p>
    </td></tr><tr><td style="text-align:left;width:4.225cm; " class="Table3A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/FootnoteSettings.html#PageStyleName" title="see PageStyleName of type com.sun.star.text.FootnoteSettings">PageStyleName</a></span></p>
    </td><td style="text-align:left;width:11.215cm; " class="Table3B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">— </span>Contains the page style that is used for the page that contains the footnote or endnote texts.</p>
    </td></tr><tr><td style="text-align:left;width:4.225cm; " class="Table3A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/FootnoteSettings.html#ParaStyleName" title="see ParaStyleName of type com.sun.star.text.FootnoteSettings">ParaStyleName</a></span></p>
    </td><td style="text-align:left;width:11.215cm; " class="Table3B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">—</span>Contains the paragraph style that is used for the footnote or endnote text. </p>
    </td></tr><tr><td style="text-align:left;width:4.225cm; " class="Table3A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/FootnoteSettings.html#Prefix" title="see Prefix of type com.sun.star.text.FootnoteSettings">Prefix</a></span></p>
    </td><td style="text-align:left;width:11.215cm; " class="Table3B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">—</span>Contains the prefix for the footnote or endnote symbol. </p>
    </td></tr><tr><td style="text-align:left;width:4.225cm; " class="Table3A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/FootnoteSettings.html#StartAt" title="see StartAt of type com.sun.star.text.FootnoteSettings">StartAt</a></span></p>
    </td><td style="text-align:left;width:11.215cm; " class="Table3B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">— </span>Contains the first number of the automatic numbering of footnotes or endnotes. </p>
    </td></tr><tr><td style="text-align:left;width:4.225cm; " class="Table3A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/FootnoteSettings.html#Suffix" title="see Suffix of type com.sun.star.text.FootnoteSettings">Suffix</a></span></p>
    </td><td style="text-align:left;width:11.215cm; " class="Table3B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">— </span>Contains the suffix for the footnote/endnote symbol. </p>
    </td></tr><tr><td style="text-align:left;width:4.225cm; " class="Table3A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/FootnoteSettings.html#BeginNotice" title="see BeginNotice of type com.sun.star.text.FootnoteSettings">BeginNotice</a></span></p>
    </td><td style="text-align:left;width:11.215cm; " class="Table3B2">
     <p class="TextInTable"><span class="Codeintext">[optional] string</span> <span class="T8">—</span>Contains the string at the restart of the footnote text after a break. </p>
    </td></tr><tr><td style="text-align:left;width:4.225cm; " class="Table3A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/FootnoteSettings.html#EndNotice" title="see EndNotice of type com.sun.star.text.FootnoteSettings">EndNotice</a></span></p>
    </td><td style="text-align:left;width:11.215cm; " class="Table3B2">
     <p class="TextInTable"><span class="Codeintext">[optional] string</span> <span class="T8">— </span>Contains the string at the end of a footnote part in front of a break. </p>
    </td></tr><tr><td style="text-align:left;width:4.225cm; " class="Table3A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/FootnoteSettings.html#FootnoteCounting" title="see FootnoteCounting of type com.sun.star.text.FootnoteSettings">FootnoteCounting</a></span></p>
    </td><td style="text-align:left;width:11.215cm; " class="Table3B2">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">—</span>Contains the type of the counting for the footnote numbers </p>
    </td></tr><tr><td style="text-align:left;width:4.225cm; " class="Table3A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/FootnoteSettings.html#PositionEndOfDoc" title="see PositionEndOfDoc of type com.sun.star.text.FootnoteSettings">PositionEndOfDoc</a></span></p>
    </td><td style="text-align:left;width:11.215cm; " class="Table3B2">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">— </span>If <span class="Codeintext">true</span>, the footnote text is shown at the end of the document.</p>
    </td></tr></table></div>
  <p class="Paragraph">The <span class="Codeintext">Footnotes</span> service applies to footnotes and endnotes.  </p>
  <p class="Paragraph">The following sample works with footnotes (<a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/examples/DevelopersGuide/Text/TextDocuments.java" title="goto source Text/TextDocuments.java">Text/TextDocuments.java</a>) </p>
  <p class="Code">/** This method demonstrates how to create and insert footnotes, and how to access the </p>
  <p class="Code">    XFootnotesSupplier interface of the document</p>
  <p class="Code"> */</p>
  <p class="Code">protected void FootnoteExample () </p>
  <p class="Code">{ </p>
  <p class="Code">        try</p>
  <p class="Code">        {</p>
  <p class="Code">                // Create a new footnote from the document factory and get it's</p>
  <p class="Code">                // XFootnote interface</p>
  <p class="Code">                XFootnote xFootnote = (XFootnote) UnoRuntime.queryInterface( XFootnote.class, </p>
  <p class="Code">                                mxDocFactory.createInstance ( "com.sun.star.text.Footnote" ) );</p>
  <p class="Code"> </p>
  <p class="Code">                // Set the label to 'Numbers'</p>
  <p class="Code">                xFootnote.setLabel ( "Numbers" );</p>
  <p class="Code"> </p>
  <p class="Code">                // Get the footnotes XTextContent interface so we can...</p>
  <p class="Code">                XTextContent xContent = ( XTextContent ) UnoRuntime.queryInterface ( </p>
  <p class="Code">                        XTextContent.class, xFootnote );</p>
  <p class="Code"> </p>
  <p class="Code">                // ...insert it into the document</p>
  <p class="Code">                mxDocText.insertTextContent ( mxDocCursor, xContent, false );</p>
  <p class="Code"> </p>
  <p class="Code">                // Get the XFootnotesSupplier interface of the document</p>
  <p class="Code">                XFootnotesSupplier xFootnoteSupplier = (XFootnotesSupplier) UnoRuntime.queryInterface(</p>
  <p class="Code">                        XFootnotesSupplier.class, mxDoc );</p>
  <p class="Code"> </p>
  <p class="Code">                // Get an XIndexAccess interface to all footnotes</p>
  <p class="Code">                XIndexAccess xFootnotes = ( XIndexAccess ) UnoRuntime.queryInterface (</p>
  <p class="Code">                        XIndexAccess.class, xFootnoteSupplier.getFootnotes() );</p>
  <p class="Code"> </p>
  <p class="Code">                // Get the XFootnote interface to the first footnote inserted ('Numbers')</p>
  <p class="Code">                XFootnote xNumbers = ( XFootnote ) UnoRuntime.queryInterface ( </p>
  <p class="Code">                        XFootnote.class, xFootnotes.getByIndex( 0 ) );</p>
  <p class="Code"> </p>
  <p class="Code">                // Get the XSimpleText interface to the Footnote</p>
  <p class="Code">                XSimpleText xSimple = (XSimpleText ) UnoRuntime.queryInterface (</p>
  <p class="Code">                        XSimpleText.class, xNumbers );</p>
  <p class="Code"> </p>
  <p class="Code">                // Create a text cursor for the foot note text</p>
  <p class="Code">                XTextRange xRange = (XTextRange ) UnoRuntime.queryInterface (</p>
  <p class="Code">                        XTextRange.class, xSimple.createTextCursor() );</p>
  <p class="Code"> </p>
  <p class="Code">                // And insert the actual text of the footnote.</p>
  <p class="Code">                xSimple.insertString ( </p>
  <p class="Code">                        xRange, "  The numbers were generated by using java.util.Random", false );</p>
  <p class="Code">        }</p>
  <p class="Code">        catch (Exception e) </p>
  <p class="Code">        {</p>
  <p class="Code">                e.printStackTrace ( System.out );</p>
  <p class="Code">        }</p>
  <p class="Code">} </p>
  <h3 class="Head3"><a name="1_3_10_Shape_Objects_in_Text" />8.3.10  Shape Objects in Text</h3>
  <h4 class="Head4"><a name="1_3_10_1_Base_Frames_vs._Drawing_Shapes" />Base Frames vs. Drawing Shapes</h4>
  <p class="Paragraph">Shape objects are text contents that act independently of the ordinary text flow. The surrounding text may wrap around them. Shape objects can lie in front or behind text, and be anchored to paragraphs or characters in the text. Anchoring allows the shape objects to follow the paragraphs and characters while the user is writing. Currently, there are two different kinds of shape objects in OpenOffice.org, base frames and drawing shapes. </p>
  <h5 class="Head5"><a name="1_3_10_1_1_Base_Frames" />Base Frames</h5>
  <p class="Paragraph">The first group are shape objects that are <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrame.html" title="see type com.sun.star.text.BaseFrame">com.sun.star.text.BaseFrame</a>s</span>. The three services <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextFrame.html" title="see type com.sun.star.text.TextFrame">com.sun.star.text.TextFrame</a></span>, <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextGraphicObject.html" title="see type com.sun.star.text.TextGraphicObject">com.sun.star.text.TextGraphicObject</a></span> and <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextEmbeddedObject.html" title="see type com.sun.star.text.TextEmbeddedObject">com.sun.star.text.TextEmbeddedObject</a></span> are all based on the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrame.html" title="see type com.sun.star.text.BaseFrame">com.sun.star.text.BaseFrame</a></span>. The <span class="Codeintext">TextFrames</span> contain an independent text area that can be positioned freely over ordinary text. The <span class="Codeintext">TextGraphicObjects</span> are bitmaps or vector oriented images in a format supported by OpenOffice.org internally. The <span class="Codeintext">TextEmbeddedObjects</span> are areas containing a document type other than the document they are embedded in, such as charts, formulas, internal OpenOffice.org documents (Calc/Draw/Impress), or OLE objects.</p>
  <p class="Paragraph">The <span class="Codeintext">TextFrames</span>, <span class="Codeintext">TextGraphicObjects</span> and <span class="Codeintext">TextEmbeddedObjects</span> in a text are supplied by their corresponding supplier interfaces at the document model: <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextFramesSupplier.html" title="see type com.sun.star.text.XTextFramesSupplier">com.sun.star.text.XTextFramesSupplier</a></span> <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextGraphicObjectsSupplier.html" title="see type com.sun.star.text.XTextGraphicObjectsSupplier">com.sun.star.text.XTextGraphicObjectsSupplier</a></span> <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextEmbeddedObjectsSupplier.html" title="see type com.sun.star.text.XTextEmbeddedObjectsSupplier">com.sun.star.text.XTextEmbeddedObjectsSupplier</a></span>. These interfaces all have one single get method that supplies the respective <span class="Codeintext">Shape</span> objects collection:</p>
  <p class="MethodSignatures">com::sun::star::container::XNameAccess <span class="T2">getTextFrames</span>()</p>
  <p class="MethodSignatures">com::sun::star::container::XNameAccess <span class="T2">getTextEmbeddedObjects</span>()</p>
  <p class="MethodSignatures">com::sun::star::container::XNameAccess <span class="T2">getTextGraphicObjects</span>()</p>
  <p class="Paragraph">The method <span class="Codeintext">getTextFrames()</span>returns a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextFrames.html" title="see type com.sun.star.text.TextFrames">com.sun.star.text.TextFrames</a></span> collection, <span class="Codeintext">getTextEmbeddedObjects()</span> returns a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextEmbeddedObjects.html" title="see type com.sun.star.text.TextEmbeddedObjects">com.sun.star.text.TextEmbeddedObjects</a></span> collection and <span class="Codeintext">getTextGraphicObjects()</span> yields a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextGraphicObjects.html" title="see type com.sun.star.text.TextGraphicObjects">com.sun.star.text.TextGraphicObjects</a></span> collection. All of these collections support <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XIndexAccess.html" title="see type com.sun.star.container.XIndexAccess">com.sun.star.container.XIndexAccess</a></span> and <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XNameAccess.html" title="see type com.sun.star.container.XNameAccess">com.sun.star.container.XNameAccess</a></span>. The <span class="Codeintext">TextFrames</span> collection may (optional) support the <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XContainer.html" title="see type com.sun.star.container.XContainer">com.sun.star.container.XContainer</a></span> interface to broadcast an event when an Element is added to the collection. However, the current implementation of the <span class="Codeintext">TextFrames</span> collection does not support this.</p>
  <p class="Paragraph">The service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrame.html" title="see type com.sun.star.text.BaseFrame">com.sun.star.text.BaseFrame</a></span> defines the common properties and interfaces of text frames, graphic objects and embedded objects. It includes the services <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html" title="see type com.sun.star.text.BaseFrameProperties">com.sun.star.text.BaseFrameProperties</a></span> and <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextContent.html" title="see type com.sun.star.text.TextContent">com.sun.star.text.TextContent</a></span>, and defines the following interfaces.</p>
  <p class="Paragraph">The position and size of a <span class="Codeintext">BaseFrame</span> is covered by <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/drawing/XShape.html" title="see type com.sun.star.drawing.XShape">com.sun.star.drawing.XShape</a></span>. All <span class="Codeintext">BaseFrame</span> objects share a majority of the core implementation of drawing objects. Therefore, they have a position and size on the <span class="Codeintext">DrawPage</span>.</p>
  <p class="Paragraph">The name of a <span class="Codeintext">BaseFrame</span> is set and read through <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XNamed.html" title="see type com.sun.star.container.XNamed">com.sun.star.container.XNamed</a></span>. The names of the frame objects have to be unique for text frames, graphic objects and embedded objects, respectively.</p>
  <p class="Paragraph">The  <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/beans/XPropertySet.html" title="see type com.sun.star.beans.XPropertySet">com.sun.star.beans.XPropertySet</a></span> has to be present, because any aspects of <span class="Codeintext">BaseFrames</span> are controlled through properties.</p>
  <p class="Paragraph">The interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/document/XEventsSupplier.html" title="see type com.sun.star.document.XEventsSupplier">com.sun.star.document.XEventsSupplier</a></span> is not a part of the <span class="Codeintext">BaseFrame</span> service, but is available in text frames, graphic objects and embedded objects. This interface provides access to the event macros that may be attached to the object in the GUI.</p>
  <p class="P9">The properties of <span class="Codeintext">BaseFrames</span> are those of the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextContent.html" title="see type com.sun.star.text.TextContent">com.sun.star.text.TextContent</a></span>, as well there is a number of frame properties defined in the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html" title="see type com.sun.star.text.BaseFrameProperties">com.sun.star.text.BaseFrameProperties</a></span>:</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table25"><colgroup><col width="211" /><col width="494" /></colgroup><tr><td colspan="2" style="text-align:left;width:4.613cm; " class="Table25A1">
      <p class="TableHead">Properties of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html" title="see type com.sun.star.text.BaseFrameProperties">com.sun.star.text.BaseFrameProperties</a></span></p>
     </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#AnchorPageNo" title="see AnchorPageNo of type com.sun.star.text.BaseFrameProperties">AnchorPageNo</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">— </span>Contains the number of the page where the objects are anchored. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#AnchorFrame" title="see AnchorFrame of type com.sun.star.text.BaseFrameProperties">AnchorFrame</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextFrame.html" title="see type com.sun.star.text.XTextFrame">com.sun.star.text.XTextFrame</a></span>. Contains the text frame the current frame is anchored to. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#BackColor" title="see BackColor of type com.sun.star.text.BaseFrameProperties">BackColor</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">— </span>Contains the color of the background of the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#BackGraphicURL" title="see BackGraphicURL of type com.sun.star.text.BaseFrameProperties">BackGraphicURL</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">— </span>Contains the URL for the background graphic. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#BackGraphicFilter" title="see BackGraphicFilter of type com.sun.star.text.BaseFrameProperties">BackGraphicFilter</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">— C</span>ontains the name of the file filter for the background graphic. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#BackGraphicLocation" title="see BackGraphicLocation of type com.sun.star.text.BaseFrameProperties">BackGraphicLocation</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable">Determines the position of the background graphic according to <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/GraphicLocation.html" title="see type com.sun.star.style.GraphicLocation">com.sun.star.style.GraphicLocation</a></span>. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#LeftBorder" title="see LeftBorder of type com.sun.star.text.BaseFrameProperties">LeftBorder</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable">struct <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/table/BorderLine.html" title="see type com.sun.star.table.BorderLine">com.sun.star.table.BorderLine</a></span>. Contains the left border of the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#RightBorder" title="see RightBorder of type com.sun.star.text.BaseFrameProperties">RightBorder</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable">struct <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/table/BorderLine.html" title="see type com.sun.star.table.BorderLine">com.sun.star.table.BorderLine</a></span>. Contains the right border of the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#TopBorder" title="see TopBorder of type com.sun.star.text.BaseFrameProperties">TopBorder</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable">struct <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/table/BorderLine.html" title="see type com.sun.star.table.BorderLine">com.sun.star.table.BorderLine</a></span>. Contains the top border of the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#BottomBorder" title="see BottomBorder of type com.sun.star.text.BaseFrameProperties">BottomBorder</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable">struct <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/table/BorderLine.html" title="see type com.sun.star.table.BorderLine">com.sun.star.table.BorderLine</a></span>. Contains the bottom border of the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#BorderDistance" title="see BorderDistance of type com.sun.star.text.BaseFrameProperties">BorderDistance</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">— </span>Contains the distance from the border to the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#LeftBorderDistance" title="see LeftBorderDistance of type com.sun.star.text.BaseFrameProperties">LeftBorderDistance</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">— </span>Contains the distance from the left border to the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#RightBorderDistance" title="see RightBorderDistance of type com.sun.star.text.BaseFrameProperties">RightBorderDistance</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">— </span>Contains the distance from the right border to the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#TopBorderDistance" title="see TopBorderDistance of type com.sun.star.text.BaseFrameProperties">TopBorderDistance</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">— </span>Contains the distance from the top border to the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#BottomBorderDistance" title="see BottomBorderDistance of type com.sun.star.text.BaseFrameProperties">BottomBorderDistance</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">— </span>Contains the distance from the bottom border to the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#BackTransparent" title="see BackTransparent of type com.sun.star.text.BaseFrameProperties">BackTransparent</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">— </span>If <span class="Codeintext">true</span>, the property <span class="Codeintext">BackColor</span> is ignored. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#ContentProtected" title="see ContentProtected of type com.sun.star.text.BaseFrameProperties">ContentProtected</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">— </span>Determines if the content is protected. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#LeftMargin" title="see LeftMargin of type com.sun.star.text.BaseFrameProperties">LeftMargin</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">— </span>Contains the left margin of the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#RightMargin" title="see RightMargin of type com.sun.star.text.BaseFrameProperties">RightMargin</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">— </span>Contains the right margin of the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#TopMargin" title="see TopMargin of type com.sun.star.text.BaseFrameProperties">TopMargin</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">— </span>Contains the top margin of the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#BottomMargin" title="see BottomMargin of type com.sun.star.text.BaseFrameProperties">BottomMargin</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">— </span>Contains the bottom margin of the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#Height" title="see Height of type com.sun.star.text.BaseFrameProperties">Height</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">— </span>Contains the height of the object (1/100 mm). </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#Width" title="see Width of type com.sun.star.text.BaseFrameProperties">Width</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">— </span>Contains the width of the object (1/100 mm). </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#RelativeHeight" title="see RelativeHeight of type com.sun.star.text.BaseFrameProperties">RelativeHeight</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">short</span>  <span class="T8">— </span>Contains the relative height of the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#RelativeWidth" title="see RelativeWidth of type com.sun.star.text.BaseFrameProperties">RelativeWidth</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">— </span>Contains the relative width of the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#IsSyncWidthToHeight" title="see IsSyncWidthToHeight of type com.sun.star.text.BaseFrameProperties">IsSyncWidthToHeight</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">— </span>Determines if the width follows the height. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#IsSyncHeightToWidth" title="see IsSyncHeightToWidth of type com.sun.star.text.BaseFrameProperties">IsSyncHeightToWidth</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">— </span>Determines if the height follows the width. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#HoriOrient" title="see HoriOrient of type com.sun.star.text.BaseFrameProperties">HoriOrient</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">— </span>Determines the horizontal orientation of the object according to <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/HoriOrientation.html" title="see type com.sun.star.text.HoriOrientation">com.sun.star.text.HoriOrientation</a></span>.</p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#HoriOrientPosition" title="see HoriOrientPosition of type com.sun.star.text.BaseFrameProperties">HoriOrientPosition</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">— </span>Contains the horizontal position of the object (1/100 mm).</p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#HoriOrientRelation" title="see HoriOrientRelation of type com.sun.star.text.BaseFrameProperties">HoriOrientRelation</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">— </span>Determines the environment of the object the orientation is related according to <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/RelOrientation.html" title="see type com.sun.star.text.RelOrientation">com.sun.star.text.RelOrientation</a></span>.</p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#VertOrient" title="see VertOrient of type com.sun.star.text.BaseFrameProperties">VertOrient</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">— </span>Determines the vertical orientation of the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#VertOrientPosition" title="see VertOrientPosition of type com.sun.star.text.BaseFrameProperties">VertOrientPosition</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">— </span>Contains the vertical position of the object (1/100 mm). Valid only if TextEmbeddedObject::VertOrient is VertOrientation::NONE . </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#VertOrientRelation" title="see VertOrientRelation of type com.sun.star.text.BaseFrameProperties">VertOrientRelation</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">— D</span>etermines the environment of the object the orientation is related according to <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/RelOrientation.html" title="see type com.sun.star.text.RelOrientation">com.sun.star.text.RelOrientation</a></span>.</p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#HyperLinkURL" title="see HyperLinkURL of type com.sun.star.text.BaseFrameProperties">HyperLinkURL</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">— </span>Contains the URL of a hyperlink that is set at the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#HyperLinkTarget" title="see HyperLinkTarget of type com.sun.star.text.BaseFrameProperties">HyperLinkTarget</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">— </span>Contains the name of the target for a hyperlink that is set at the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#HyperLinkName" title="see HyperLinkName of type com.sun.star.text.BaseFrameProperties">HyperLinkName</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">— </span>Contains the name of the hyperlink that is set at the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#Opaque" title="see Opaque of type com.sun.star.text.BaseFrameProperties">Opaque</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">— </span>Determines if the object is opaque or transparent for text. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#PageToggle" title="see PageToggle of type com.sun.star.text.BaseFrameProperties">PageToggle</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">— </span>Determines if the object is mirrored on even pages. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#PositionProtected" title="see PositionProtected of type com.sun.star.text.BaseFrameProperties">PositionProtected</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">— </span>Determines if the position is protected. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#Print" title="see Print of type com.sun.star.text.BaseFrameProperties">Print</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">— </span>Determines if the object is included in printing. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#ShadowFormat" title="see ShadowFormat of type com.sun.star.text.BaseFrameProperties">ShadowFormat</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">struct</span> <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/table/ShadowFormat.html" title="see type com.sun.star.table.ShadowFormat">com.sun.star.table.ShadowFormat</a></span>. Contains the type of the shadow of the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#ServerMap" title="see ServerMap of type com.sun.star.text.BaseFrameProperties">ServerMap</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">— </span>Determines if the object gets an image map from a server. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#Size" title="see Size of type com.sun.star.text.BaseFrameProperties">Size</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">struct</span> <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/awt/Size.html" title="see type com.sun.star.awt.Size">com.sun.star.awt.Size</a></span>. Contains the size of the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#SizeProtected" title="see SizeProtected of type com.sun.star.text.BaseFrameProperties">SizeProtected</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">— </span>Determines if the size is protected. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#Surround" title="see Surround of type com.sun.star.text.BaseFrameProperties">Surround</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">[deprecated]</span>. Determines the type of the surrounding text. </p>
    </td></tr><tr><td style="text-align:left;width:4.613cm; " class="Table25A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html#SurroundAnchorOnly" title="see SurroundAnchorOnly of type com.sun.star.text.BaseFrameProperties">SurroundAnchorOnly</a></span></p>
    </td><td style="text-align:left;width:10.827cm; " class="Table25B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">— </span>Determines if the text of the paragraph where the object is anchored, wraps around the object. </p>
    </td></tr></table></div>
  <h5 class="Head5"><a name="1_3_10_1_2_Drawing_Shapes" />Drawing Shapes</h5>
  <p class="Paragraph">The second group of shape objects are the varied drawing shapes that can be inserted into text, such as rectangles and ellipses. They are based on <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Shape.html" title="see type com.sun.star.text.Shape">com.sun.star.text.Shape</a></span>. The service <span class="Codeintext">text.Shape</span> includes <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/drawing/Shape.html" title="see type com.sun.star.drawing.Shape">com.sun.star.drawing.Shape</a></span>, but adds a number of properties related to shapes in text (cf. <span class="ChapterRef"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/Text/Text.xhtml#1_3_10_4_Drawing_Shapes" title="see chapter 8.3.10 Text Documents - Working with Text Documents - Shape Objects in Text - Drawing Shapes">8.3.10 Text Documents - Working with Text Documents - Shape Objects in Text - Drawing Shapes</a></span> below). In addition, drawing shapes support the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextContent.html" title="see type com.sun.star.text.XTextContent">com.sun.star.text.XTextContent</a></span> so that they can be inserted into an <span class="Codeintext">XText</span>.</p>
  <p class="Paragraph">There are no specialized supplier interfaces for drawing shapes. All the drawing shapes on the <span class="Codeintext">DrawPage</span> object are supplied by the document model's <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/drawing/XDrawPageSupplier.html" title="see type com.sun.star.drawing.XDrawPageSupplier">com.sun.star.drawing.XDrawPageSupplier</a></span> and its single method:</p>
  <p class="MethodSignatures">com::sun::star::drawing::XDrawPage <span class="T2">getDrawPage</span>()</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table24"><colgroup><col width="112" /><col width="709" /></colgroup><tr><td style="text-align:left;width:2.45cm; " class="Table24A1">
      <div class="TableContents"><img width="39" height="39" alt="Tip graphics marks a hint section in the text" src="./8 Text Documents_files/tip.gif" class="fr5" /></div>
     </td><td style="text-align:left;width:15.529cm; " class="Table24B1">
      <p class="TipInTable">The <span class="Codeintext">DrawPage</span> not only contains drawing shapes, but the <span class="Codeintext">BaseFrame</span> shape objects too, if the document contains any.</p>
     </td></tr></table></div>
  <h4 class="Head4"><a name="1_3_10_2_Text_Frames" />Text Frames</h4>
  <p class="Paragraph">A text frame is a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextFrame.html" title="see type com.sun.star.text.TextFrame">com.sun.star.text.TextFrame</a></span> service consisting of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrame.html" title="see type com.sun.star.text.BaseFrame">com.sun.star.text.BaseFrame</a></span> and the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextFrame.html" title="see type com.sun.star.text.XTextFrame">com.sun.star.text.XTextFrame</a></span>.The <span class="Codeintext">XTextFrame</span> is based on <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextContent.html" title="see type com.sun.star.text.XTextContent">com.sun.star.text.XTextContent</a></span> and introduces one method to provide the <span class="Codeintext">XText</span> of the frame:</p>
  <p class="MethodSignatures">com::sun::star::text::XText <span class="T2">getText</span>()</p>
  <p class="Paragraph">The properties of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextFrame.html" title="see type com.sun.star.text.TextFrame">com.sun.star.text.TextFrame</a></span> that add to the <span class="Codeintext">BaseFrame</span> are the following:</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table26"><colgroup><col width="218" /><col width="487" /></colgroup><tr><td colspan="2" style="text-align:left;width:4.77cm; " class="Table26A1">
      <p class="TableHead">Properties of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextFrame.html" title="see type com.sun.star.text.TextFrame">com.sun.star.text.TextFrame</a></span></p>
     </td></tr><tr><td style="text-align:left;width:4.77cm; " class="Table26A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextFrame.html#FrameHeightAbsolute" title="see FrameHeightAbsolute of type com.sun.star.text.TextFrame">FrameHeightAbsolute</a></span></p>
    </td><td style="text-align:left;width:10.672cm; " class="Table26B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">—</span> Contains the metric height value of the frame. </p>
    </td></tr><tr><td style="text-align:left;width:4.77cm; " class="Table26A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextFrame.html#FrameWidthAbsolute" title="see FrameWidthAbsolute of type com.sun.star.text.TextFrame">FrameWidthAbsolute</a></span></p>
    </td><td style="text-align:left;width:10.672cm; " class="Table26B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">—</span> Contains the metric width value of the frame. </p>
    </td></tr><tr><td style="text-align:left;width:4.77cm; " class="Table26A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextFrame.html#FrameWidthPercent" title="see FrameWidthPercent of type com.sun.star.text.TextFrame">FrameWidthPercent</a></span></p>
    </td><td style="text-align:left;width:10.672cm; " class="Table26B2">
     <p class="TextInTable"><span class="Codeintext">byte</span> <span class="T8">—</span> Specifies a width relative to the width of the surrounding text. </p>
    </td></tr><tr><td style="text-align:left;width:4.77cm; " class="Table26A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextFrame.html#FrameHeightPercent" title="see FrameHeightPercent of type com.sun.star.text.TextFrame">FrameHeightPercent</a></span></p>
    </td><td style="text-align:left;width:10.672cm; " class="Table26B2">
     <p class="TextInTable"><span class="Codeintext">byte</span> <span class="T8">—</span> Specifies a width relative to the width of the surrounding text. </p>
    </td></tr><tr><td style="text-align:left;width:4.77cm; " class="Table26A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextFrame.html#FrameIsAutomaticHeight" title="see FrameIsAutomaticHeight of type com.sun.star.text.TextFrame">FrameIsAutomaticHeight</a></span></p>
    </td><td style="text-align:left;width:10.672cm; " class="Table26B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If "AutomaticHeight" is set, the object grows if it is required by the frame content. </p>
    </td></tr><tr><td style="text-align:left;width:4.77cm; " class="Table26A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextFrame.html#SizeType" title="see SizeType of type com.sun.star.text.TextFrame">SizeType</a></span></p>
    </td><td style="text-align:left;width:10.672cm; " class="Table26B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">—</span> Determines the interpretation of the height and relative height properties.</p>
    </td></tr></table></div>
  <p class="Paragraph">Additionally, text frames are <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Text.html" title="see type com.sun.star.text.Text">com.sun.star.text.Text</a></span> services and support all of its interfaces, except for <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextRangeMover.html" title="see type com.sun.star.text.XTextRangeMover">com.sun.star.text.XTextRangeMover</a></span>.</p>
  <p class="Paragraph">Text frames can be connected to a chain, that is, the text of the first text frame flows into the next chain element if it does not fit. The properties <span class="Codeintext">ChainPrevName</span> and <span class="Codeintext">ChainNextName</span> are provided to take advantage of this feature. They contain the names of the predecessor and successor of a frame. All frames have to be empty to chain frames, except for the first member of the chain. </p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table27"><colgroup><col width="293" /><col width="412" /></colgroup><tr><td colspan="2" style="text-align:left;width:6.426cm; " class="Table27A1">
      <p class="TableHead">Chained Text Frame Property </p>
     </td></tr><tr><td style="text-align:left;width:6.426cm; " class="Table27A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ChainedTextFrame.html#ChainPrevName" title="see ChainPrevName of type com.sun.star.text.ChainedTextFrame">ChainPrevName</a></span></p>
    </td><td style="text-align:left;width:9.013cm; " class="Table27B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">—</span> Name of the predecessor of the frame.</p>
    </td></tr><tr><td style="text-align:left;width:6.426cm; " class="Table27A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ChainedTextFrame.html#ChainNextName" title="see ChainNextName of type com.sun.star.text.ChainedTextFrame">ChainNextName</a></span></p>
    </td><td style="text-align:left;width:9.013cm; " class="Table27B2">
     <p class="TextInTable"><span class="Codeintext">string</span>  <span class="T8">—</span> Name of the successor of the frame.</p>
    </td></tr></table></div>
  <p class="Paragraph">The effect at the API is that the visible text content of the chain members is only accessible at the first frame in the chain. The content of the following chain members is not shown when chained before their content is set. </p>
  <p class="Paragraph">The API reference does not know the properties above. Instead, it specifies a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ChainedTextFrame.html" title="see type com.sun.star.text.ChainedTextFrame">com.sun.star.text.ChainedTextFrame</a></span> with an <span class="Codeintext">XChainable</span> interface, but this is not yet supported by text frames.</p>
  <p class="Paragraph">The following example uses text frames: (<a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/examples/DevelopersGuide/Text/TextDocuments.java" title="goto source Text/TextDocuments.java">Text/TextDocuments.java</a>) </p>
  <p class="Code">/** This method shows how to create and manipulate text frames </p>
  <p class="Code"> */</p>
  <p class="Code">protected void TextFrameExample () </p>
  <p class="Code">{ </p>
  <p class="Code">        try </p>
  <p class="Code">        {</p>
  <p class="Code">                // Use the document's factory to create a new text frame and immediately access </p>
  <p class="Code">                // it's XTextFrame interface</p>
  <p class="Code">                XTextFrame xFrame = (XTextFrame) UnoRuntime.queryInterface (</p>
  <p class="Code">                        XTextFrame.class, mxDocFactory.createInstance (</p>
  <p class="Code">                                "com.sun.star.text.TextFrame" ) );</p>
  <p class="Code"> </p>
  <p class="Code">                // Access the XShape interface of the TextFrame</p>
  <p class="Code">                XShape xShape = (XShape) UnoRuntime.queryInterface(XShape.class, xFrame);</p>
  <p class="Code">                // Access the XPropertySet interface of the TextFrame</p>
  <p class="Code">                XPropertySet xFrameProps = (XPropertySet)UnoRuntime.queryInterface(</p>
  <p class="Code">                        XPropertySet.class, xFrame );</p>
  <p class="Code"> </p>
  <p class="Code">                // Set the size of the new Text Frame using the XShape's 'setSize' method</p>
  <p class="Code">                Size aSize = new Size();</p>
  <p class="Code">                aSize.Height = 400;</p>
  <p class="Code">                aSize.Width = 15000;</p>
  <p class="Code">                xShape.setSize(aSize);</p>
  <p class="Code">                // Set the AnchorType to com.sun.star.text.TextContentAnchorType.AS_CHARACTER</p>
  <p class="Code">                xFrameProps.setPropertyValue( "AnchorType", TextContentAnchorType.AS_CHARACTER );</p>
  <p class="Code">                // Go to the end of the text document</p>
  <p class="Code">                mxDocCursor.gotoEnd( false );</p>
  <p class="Code">                // Insert a new paragraph</p>
  <p class="Code">                mxDocText.insertControlCharacter ( </p>
  <p class="Code">                        mxDocCursor, ControlCharacter.PARAGRAPH_BREAK, false );</p>
  <p class="Code">                // Then insert the new frame</p>
  <p class="Code">                mxDocText.insertTextContent(mxDocCursor, xFrame, false);</p>
  <p class="Code"> </p>
  <p class="Code">                // Access the XText interface of the text contained within the frame</p>
  <p class="Code">                XText xFrameText = xFrame.getText();</p>
  <p class="Code">                // Create a TextCursor over the frame's contents</p>
  <p class="Code">                XTextCursor xFrameCursor = xFrameText.createTextCursor();</p>
  <p class="Code">                // Insert some text into the frame</p>
  <p class="Code">                xFrameText.insertString( </p>
  <p class="Code">                        xFrameCursor, "The first line in the newly created text frame.", false );</p>
  <p class="Code">                xFrameText.insertString( </p>
  <p class="Code">                        xFrameCursor, "\nThe second line in the new text frame.", false );</p>
  <p class="Code">                // Insert a paragraph break into the document (not the frame)</p>
  <p class="Code">                mxDocText.insertControlCharacter ( </p>
  <p class="Code">                        mxDocCursor, ControlCharacter.PARAGRAPH_BREAK, false );</p>
  <p class="Code">         } </p>
  <p class="Code">        catch (Exception e) </p>
  <p class="Code">        {</p>
  <p class="Code">                e.printStackTrace ( System.out );</p>
  <p class="Code">        }</p>
  <p class="Code">} </p>
  <h4 class="Head4"><a name="1_3_10_3_Embedded_Objects" />Embedded Objects</h4>
  <p class="Paragraph">A <span class="Codeintext">TextEmbeddedObject</span> is a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrame.html" title="see type com.sun.star.text.BaseFrame">com.sun.star.text.BaseFrame</a></span> providing the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/document/XEmbeddedObjectSupplier.html" title="see type com.sun.star.document.XEmbeddedObjectSupplier">com.sun.star.document.XEmbeddedObjectSupplier</a></span>. The only method of this interface,</p>
  <p class="MethodSignatures">com::sun::star::lang::XComponent <span class="T2">getEmbeddedObject</span> ()</p>
  <p class="Paragraph">provides access to the model of the embedded document. That way, an embedded OpenOffice.org spreadsheet, drawing, chart or a formula document can be used in a text over its document model. </p>
  <p class="Paragraph">An embedded object is inserted by using the document's factory to create an instance of the the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextEmbeddedObject.html" title="see type com.sun.star.text.TextEmbeddedObject">com.sun.star.text.TextEmbeddedObject</a>.</span> The type of object is determined by setting the string property CLSID to an appropriate value before inserting the object as text content in the document.</p>
  <p class="P26">/<span class="T20">//***************************************************************************</span></p>
  <p class="P27">// comment: Step 1: get the Desktop object from the office </p>
  <p class="P27">//          Step 2: open an empty text document</p>
  <p class="P27">//          Step 3: insert a sample text table</p>
  <p class="P27">//          Step 4: insert a Chart object</p>
  <p class="P27">//          Step 5: insert data from text table into Chart object</p>
  <p class="P27">//*************************************************************************** </p>
  <p class="P27"> </p>
  <p class="P27"> </p>
  <p class="P27">import com.sun.star.uno.UnoRuntime; </p>
  <p class="P27"> </p>
  <p class="P27">public class OleObject { </p>
  <p class="P27">    </p>
  <p class="P27">    public static void main(String args[]) {</p>
  <p class="P27">        // You need the desktop to create a document</p>
  <p class="P27">        // The getDesktop method does the UNO bootstrapping, gets the</p>
  <p class="P27">        // remote servie manager and the desktop object.</p>
  <p class="P27">        com.sun.star.frame.XDesktop xDesktop = null;</p>
  <p class="P27">        xDesktop = getDesktop();</p>
  <p class="P27">        </p>
  <p class="P27">        com.sun.star.text.XTextDocument xTextDocument =</p>
  <p class="P27">            createTextdocument( xDesktop );</p>
  <p class="P27"> </p>
  <p class="P27">        com.sun.star.text.XTextTable xTextTable = </p>
  <p class="P27">            createExampleTable( xTextDocument );</p>
  <p class="P27">        </p>
  <p class="P27">        try {</p>
  <p class="P27">            // create TextEmbeddedObject</p>
  <p class="P27">            com.sun.star.lang.XMultiServiceFactory xDocMSF = (com.sun.star.lang.XMultiServiceFactory)</p>
  <p class="P27">                UnoRuntime.queryInterface(com.sun.star.lang.XMultiServiceFactory.class, xTextDocument);</p>
  <p class="P27">            com.sun.star.text.XTextContent xObj = (com.sun.star.text.XTextContent)</p>
  <p class="P27">                UnoRuntime.queryInterface(com.sun.star.text.XTextContent.class, </p>
  <p class="P27">                    xDocMSF.createInstance( "com.sun.star.text.TextEmbeddedObject" ));</p>
  <p class="P27">            </p>
  <p class="P27">            // set class id for chart object to determine the type </p>
  <p class="P27">            // of object to be inserted</p>
  <p class="P27">            com.sun.star.beans.XPropertySet xPS = (com.sun.star.beans.XPropertySet)</p>
  <p class="P27">                UnoRuntime.queryInterface(com.sun.star.beans.XPropertySet.class, xObj);</p>
  <p class="P27">            xPS.setPropertyValue( "CLSID", "12dcae26-281f-416f-a234-c3086127382e" );</p>
  <p class="P27"> </p>
  <p class="P27">            // insert object in document</p>
  <p class="P27">            com.sun.star.text.XTextCursor xCursor = xTextDocument.getText().createTextCursor();</p>
  <p class="P27">            com.sun.star.text.XTextRange xRange = (com.sun.star.text.XTextRange)</p>
  <p class="P27">                UnoRuntime.queryInterface(com.sun.star.text.XTextRange.class, xCursor);</p>
  <p class="P27">            xTextDocument.getText().insertTextContent( xRange, xObj, false );</p>
  <p class="P27"> </p>
  <p class="P27">            // access objects model</p>
  <p class="P27">            com.sun.star.document.XEmbeddedObjectSupplier xEOS = (com.sun.star.document.XEmbeddedObjectSupplier)</p>
  <p class="P27">                UnoRuntime.queryInterface(com.sun.star.document.XEmbeddedObjectSupplier.class, xObj);</p>
  <p class="P27">            com.sun.star.lang.XComponent xModel = xEOS.getEmbeddedObject();</p>
  <p class="P27"> </p>
  <p class="P27">            // get table data</p>
  <p class="P27">            com.sun.star.chart.XChartDataArray xDocCDA = (com.sun.star.chart.XChartDataArray)</p>
  <p class="P27">                UnoRuntime.queryInterface(com.sun.star.chart.XChartDataArray.class, xTextTable);</p>
  <p class="P27">            double[][] aData = xDocCDA.getData();</p>
  <p class="P27"> </p>
  <p class="P27">            // insert table data in Chart object</p>
  <p class="P27">            com.sun.star.chart.XChartDocument xChartDoc = (com.sun.star.chart.XChartDocument)</p>
  <p class="P27">                UnoRuntime.queryInterface(com.sun.star.chart.XChartDocument.class, xModel);</p>
  <p class="P27">            com.sun.star.chart.XChartDataArray xChartDataArray = (com.sun.star.chart.XChartDataArray)</p>
  <p class="P27">                UnoRuntime.queryInterface(com.sun.star.chart.XChartDataArray.class, xChartDoc.getData());</p>
  <p class="P27">            xChartDataArray.setData( aData );</p>
  <p class="P27"> </p>
  <p class="P27">            // to remove the embedded object just uncomment the next line</p>
  <p class="P27">            //xTextDocument.getText().removeTextContent( xObj );</p>
  <p class="P27">        }</p>
  <p class="P27">        catch( Exception e) {</p>
  <p class="P27">            e.printStackTrace(System.err);</p>
  <p class="P27">        }        </p>
  <p class="P27">        </p>
  <p class="P27">        System.out.println("Done");</p>
  <p class="P27">        </p>
  <p class="P27">        System.exit(0);</p>
  <p class="P27">    }</p>
  <p class="P27">    </p>
  <p class="P27">    protected static com.sun.star.text.XTextTable createExampleTable(</p>
  <p class="P27">        com.sun.star.text.XTextDocument xTextDocument )</p>
  <p class="P27">    {</p>
  <p class="P27">        com.sun.star.lang.XMultiServiceFactory xDocMSF =</p>
  <p class="P27">            (com.sun.star.lang.XMultiServiceFactory) UnoRuntime.queryInterface(</p>
  <p class="P27">                com.sun.star.lang.XMultiServiceFactory.class, xTextDocument);</p>
  <p class="P27"> </p>
  <p class="P27">        com.sun.star.text.XTextTable xTT = null;</p>
  <p class="P27"> </p>
  <p class="P27">        try {</p>
  <p class="P27">            Object oInt = xDocMSF.createInstance("com.sun.star.text.TextTable");</p>
  <p class="P27">            xTT = (com.sun.star.text.XTextTable)</p>
  <p class="P27">                UnoRuntime.queryInterface(com.sun.star.text.XTextTable.class,oInt);</p>
  <p class="P27">        </p>
  <p class="P27">            //initialize the text table with 4 columns an 5 rows</p>
  <p class="P27">            xTT.initialize(4,5);</p>
  <p class="P27">          </p>
  <p class="P27">        } catch (Exception e) {</p>
  <p class="P27">            System.err.println("Couldn't create instance "+ e);</p>
  <p class="P27">            e.printStackTrace(System.err);</p>
  <p class="P27">        }</p>
  <p class="P27"> </p>
  <p class="P27">        com.sun.star.text.XText xText = xTextDocument.getText();</p>
  <p class="P27">        </p>
  <p class="P27">        //create a cursor object</p>
  <p class="P27">        com.sun.star.text.XTextCursor xTCursor = xText.createTextCursor();</p>
  <p class="P27"> </p>
  <p class="P27">        //insert the table</p>
  <p class="P27">        try {</p>
  <p class="P27">            xText.insertTextContent(xTCursor, xTT, false);</p>
  <p class="P27">            </p>
  <p class="P27">        } catch (Exception e) {</p>
  <p class="P27">            System.err.println("Couldn't insert the table " + e);</p>
  <p class="P27">            e.printStackTrace(System.err);</p>
  <p class="P27">        }</p>
  <p class="P27"> </p>
  <p class="P27">        // inserting sample data</p>
  <p class="P27">        (xTT.getCellByName("A2")).setValue(5.0);</p>
  <p class="P27">        (xTT.getCellByName("A3")).setValue(5.5);</p>
  <p class="P27">        (xTT.getCellByName("A4")).setValue(5.7);</p>
  <p class="P27">        (xTT.getCellByName("B2")).setValue(2.3);</p>
  <p class="P27">        (xTT.getCellByName("B3")).setValue(2.2);</p>
  <p class="P27">        (xTT.getCellByName("B4")).setValue(2.4);</p>
  <p class="P27">        (xTT.getCellByName("C2")).setValue(6);</p>
  <p class="P27">        (xTT.getCellByName("C3")).setValue(6);</p>
  <p class="P27">        (xTT.getCellByName("C4")).setValue(6);</p>
  <p class="P27">        (xTT.getCellByName("D2")).setValue(3);</p>
  <p class="P27">        (xTT.getCellByName("D3")).setValue(3.5);</p>
  <p class="P27">        (xTT.getCellByName("D4")).setValue(4);</p>
  <p class="P27">        (xTT.getCellByName("E2")).setValue(8);</p>
  <p class="P27">        (xTT.getCellByName("E3")).setValue(5);</p>
  <p class="P27">        (xTT.getCellByName("E4")).setValue(3);</p>
  <p class="P27"> </p>
  <p class="P27">        return xTT;</p>
  <p class="P27">    }</p>
  <p class="P27">    </p>
  <p class="P27">    public static com.sun.star.frame.XDesktop getDesktop() {</p>
  <p class="P27">        com.sun.star.frame.XDesktop xDesktop = null;</p>
  <p class="P27">        com.sun.star.lang.XMultiComponentFactory xMCF = null;</p>
  <p class="P27">        </p>
  <p class="P27">        try {</p>
  <p class="P27">            com.sun.star.uno.XComponentContext xContext = null;</p>
  <p class="P27">            </p>
  <p class="P27">            // get the remote office component context</p>
  <p class="P27">            xContext = com.sun.star.comp.helper.Bootstrap.bootstrap();</p>
  <p class="P27">            </p>
  <p class="P27">            // get the remote office service manager</p>
  <p class="P27">            xMCF = xContext.getServiceManager();</p>
  <p class="P27">            if( xMCF != null ) {</p>
  <p class="P27">                System.out.println("Connected to a running office ...");</p>
  <p class="P27"> </p>
  <p class="P27">                Object oDesktop = xMCF.createInstanceWithContext(</p>
  <p class="P27">                    "com.sun.star.frame.Desktop", xContext);</p>
  <p class="P27">                xDesktop = (com.sun.star.frame.XDesktop) UnoRuntime.queryInterface(</p>
  <p class="P27">                    com.sun.star.frame.XDesktop.class, oDesktop);</p>
  <p class="P27">            }</p>
  <p class="P27">            else</p>
  <p class="P27">                System.out.println( "Can't create a desktop. No connection, no remote office servicemanager available!" );</p>
  <p class="P27">        }</p>
  <p class="P27">        catch( Exception e) {</p>
  <p class="P27">            e.printStackTrace(System.err);</p>
  <p class="P27">            System.exit(1);</p>
  <p class="P27">        }</p>
  <p class="P27">        </p>
  <p class="P27">        </p>
  <p class="P27">        return xDesktop;</p>
  <p class="P27">    }</p>
  <p class="P27">    </p>
  <p class="P27">    public static com.sun.star.text.XTextDocument createTextdocument(</p>
  <p class="P27">        com.sun.star.frame.XDesktop xDesktop )</p>
  <p class="P27">    {</p>
  <p class="P27">        com.sun.star.text.XTextDocument aTextDocument = null;</p>
  <p class="P27">        </p>
  <p class="P27">        try {</p>
  <p class="P27">            com.sun.star.lang.XComponent xComponent = CreateNewDocument(xDesktop,</p>
  <p class="P27">                                                                        "swriter");</p>
  <p class="P27">            aTextDocument = (com.sun.star.text.XTextDocument)</p>
  <p class="P27">                UnoRuntime.queryInterface(</p>
  <p class="P27">                    com.sun.star.text.XTextDocument.class, xComponent);</p>
  <p class="P27">        }</p>
  <p class="P27">        catch( Exception e) {</p>
  <p class="P27">            e.printStackTrace(System.err);</p>
  <p class="P27">        }</p>
  <p class="P27">        </p>
  <p class="P27">        return aTextDocument;</p>
  <p class="P27">    }</p>
  <p class="P27">    </p>
  <p class="P27">    </p>
  <p class="P27">    protected static com.sun.star.lang.XComponent CreateNewDocument(</p>
  <p class="P27">        com.sun.star.frame.XDesktop xDesktop,</p>
  <p class="P27">        String sDocumentType )</p>
  <p class="P27">    {</p>
  <p class="P27">        String sURL = "private:factory/" + sDocumentType;</p>
  <p class="P27">        </p>
  <p class="P27">        com.sun.star.lang.XComponent xComponent = null;</p>
  <p class="P27">        com.sun.star.frame.XComponentLoader xComponentLoader = null;</p>
  <p class="P27">        com.sun.star.beans.PropertyValue xValues[] =</p>
  <p class="P27">            new com.sun.star.beans.PropertyValue[1];</p>
  <p class="P27">        com.sun.star.beans.PropertyValue xEmptyArgs[] =</p>
  <p class="P27">            new com.sun.star.beans.PropertyValue[0];</p>
  <p class="P27">        </p>
  <p class="P27">        try {</p>
  <p class="P27">            xComponentLoader = (com.sun.star.frame.XComponentLoader)</p>
  <p class="P27">                UnoRuntime.queryInterface(</p>
  <p class="P27">                    com.sun.star.frame.XComponentLoader.class, xDesktop);</p>
  <p class="P27">        </p>
  <p class="P27">            xComponent  = xComponentLoader.loadComponentFromURL(</p>
  <p class="P27">                sURL, "_blank", 0, xEmptyArgs);</p>
  <p class="P27">        }</p>
  <p class="P27">        catch( Exception e) {</p>
  <p class="P27">            e.printStackTrace(System.err);</p>
  <p class="P27">        }</p>
  <p class="P27">        </p>
  <p class="P27">        return xComponent ;</p>
  <p class="P27">    }</p>
  <p class="P27">} </p>
  <h4 class="Head4"><a name="1_3_10_4_Graphic_Objects" />Graphic Objects</h4>
  <p class="Paragraph">A <span class="Codeintext">TextGraphicObject</span> is a <span class="Codeintext">BaseFrame</span> and does not provide any additional interfaces, compared with <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrame.html" title="see type com.sun.star.text.BaseFrame">com.sun.star.text.BaseFrame</a></span>. However, it introduces a number of properties that allow manipulating of a graphic object. They are described in the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextGraphicObject.html" title="see type com.sun.star.text.TextGraphicObject">com.sun.star.text.TextGraphicObject</a></span>:</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table28"><colgroup><col width="234" /><col width="471" /></colgroup><tr><td colspan="2" style="text-align:left;width:5.121cm; " class="Table28A1">
      <p class="TableHead">Properties of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextGraphicObject.html" title="see type com.sun.star.text.TextGraphicObject">com.sun.star.text.TextGraphicObject</a></span></p>
     </td></tr><tr><td style="text-align:left;width:5.121cm; " class="Table28A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextGraphicObject.html#ImageMap" title="see ImageMap of type com.sun.star.text.TextGraphicObject">ImageMap</a></span></p>
    </td><td style="text-align:left;width:10.319cm; " class="Table28B2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XIndexContainer.html" title="see type com.sun.star.container.XIndexContainer">com.sun.star.container.XIndexContainer</a></span>. Returns the client-side image map if one is assigned to the object. </p>
    </td></tr><tr><td style="text-align:left;width:5.121cm; " class="Table28A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextGraphicObject.html#ContentProtected" title="see ContentProtected of type com.sun.star.text.TextGraphicObject">ContentProtected</a></span></p>
    </td><td style="text-align:left;width:10.319cm; " class="Table28B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> Determines if the content is protected against changes from the user interface. </p>
    </td></tr><tr><td style="text-align:left;width:5.121cm; " class="Table28A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextGraphicObject.html#SurroundContour" title="see SurroundContour of type com.sun.star.text.TextGraphicObject">SurroundContour</a></span></p>
    </td><td style="text-align:left;width:10.319cm; " class="Table28B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> Determines if the text wraps around the contour of the object. </p>
    </td></tr><tr><td style="text-align:left;width:5.121cm; " class="Table28A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextGraphicObject.html#ContourOutside" title="see ContourOutside of type com.sun.star.text.TextGraphicObject">ContourOutside</a></span></p>
    </td><td style="text-align:left;width:10.319cm; " class="Table28B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> The text flows only around the contour of the object. </p>
    </td></tr><tr><td style="text-align:left;width:5.121cm; " class="Table28A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextGraphicObject.html#ContourPolyPolygon" title="see ContourPolyPolygon of type com.sun.star.text.TextGraphicObject">ContourPolyPolygon</a></span></p>
    </td><td style="text-align:left;width:10.319cm; " class="Table28B2">
     <p class="TextInTable"><span class="Codeintext">[optional] </span>struct <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/drawing/PointSequenceSequence.html" title="see type com.sun.star.drawing.PointSequenceSequence">com.sun.star.drawing.PointSequenceSequence</a></span>. Contains the contour of the object as PolyPolygon. </p>
    </td></tr><tr><td style="text-align:left;width:5.121cm; " class="Table28A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextGraphicObject.html#GraphicCrop" title="see GraphicCrop of type com.sun.star.text.TextGraphicObject">GraphicCrop</a></span></p>
    </td><td style="text-align:left;width:10.319cm; " class="Table28B2">
     <p class="TextInTable">struct <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/GraphicCrop.html" title="see type com.sun.star.text.GraphicCrop">com.sun.star.text.GraphicCrop</a></span>. Contains the cropping of the object.</p>
    </td></tr><tr><td style="text-align:left;width:5.121cm; " class="Table28A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextGraphicObject.html#HoriMirroredOnEvenPages" title="see HoriMirroredOnEvenPages of type com.sun.star.text.TextGraphicObject">HoriMirroredOnEvenPages</a></span></p>
    </td><td style="text-align:left;width:10.319cm; " class="Table28B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> Determines if the object is horizontally mirrored on even pages. </p>
    </td></tr><tr><td style="text-align:left;width:5.121cm; " class="Table28A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextGraphicObject.html#HoriMirroredOnOddPages" title="see HoriMirroredOnOddPages of type com.sun.star.text.TextGraphicObject">HoriMirroredOnOddPages</a></span></p>
    </td><td style="text-align:left;width:10.319cm; " class="Table28B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> Determines if the object is horizontally mirrored on odd pages. </p>
    </td></tr><tr><td style="text-align:left;width:5.121cm; " class="Table28A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextGraphicObject.html#VertMirrored" title="see VertMirrored of type com.sun.star.text.TextGraphicObject">VertMirrored</a></span></p>
    </td><td style="text-align:left;width:10.319cm; " class="Table28B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> Determines if the object is mirrored vertically. </p>
    </td></tr><tr><td style="text-align:left;width:5.121cm; " class="Table28A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextGraphicObject.html#GraphicURL" title="see GraphicURL of type com.sun.star.text.TextGraphicObject">GraphicURL</a></span></p>
    </td><td style="text-align:left;width:10.319cm; " class="Table28B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">—</span> Contains the URL of the background graphic of the object.</p>
    </td></tr><tr><td style="text-align:left;width:5.121cm; " class="Table28A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextGraphicObject.html#GraphicFilter" title="see GraphicFilter of type com.sun.star.text.TextGraphicObject">GraphicFilter</a></span></p>
    </td><td style="text-align:left;width:10.319cm; " class="Table28B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">—</span> Contains the name of the filter of the background graphic of the object. </p>
    </td></tr><tr><td style="text-align:left;width:5.121cm; " class="Table28A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextGraphicObject.html#ActualSize" title="see ActualSize of type com.sun.star.text.TextGraphicObject">ActualSize</a></span></p>
    </td><td style="text-align:left;width:10.319cm; " class="Table28B2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/awt/Size.html" title="see type com.sun.star.awt.Size">com.sun.star.awt.Size</a></span>. Contains the original size of the bitmap in the graphic object. </p>
    </td></tr><tr><td style="text-align:left;width:5.121cm; " class="Table28A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextGraphicObject.html#AdjustLuminance" title="see AdjustLuminance of type com.sun.star.text.TextGraphicObject">AdjustLuminance</a></span></p>
    </td><td style="text-align:left;width:10.319cm; " class="Table28B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">—</span> Changes the display of the luminance. It contains percentage values between -100 and +100. </p>
    </td></tr><tr><td style="text-align:left;width:5.121cm; " class="Table28A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextGraphicObject.html#AdjustContrast" title="see AdjustContrast of type com.sun.star.text.TextGraphicObject">AdjustContrast</a></span></p>
    </td><td style="text-align:left;width:10.319cm; " class="Table28B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">—</span> Changes the display of contrast. It contains percentage values between -100 and +100. </p>
    </td></tr><tr><td style="text-align:left;width:5.121cm; " class="Table28A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextGraphicObject.html#AdjustRed" title="see AdjustRed of type com.sun.star.text.TextGraphicObject">AdjustRed</a></span></p>
    </td><td style="text-align:left;width:10.319cm; " class="Table28B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">—</span> Changes the display of the red color channel. It contains percentage values between -100 and +100. </p>
    </td></tr><tr><td style="text-align:left;width:5.121cm; " class="Table28A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextGraphicObject.html#AdjustGreen" title="see AdjustGreen of type com.sun.star.text.TextGraphicObject">AdjustGreen</a></span></p>
    </td><td style="text-align:left;width:10.319cm; " class="Table28B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">—</span> Changes the display of the green color channel. It contains percentage values between -100 and +100. </p>
    </td></tr><tr><td style="text-align:left;width:5.121cm; " class="Table28A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextGraphicObject.html#AdjustBlue" title="see AdjustBlue of type com.sun.star.text.TextGraphicObject">AdjustBlue</a></span></p>
    </td><td style="text-align:left;width:10.319cm; " class="Table28B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">—</span> Changes the display of the blue color channel. It contains percentage values between -100 and +100. </p>
    </td></tr><tr><td style="text-align:left;width:5.121cm; " class="Table28A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextGraphicObject.html#Gamma" title="see Gamma of type com.sun.star.text.TextGraphicObject">Gamma</a></span></p>
    </td><td style="text-align:left;width:10.319cm; " class="Table28B2">
     <p class="TextInTable"><span class="Codeintext">double</span> <span class="T8">—</span> Determines the gamma value of the graphic. </p>
    </td></tr><tr><td style="text-align:left;width:5.121cm; " class="Table28A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextGraphicObject.html#GraphicIsInverted" title="see GraphicIsInverted of type com.sun.star.text.TextGraphicObject">GraphicIsInverted</a></span></p>
    </td><td style="text-align:left;width:10.319cm; " class="Table28B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> Determines if the graphic is displayed in inverted colors. It contains percentage values between -100 and +100. </p>
    </td></tr><tr><td style="text-align:left;width:5.121cm; " class="Table28A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextGraphicObject.html#Transparency" title="see Transparency of type com.sun.star.text.TextGraphicObject">Transparency</a></span></p>
    </td><td style="text-align:left;width:10.319cm; " class="Table28B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">—</span> Measure of transparency. It contains percentage values between -100 and +100. </p>
    </td></tr><tr><td style="text-align:left;width:5.121cm; " class="Table28A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextGraphicObject.html#GraphicColorMode" title="see GraphicColorMode of type com.sun.star.text.TextGraphicObject">GraphicColorMode</a></span></p>
    </td><td style="text-align:left;width:10.319cm; " class="Table28B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">—</span> Contains the <span class="Codeintext">ColorMode</span> according to <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/drawing/ColorMode.html" title="see type com.sun.star.drawing.ColorMode">com.sun.star.drawing.ColorMode</a></span>.</p>
    </td></tr></table></div>
  <p class="Paragraph"> </p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table29"><colgroup><col width="112" /><col width="709" /></colgroup><tr><td style="text-align:left;width:2.45cm; " class="Table29A1">
      <div class="TableContents"><img width="39" height="39" alt="Pay attention to the following important text section" src="./8 Text Documents_files/important.gif" class="fr5" /></div>
     </td><td style="text-align:left;width:15.529cm; " class="Table29B1">
      <p class="TipInTable"><span class="Codeintext">TextGraphicObject</span> files can currently only be linked when inserted through API which means only their URL is stored with the document. Embedding of graphics is not supported. This applies to background graphics which can be set, for example, to paragraphs, tables or text sections.</p>
     </td></tr></table></div>
  <h4 class="Head4"><a name="1_3_10_5_Drawing_Shapes" />Drawing Shapes</h4>
  <p class="Paragraph">The writer uses the same drawing engine as OpenOffice.org impress and OpenOffice.org draw. The limitations are that in writer only one draw page can exist and 3D objects are not supported. All drawing shapes support these properties: </p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table31"><colgroup><col width="237" /><col width="468" /></colgroup><tr><td colspan="2" style="text-align:left;width:5.196cm; " class="Table31A1">
      <p class="TableHead">Properties of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/drawing/Shape.html" title="see type com.sun.star.drawing.Shape">com.sun.star.drawing.Shape</a></span></p>
     </td></tr><tr><td style="text-align:left;width:5.196cm; " class="Table31A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/drawing/Shape.html#ZOrder" title="see ZOrder of type com.sun.star.drawing.Shape">ZOrder</a></span></p>
    </td><td style="text-align:left;width:10.243cm; " class="Table31B2">
     <p class="TextInTable"><span class="Codeintext">[optional] long</span> <span class="T8">—</span> Is used to query or change the <span class="Codeintext">ZOrder</span> of this Shape .</p>
    </td></tr><tr><td style="text-align:left;width:5.196cm; " class="Table31A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/drawing/Shape.html#LayerID" title="see LayerID of type com.sun.star.drawing.Shape">LayerID</a></span></p>
    </td><td style="text-align:left;width:10.243cm; " class="Table31B2">
     <p class="TextInTable"><span class="Codeintext">[optional] short</span> <span class="T8">—</span> This is the ID of the layer to which this shape is attached. </p>
    </td></tr><tr><td style="text-align:left;width:5.196cm; " class="Table31A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/drawing/Shape.html#LayerName" title="see LayerName of type com.sun.star.drawing.Shape">LayerName</a></span></p>
    </td><td style="text-align:left;width:10.243cm; " class="Table31B2">
     <p class="TextInTable"><span class="Codeintext">[optional] string</span> <span class="T8">—</span> This is the name of the layer to which this Shape is attached. </p>
    </td></tr><tr><td style="text-align:left;width:5.196cm; " class="Table31A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/drawing/Shape.html#Printable" title="see Printable of type com.sun.star.drawing.Shape">Printable</a></span></p>
    </td><td style="text-align:left;width:10.243cm; " class="Table31B2">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">—</span> If this is <span class="Codeintext">false</span>, the shape is not visible on printer outputs. </p>
    </td></tr><tr><td style="text-align:left;width:5.196cm; " class="Table31A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/drawing/Shape.html#MoveProtect" title="see MoveProtect of type com.sun.star.drawing.Shape">MoveProtect</a></span></p>
    </td><td style="text-align:left;width:10.243cm; " class="Table31B2">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">—</span> When set to <span class="Codeintext">true</span>, this shape cannot be moved interactively in the user interface. </p>
    </td></tr><tr><td style="text-align:left;width:5.196cm; " class="Table31A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/drawing/Shape.html#Name" title="see Name of type com.sun.star.drawing.Shape">Name</a></span></p>
    </td><td style="text-align:left;width:10.243cm; " class="Table31B2">
     <p class="TextInTable"><span class="Codeintext">[optional] string</span> <span class="T8">—</span> This is the name of this shape. </p>
    </td></tr><tr><td style="text-align:left;width:5.196cm; " class="Table31A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/drawing/Shape.html#SizeProtect" title="see SizeProtect of type com.sun.star.drawing.Shape">SizeProtect</a></span></p>
    </td><td style="text-align:left;width:10.243cm; " class="Table31B2">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">—</span> When set to <span class="Codeintext">true</span>, this shape may not be sized interactively in the user interface. </p>
    </td></tr><tr><td style="text-align:left;width:5.196cm; " class="Table31A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/drawing/Shape.html#Style" title="see Style of type com.sun.star.drawing.Shape">Style</a></span></p>
    </td><td style="text-align:left;width:10.243cm; " class="Table31B2">
     <p class="TextInTable"><span class="Codeintext">[optional] <a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/XStyle.html" title="see type com.sun.star.style.XStyle">com.sun.star.style.XStyle</a></span>. Determines the style for this shape. </p>
    </td></tr><tr><td style="text-align:left;width:5.196cm; " class="Table31A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/drawing/Shape.html#Transformation" title="see Transformation of type com.sun.star.drawing.Shape">Transformation</a></span></p>
    </td><td style="text-align:left;width:10.243cm; " class="Table31B2">
     <p class="TextInTable"><span class="Codeintext">[optional] <a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/drawing/HomogenMatrix.html" title="see type com.sun.star.drawing.HomogenMatrix">com.sun.star.drawing.HomogenMatrix</a></span> This property lets you get and set the transformation matrix for this shape. The transformation is a 3x3 blended matrix and can contain translation, rotation, shearing and scaling. </p>
    </td></tr><tr><td style="text-align:left;width:5.196cm; " class="Table31A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/drawing/Shape.html#ShapeUserDefinedAttributes" title="see ShapeUserDefinedAttributes of type com.sun.star.drawing.Shape">ShapeUserDefinedAttributes</a></span></p>
    </td><td style="text-align:left;width:10.243cm; " class="Table31B2">
     <p class="TextInTable"><span class="Codeintext">[optional] <a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XNameContainer.html" title="see type com.sun.star.container.XNameContainer">com.sun.star.container.XNameContainer</a></span>. This property stores xml attributes. They are saved to and restored from automatic styles inside xml files. </p>
    </td></tr></table></div>
  <p class="Paragraph">In addition to the properties of the shapes natively supported by the drawing engine, the writer shape adds some properties, so that they are usable for text documents. These are defined in the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Shape.html" title="see type com.sun.star.text.Shape">com.sun.star.text.Shape</a></span>:</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table30"><colgroup><col width="200" /><col width="505" /></colgroup><tr><td colspan="2" style="text-align:left;width:4.376cm; " class="Table30A1">
      <p class="TableHead">Properties of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Shape.html" title="see type com.sun.star.text.Shape">com.sun.star.text.Shape</a></span></p>
     </td></tr><tr><td style="text-align:left;width:4.376cm; " class="Table30A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Shape.html#AnchorPageNo" title="see AnchorPageNo of type com.sun.star.text.Shape">AnchorPageNo</a></span></p>
    </td><td style="text-align:left;width:11.063cm; " class="Table30B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">—</span> Contains the number of the page where the objects are anchored. </p>
    </td></tr><tr><td style="text-align:left;width:4.376cm; " class="Table30A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Shape.html#AnchorFrame" title="see AnchorFrame of type com.sun.star.text.Shape">AnchorFrame</a></span></p>
    </td><td style="text-align:left;width:11.063cm; " class="Table30B2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextFrame.html" title="see type com.sun.star.text.XTextFrame">com.sun.star.text.XTextFrame</a></span>. Contains the text frame the current frame is anchored to. </p>
    </td></tr><tr><td style="text-align:left;width:4.376cm; " class="Table30A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Shape.html#SurroundAnchorOnly" title="see SurroundAnchorOnly of type com.sun.star.text.Shape">SurroundAnchorOnly</a></span></p>
    </td><td style="text-align:left;width:11.063cm; " class="Table30B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> Determines if the text of the paragraph in which the object is anchored, wraps around the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.376cm; " class="Table30A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Shape.html#AnchorType" title="see AnchorType of type com.sun.star.text.Shape">AnchorType</a></span></p>
    </td><td style="text-align:left;width:11.063cm; " class="Table30B2">
     <p class="TextInTable"><span class="Codeintext">[optional] <a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextContentAnchorType.html" title="see type com.sun.star.text.TextContentAnchorType">com.sun.star.text.TextContentAnchorType</a></span>. Specifies how the text content is attached to its surrounding text. </p>
    </td></tr><tr><td style="text-align:left;width:4.376cm; " class="Table30A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Shape.html#HoriOrient" title="see HoriOrient of type com.sun.star.text.Shape">HoriOrient</a></span></p>
    </td><td style="text-align:left;width:11.063cm; " class="Table30B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">—</span> Determines the horizontal orientation of the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.376cm; " class="Table30A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Shape.html#HoriOrientPosition" title="see HoriOrientPosition of type com.sun.star.text.Shape">HoriOrientPosition</a></span></p>
    </td><td style="text-align:left;width:11.063cm; " class="Table30B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">—</span> Contains the horizontal position of the object (1/100 mm). </p>
    </td></tr><tr><td style="text-align:left;width:4.376cm; " class="Table30A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Shape.html#HoriOrientRelation" title="see HoriOrientRelation of type com.sun.star.text.Shape">HoriOrientRelation</a></span></p>
    </td><td style="text-align:left;width:11.063cm; " class="Table30B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">—</span> Determines the environment of the object to which the orientation is related. </p>
    </td></tr><tr><td style="text-align:left;width:4.376cm; " class="Table30A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Shape.html#VertOrient" title="see VertOrient of type com.sun.star.text.Shape">VertOrient</a></span></p>
    </td><td style="text-align:left;width:11.063cm; " class="Table30B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">—</span> Determines the vertical orientation of the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.376cm; " class="Table30A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Shape.html#VertOrientPosition" title="see VertOrientPosition of type com.sun.star.text.Shape">VertOrientPosition</a></span></p>
    </td><td style="text-align:left;width:11.063cm; " class="Table30B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">—</span> Contains the vertical position of the object (1/100 mm). Valid only if TextEmbeddedObject::VertOrient is VertOrientation::NONE. </p>
    </td></tr><tr><td style="text-align:left;width:4.376cm; " class="Table30A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Shape.html#VertOrientRelation" title="see VertOrientRelation of type com.sun.star.text.Shape">VertOrientRelation</a></span></p>
    </td><td style="text-align:left;width:11.063cm; " class="Table30B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">—</span> Determines the environment of the object to which the orientation is related. </p>
    </td></tr><tr><td style="text-align:left;width:4.376cm; " class="Table30A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Shape.html#LeftMargin" title="see LeftMargin of type com.sun.star.text.Shape">LeftMargin</a></span></p>
    </td><td style="text-align:left;width:11.063cm; " class="Table30B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">—</span> Contains the left margin of the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.376cm; " class="Table30A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Shape.html#RightMargin" title="see RightMargin of type com.sun.star.text.Shape">RightMargin</a></span></p>
    </td><td style="text-align:left;width:11.063cm; " class="Table30B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">—</span> Contains the right margin of the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.376cm; " class="Table30A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Shape.html#TopMargin" title="see TopMargin of type com.sun.star.text.Shape">TopMargin</a></span></p>
    </td><td style="text-align:left;width:11.063cm; " class="Table30B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">—</span> Contains the top margin of the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.376cm; " class="Table30A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Shape.html#BottomMargin" title="see BottomMargin of type com.sun.star.text.Shape">BottomMargin</a></span></p>
    </td><td style="text-align:left;width:11.063cm; " class="Table30B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">—</span> Contains the bottom margin of the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.376cm; " class="Table30A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Shape.html#Surround" title="see Surround of type com.sun.star.text.Shape">Surround</a></span></p>
    </td><td style="text-align:left;width:11.063cm; " class="Table30B2">
     <p class="TextInTable">[deprecated]. Determines the type of the surrounding text.  </p>
    </td></tr><tr><td style="text-align:left;width:4.376cm; " class="Table30A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Shape.html#SurroundAnchorOnly" title="see SurroundAnchorOnly of type com.sun.star.text.Shape">SurroundAnchorOnly</a></span></p>
    </td><td style="text-align:left;width:11.063cm; " class="Table30B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> Determines if the text of the paragraph in which the object is anchored, wraps around the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.376cm; " class="Table30A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Shape.html#SurroundContour" title="see SurroundContour of type com.sun.star.text.Shape">SurroundContour</a></span></p>
    </td><td style="text-align:left;width:11.063cm; " class="Table30B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> Determines if the text wraps around the contour of the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.376cm; " class="Table30A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Shape.html#ContourOutside" title="see ContourOutside of type com.sun.star.text.Shape">ContourOutside</a></span></p>
    </td><td style="text-align:left;width:11.063cm; " class="Table30B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> The text flows only around the contour of the object. </p>
    </td></tr><tr><td style="text-align:left;width:4.376cm; " class="Table30A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Shape.html#Opaque" title="see Opaque of type com.sun.star.text.Shape">Opaque</a></span></p>
    </td><td style="text-align:left;width:11.063cm; " class="Table30B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> Determines if the object is opaque or transparent for text. </p>
    </td></tr><tr><td style="text-align:left;width:4.376cm; " class="Table30A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Shape.html#TextRange" title="see TextRange of type com.sun.star.text.Shape">TextRange</a></span></p>
    </td><td style="text-align:left;width:11.063cm; " class="Table30B2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextRange.html" title="see type com.sun.star.text.XTextRange">com.sun.star.text.XTextRange</a></span>. Contains a text range where the shape should be anchored to. </p>
    </td></tr></table></div>
  <p class="Paragraph">The chapter <span class="ChapterRef"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/Drawing/Drawing.xhtml#1_Drawing" title="see chapter 10 Drawing">10 Drawing</a></span> describes how to use shapes and the interface of the draw page.</p>
  <p class="Paragraph">A sample that creates and inserts drawing shapes: (<a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/examples/DevelopersGuide/Text/TextDocuments.java" title="goto source Text/TextDocuments.java">Text/TextDocuments.java</a>) </p>
  <p class="Code">/** This method demonstrates how to create and manipulate shapes, and how to access the draw page </p>
  <p class="Code">    of the document to insert shapes</p>
  <p class="Code"> */</p>
  <p class="Code">protected void DrawPageExample () { </p>
  <p class="Code">    try {</p>
  <p class="Code">        // Go to the end of the document</p>
  <p class="Code">        mxDocCursor.gotoEnd(false);</p>
  <p class="Code">        // Insert two new paragraphs</p>
  <p class="Code">        mxDocText.insertControlCharacter(mxDocCursor,</p>
  <p class="Code">        ControlCharacter.PARAGRAPH_BREAK, false);</p>
  <p class="Code">        mxDocText.insertControlCharacter(mxDocCursor,</p>
  <p class="Code">            ControlCharacter.PARAGRAPH_BREAK, false);</p>
  <p class="Code"> </p>
  <p class="Code">        // Get the XParagraphCursor interface of our document cursor</p>
  <p class="Code">        XParagraphCursor xParaCursor = (XParagraphCursor) </p>
  <p class="Code">            UnoRuntime.queryInterface(XParagraphCursor.class, mxDocCursor);</p>
  <p class="Code"> </p>
  <p class="Code">        // Position the cursor in the 2nd paragraph</p>
  <p class="Code">        xParaCursor.gotoPreviousParagraph(false);</p>
  <p class="Code"> </p>
  <p class="Code">        // Create a RectangleShape using the document factory</p>
  <p class="Code">        XShape xRect = (XShape) UnoRuntime.queryInterface( </p>
  <p class="Code">            XShape.class, mxDocFactory.createInstance(</p>
  <p class="Code">                "com.sun.star.drawing.RectangleShape"));</p>
  <p class="Code"> </p>
  <p class="Code">        // Create an EllipseShape using the document factory</p>
  <p class="Code">        XShape xEllipse = (XShape) UnoRuntime.queryInterface( </p>
  <p class="Code">            XShape.class, mxDocFactory.createInstance( </p>
  <p class="Code">                "com.sun.star.drawing.EllipseShape"));</p>
  <p class="Code"> </p>
  <p class="Code">        // Set the size of both the ellipse and the rectangle</p>
  <p class="Code">        Size aSize = new Size();</p>
  <p class="Code">        aSize.Height = 4000;</p>
  <p class="Code">        aSize.Width = 10000;</p>
  <p class="Code">        xRect.setSize(aSize);</p>
  <p class="Code">        aSize.Height = 3000;</p>
  <p class="Code">        aSize.Width = 6000;</p>
  <p class="Code">        xEllipse.setSize(aSize);</p>
  <p class="Code"> </p>
  <p class="Code">        // Set the position of the Rectangle to the right of the ellipse</p>
  <p class="Code">        Point aPoint = new Point();</p>
  <p class="Code">        aPoint.X = 6100;</p>
  <p class="Code">        aPoint.Y = 0;</p>
  <p class="Code">        xRect.setPosition (aPoint);</p>
  <p class="Code"> </p>
  <p class="Code">        // Get the XPropertySet interfaces of both shapes</p>
  <p class="Code">        XPropertySet xRectProps = (XPropertySet) UnoRuntime.queryInterface( </p>
  <p class="Code">            XPropertySet.class, xRect);</p>
  <p class="Code">        XPropertySet xEllipseProps = (XPropertySet) UnoRuntime.queryInterface(</p>
  <p class="Code">            XPropertySet.class, xEllipse);</p>
  <p class="Code"> </p>
  <p class="Code">        // And set the AnchorTypes of both shapes to 'AT_PARAGRAPH'</p>
  <p class="Code">        xRectProps.setPropertyValue("AnchorType", TextContentAnchorType.AT_PARAGRAPH);</p>
  <p class="Code">        xEllipseProps.setPropertyValue("AnchorType", TextContentAnchorType.AT_PARAGRAPH);</p>
  <p class="Code"> </p>
  <p class="Code">        // Access the XDrawPageSupplier interface of the document</p>
  <p class="Code">        XDrawPageSupplier xDrawPageSupplier = (XDrawPageSupplier) UnoRuntime.queryInterface(</p>
  <p class="Code">             XDrawPageSupplier.class, mxDoc);</p>
  <p class="Code"> </p>
  <p class="Code">        // Get the XShapes interface of the draw page</p>
  <p class="Code">        XShapes xShapes = (XShapes) UnoRuntime.queryInterface( </p>
  <p class="Code">            XShapes.class, xDrawPageSupplier.getDrawPage());</p>
  <p class="Code"> </p>
  <p class="Code">        // Add both shapes</p>
  <p class="Code">        xShapes.add (xEllipse);</p>
  <p class="Code">        xShapes.add (xRect);</p>
  <p class="Code"> </p>
  <p class="Code">        /*</p>
  <p class="Code">        This doesn't work, I am assured that FME and AMA are fixing it.</p>
  <p class="Code"> </p>
  <p class="Code">        XShapes xGrouper = (XShapes) UnoRuntime.queryInterface( </p>
  <p class="Code">            XShapes.class, mxDocFactory.createInstance( </p>
  <p class="Code">                "com.sun.star.drawing.GroupShape"));</p>
  <p class="Code"> </p>
  <p class="Code">        XShape xGrouperShape = (XShape) UnoRuntime.queryInterface(XShape.class, xGrouper);</p>
  <p class="Code">        xShapes.add (xGrouperShape);</p>
  <p class="Code"> </p>
  <p class="Code">        xGrouper.add (xRect);</p>
  <p class="Code">        xGrouper.add (xEllipse);</p>
  <p class="Code"> </p>
  <p class="Code">        XShapeGrouper xShapeGrouper = (XShapeGrouper) UnoRuntime.queryInterface(</p>
  <p class="Code">            XShapeGrouper.class, xShapes);</p>
  <p class="Code">        xShapeGrouper.group (xGrouper);</p>
  <p class="Code">        */</p>
  <p class="Code"> </p>
  <p class="Code">    } catch (Exception e) {</p>
  <p class="Code">        e.printStackTrace(System.out);</p>
  <p class="Code">    }</p>
  <p class="Code">} </p>
  <h3 class="Head3"><a name="1_3_11_Redline" />8.3.11  Redline</h3>
  <p class="Paragraph">Redlines are text portions created in the user interface by switching on <span class="T2">Edit -</span> <span class="T2">Changes - Record</span>.  Redlines in a document are accessed through the <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/document/XRedlinesSupplier.html" title="see type com.sun.star.document.XRedlinesSupplier">com.sun.star.document.XRedlinesSupplier</a></span> interface at the document model. A collection of redlines as <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/beans/XPropertySet.html" title="see type com.sun.star.beans.XPropertySet">com.sun.star.beans.XPropertySet</a></span> objects are received that can be accessed as <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XIndexAccess.html" title="see type com.sun.star.container.XIndexAccess">com.sun.star.container.XIndexAccess</a></span> or as <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XEnumerationAccess.html" title="see type com.sun.star.container.XEnumerationAccess">com.sun.star.container.XEnumerationAccess</a></span>. Their properties are described in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/RedlinePortion.html" title="see type com.sun.star.text.RedlinePortion">com.sun.star.text.RedlinePortion</a></span>.</p>
  <p class="Paragraph">If a change is recorded, but not visible because the option <span class="T2">Edit - Changes - Show</span> has been switched off<span class="T1">, </span> redline text is contained in the property <span class="Codeintext">RedlineText</span>, which is a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XText.html" title="see type com.sun.star.text.XText">com.sun.star.text.XText</a></span>.</p>
  <p class="Paragraph">Calling <span class="Codeintext">XPropertySet.getPropertySetInfo()</span> on a redline property set crashes the office.</p>
  <h3 class="Head3"><a name="1_3_12_Ruby" />8.3.12  Ruby</h3>
  <p class="Paragraph">Ruby text is a character layout attribute used in Asian languages. Ruby text appears above or below text in left to right writing, and left to right of text in top to bottom writing. For examples, cf. <span class="wwwftpemail">www.w3.org/TR/1999/WD-ruby-19990322/</span>. </p>
  <p class="Paragraph">Ruby text is created using the appropriate character properties from the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html" title="see type com.sun.star.style.CharacterProperties">com.sun.star.style.CharacterProperties</a></span> wherever this service is supported. However, theAsian languages support must be switched on in <span class="T2">Tools - Options - LanguageSettings - Languages</span>.</p>
  <p class="Paragraph">There is no convenient supplier interface for ruby text at the model at this time. However, the controller has an interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XRubySelection.html" title="see type com.sun.star.text.XRubySelection">com.sun.star.text.XRubySelection</a></span> that provides access to rubies contained in the current selection. </p>
  <p class="Paragraph">To find ruby text in the model, enumerate all text portions in all paragraphs and check if the property <span class="Codeintext">TextPortionType</span> contains the string <span class="Codeintext">"Ruby"</span> to find ruby text. When there is ruby text, access the <span class="Codeintext">RubyText</span> property of the text portion that contains ruby text as a string.</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table23"><colgroup><col width="322" /><col width="383" /></colgroup><tr><td style="text-align:left;width:7.05cm; " class="Table23A1">
     <p class="TableHead">CharacterProperties for Ruby Text </p>
    </td><td style="text-align:left;width:8.389cm; " class="Table23B1">
     <p class="TableHead">Description </p>
    </td></tr><tr><td style="text-align:left;width:7.05cm; " class="Table23A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#RubyText" title="see RubyText of type com.sun.star.style.CharacterProperties:RubyText">com.sun.star.style.CharacterProperties:RubyText</a></span></p>
    </td><td style="text-align:left;width:8.389cm; " class="Table23B2">
     <p class="TextInTable">Contains the text that is set as ruby. </p>
    </td></tr><tr><td style="text-align:left;width:7.05cm; " class="Table23A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#RubyAdjust" title="see RubyAdjust of type com.sun.star.style.CharacterProperties:RubyAdjust">com.sun.star.style.CharacterProperties:RubyAdjust</a></span></p>
    </td><td style="text-align:left;width:8.389cm; " class="Table23B2">
     <p class="TextInTable">Determines the adjustment of the ruby text as <span class="Codeintext">RubyAdjust</span>.</p>
    </td></tr><tr><td style="text-align:left;width:7.05cm; " class="Table23A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#RubyCharStyleName" title="see RubyCharStyleName of type com.sun.star.style.CharacterProperties:RubyCharStyleName">com.sun.star.style.CharacterProperties:RubyCharStyleName</a></span></p>
    </td><td style="text-align:left;width:8.389cm; " class="Table23B2">
     <p class="TextInTable">Contains the name of the character style that is applied to <span class="Codeintext">RubyText</span>.</p>
    </td></tr><tr><td style="text-align:left;width:7.05cm; " class="Table23A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html#RubyIsAbove" title="see RubyIsAbove of type com.sun.star.style.CharacterProperties:RubyIsAbove">com.sun.star.style.CharacterProperties:RubyIsAbove</a></span></p>
    </td><td style="text-align:left;width:8.389cm; " class="Table23B2">
     <p class="TextInTable">Determines if the ruby text is printed above/left or below/right of the text  </p>
    </td></tr></table></div>
  <p class="Paragraph"> </p>
  <h2 class="Head2"><a name="1_4_Overall_Document_Features" />8.4  Overall Document Features</h2>
  <h3 class="Head3"><a name="1_4_1_Styles" />8.4.1  Styles</h3>
  <p class="Paragraph">Styles distinguish sections in a document that are commonly formatted and separates this information from the actual formatting. This way it is possible to unify the appearance of a document, and adjust the formatting of a document by altering a style, instead of local format settings after the document has been completed. Styles are packages of attributes that can be applied to text or text contents in a single step. </p>
  <p class="Paragraph">The following style families are available in OpenOffice.org. </p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table1"><colgroup><col width="161" /><col width="544" /></colgroup><tr><td style="text-align:left;width:3.526cm; " class="Table1A1">
      <p class="TableHead">Style Families </p>
     </td><td style="text-align:left;width:11.913cm; " class="Table1B1">
      <p class="TableHead">Description </p>
     </td></tr><tr><td style="text-align:left;width:3.526cm; " class="Table1A2">
     <p class="TextInTable">CharacterStyles</p>
    </td><td style="text-align:left;width:11.913cm; " class="Table1B2">
     <p class="TextInTable">Character styles are used to format single characters or entire words and phrases. Character styles can be nested. </p>
    </td></tr><tr><td style="text-align:left;width:3.526cm; " class="Table1A2">
     <p class="TextInTable">ParagraphStyles</p>
    </td><td style="text-align:left;width:11.913cm; " class="Table1B2">
     <p class="TextInTable">Paragraph styles are used to format entire paragraphs. Apart from the normal format settings for paragraphs, the paragraph style also defines the font to be used, and the paragraph style for the following paragraph. </p>
    </td></tr><tr><td style="text-align:left;width:3.526cm; " class="Table1A2">
     <p class="TextInTable">FrameStyles</p>
    </td><td style="text-align:left;width:11.913cm; " class="Table1B2">
     <p class="TextInTable">Frame styles are used to format graphic and text frames. These Styles are used to quickly format graphics and frames automatically. </p>
    </td></tr><tr><td style="text-align:left;width:3.526cm; " class="Table1A2">
     <p class="TextInTable">PageStyles</p>
    </td><td style="text-align:left;width:11.913cm; " class="Table1B2">
     <p class="TextInTable">Page styles are used to structure the page. If a "Next Style" is specified, the OpenOffice.org automatically applies the specified page style when an automatic page break occurs. </p>
    </td></tr><tr><td style="text-align:left;width:3.526cm; " class="Table1A2">
     <p class="TextInTable">NumberingStyles</p>
    </td><td style="text-align:left;width:11.913cm; " class="Table1B2">
     <p class="TextInTable">Numbering styles are used to format paragraphs in numbered or bulleted text. </p>
    </td></tr></table></div>
  <p class="Paragraph">The text document model implements the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/XStyleFamiliesSupplier.html" title="see type com.sun.star.style.XStyleFamiliesSupplier">com.sun.star.style.XStyleFamiliesSupplier</a></span> to access these styles. Its method <span class="Codeintext">getStyleFamilies()</span> returns a collection of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/StyleFamilies.html" title="see type com.sun.star.style.StyleFamilies">com.sun.star.style.StyleFamilies</a></span> with a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XNameAccess.html" title="see type com.sun.star.container.XNameAccess">com.sun.star.container.XNameAccess</a></span> interface. The <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XNameAccess.html" title="see type com.sun.star.container.XNameAccess">com.sun.star.container.XNameAccess</a></span> interface retrieves the style families by the names listed above. The <span class="CODE">StyleFamilies</span> service supports a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XIndexAccess.html" title="see type com.sun.star.container.XIndexAccess">com.sun.star.container.XIndexAccess</a></span>.</p>
  <p class="Paragraph">From the <span class="Codeintext">StyleFamilies,</span> retrieve one of the families listed above by name or index. A collection of styles are received which is a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/StyleFamily.html" title="see type com.sun.star.style.StyleFamily">com.sun.star.style.StyleFamily</a></span> service, providing access to the single styles through an <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XNameContainer.html" title="see type com.sun.star.container.XNameContainer">com.sun.star.container.XNameContainer</a></span> or  an <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XIndexAccess.html" title="see type com.sun.star.container.XIndexAccess">com.sun.star.container.XIndexAccess</a></span>.</p>
  <p class="Paragraph">Each style is a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/Style.html" title="see type com.sun.star.style.Style">com.sun.star.style.Style</a></span> and supports the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/XStyle.html" title="see type com.sun.star.style.XStyle">com.sun.star.style.XStyle</a></span> that inherits from <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XNamed.html" title="see type com.sun.star.container.XNamed">com.sun.star.container.XNamed</a></span>. The  <span class="Codeintext">XStyle</span> contains:</p>
  <p class="MethodSignatures">string <span class="T9">getName</span>()</p>
  <p class="MethodSignatures">void <span class="T9">setName</span>( [in] string aName)</p>
  <p class="MethodSignatures">boolean <span class="T9">isUserDefined</span>()</p>
  <p class="MethodSignatures">boolean <span class="T9">isInUse</span>()</p>
  <p class="MethodSignatures">string <span class="T9">getParentStyle</span>()</p>
  <p class="MethodSignatures">void <span class="T9">setParentStyle</span>( [in] string aParentStyle)</p>
  <p class="Paragraph">The office comes with a set of default styles. These styles use programmatic names on the API level. The method <span class="Codeintext">setName() </span>in <span class="Codeintext">XStyle</span> always throws an exception if called at such styles. The same applies to changing the property <span class="Codeintext">Category</span>. At the user interface localized names are used. The user interface names are provided through the property <span class="Codeintext">UserInterfaceName</span>. </p>
  <p class="Paragraph">Note that page and numbering styles are not hierarchical and cannot have parent styles. The method <span class="Codeintext">getParentStyle()</span> always returns an empty string, and the method <span class="Codeintext">setParentStyle()</span> throws a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/uno/RuntimeException.html" title="see type com.sun.star.uno.RuntimeException">com.sun.star.uno.RuntimeException</a></span> when called at a default style.</p>
  <p class="Paragraph">The method <span class="Codeintext">isUserDefined()</span> determines whether a style is defined by a user or is a built-in style. A built-in style cannot be deleted. Additionally the built-in styles have two different names: a true object name and an alias that is displayed at the user interface. This is not usually visible in an English OpenOffice.org version, except for the default styles that are named "Standard" as programmatic name and "Default" in the user interface. </p>
  <p class="Paragraph">The Style service defines the following properties which are shared by all styles: </p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table50"><colgroup><col width="156" /><col width="549" /></colgroup><tr><td colspan="2" style="text-align:left;width:3.425cm; " class="Table50A1">
      <p class="TableHead">Properties of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/Style.html" title="see type com.sun.star.style.Style">com.sun.star.style.Style</a></span></p>
     </td></tr><tr><td style="text-align:left;width:3.425cm; " class="Table50A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/Style.html#IsPhysical" title="see IsPhysical of type com.sun.star.style.Style">IsPhysical</a></span></p>
    </td><td style="text-align:left;width:12.014cm; " class="Table50B2">
     <p class="TextInTable"><span class="Codeintext">[optional, readonly] boolean</span> <span class="T8">—</span> Determines if a style is physically created.</p>
    </td></tr><tr><td style="text-align:left;width:3.425cm; " class="Table50A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/Style.html#FollowStyle" title="see FollowStyle of type com.sun.star.style.Style">FollowStyle</a></span></p>
    </td><td style="text-align:left;width:12.014cm; " class="Table50B2">
     <p class="TextInTable"><span class="Codeintext">[optional] boolean</span> <span class="T8">—</span> Contains the name of the style that is applied to the next paragraph.</p>
    </td></tr><tr><td style="text-align:left;width:3.425cm; " class="Table50A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/Style.html#DisplayName" title="see DisplayName of type com.sun.star.style.Style">DisplayName</a></span></p>
    </td><td style="text-align:left;width:12.014cm; " class="Table50B2">
     <p class="TextInTable"><span class="Codeintext">[optional, readonly] string</span> <span class="T8">—</span> Contains the name of the style as is displayed in the user interface.</p>
    </td></tr><tr><td style="text-align:left;width:3.425cm; " class="Table50A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/Style.html#IsAutoUpdate" title="see IsAutoUpdate of type com.sun.star.style.Style">IsAutoUpdate</a></span></p>
    </td><td style="text-align:left;width:12.014cm; " class="Table50B2">
     <p class="TextInTable"><span class="Codeintext">[optional] string</span> <span class="T8">—</span> Determines if a style is automatically updated when the properties of an object that the style is applied to are changed.</p>
    </td></tr><tr><td style="text-align:left;width:3.425cm; " class="Table50A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/Style.html#ParaStyleConditions" title="see ParaStyleConditions of type com.sun.star.style.Style">ParaStyleConditions</a></span></p>
    </td><td style="text-align:left;width:12.014cm; " class="Table50B2">
     <p class="TextInTable"><span class="Codeintext">[optional, property] sequence&lt; <a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/beans.html#NamedValue" title="see NamedValue of type com.sun.star.beans">NamedValue</a> &gt;</span> — Defines the context and styles for conditional paragraphs.  This property is only available if the style is a conditional paragraph style.</p>
    </td></tr></table></div>
  <p class="Paragraph">To determine the user interface name, each style has a string property <span class="Codeintext">DisplayName</span> that contains the name that is used at the user interface. It is not allowed to use a <span class="Codeintext">DisplayName</span> of a style as a name of a user-defined style of the same style family.</p>
  <p class="Paragraph">The built-in styles are not created actually as long as they are not used in the document. The property <span class="Codeintext">IsPhysical</span> checks for this. It is necessary, for file export purposes, to detect styles which do not need to be exported. </p>
  <p class="Paragraph">Conditional paragraph styles are handled by the property <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/Style.html#ParaStyleConditions" title="see ParaStyleConditions of type com.sun.star.style.Style">ParaStyleConditions</a></span>. The sequence consists of pairs where the name part (the first part) of the pair defines the context where the style (the second part, a string that denotes a style name or an empty string) should be applied to. Assigning an empty string to the style name will disable the conditional style for that context.</p>
  <p class="Paragraph">The <span class="Codeintext">StyleFamilies</span> collection can load styles. For this purpose, the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/XStyleLoader.html" title="see type com.sun.star.style.XStyleLoader">com.sun.star.style.XStyleLoader</a></span> is available at the <span class="Codeintext">StyleFamilies</span> collection. It consists of two methods:</p>
  <p class="MethodSignatures">void <span class="T2">loadStylesFromURL</span>( [in] string URL,  </p>
  <p class="MethodSignatures">                        [in] sequence&lt; com::sun::star::beans::PropertyValue &gt; aOptions)</p>
  <p class="MethodSignatures">sequence&lt; com::sun::star::beans::PropertyValue &gt; <span class="T2">getStyleLoaderOptions</span>()</p>
  <p class="Paragraph">The method <span class="Codeintext">loadStylesFromURL()</span> enables the document to import styles from other documents. The expected sequence of <span class="Codeintext">PropertyValue</span> structs can contain the following properties:</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table49"><colgroup><col width="295" /><col width="410" /></colgroup><tr><td style="text-align:left;width:6.452cm; " class="Table49A1">
      <p class="TableHead">Properties for loadStylesFromURL() </p>
     </td><td style="text-align:left;width:8.987cm; " class="Table49B1">
      <p class="TableHead">Description </p>
     </td></tr><tr><td style="text-align:left;width:6.452cm; " class="Table49A2">
     <p class="TextInTable"><span class="Codeintext">LoadTextStyles</span></p>
    </td><td style="text-align:left;width:8.987cm; " class="Table49B2">
     <p class="TextInTable">Determines if character and paragraph styles are to be imported. It is not possible to select character styles and paragraph styles separately. </p>
    </td></tr><tr><td style="text-align:left;width:6.452cm; " class="Table49A2">
     <p class="TextInTable"><span class="Codeintext">LoadLoadFrameStyles</span></p>
    </td><td style="text-align:left;width:8.987cm; " class="Table49B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> Import frame styles only.</p>
    </td></tr><tr><td style="text-align:left;width:6.452cm; " class="Table49A2">
     <p class="TextInTable"><span class="Codeintext">LoadPageStyles</span></p>
    </td><td style="text-align:left;width:8.987cm; " class="Table49B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> Import page styles only.</p>
    </td></tr><tr><td style="text-align:left;width:6.452cm; " class="Table49A2">
     <p class="TextInTable"><span class="Codeintext">LoadNumberingStyles</span></p>
    </td><td style="text-align:left;width:8.987cm; " class="Table49B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> Import numbering styles only.</p>
    </td></tr><tr><td style="text-align:left;width:6.452cm; " class="Table49A2">
     <p class="TextInTable"><span class="Codeintext">OverwriteStyles</span></p>
    </td><td style="text-align:left;width:8.987cm; " class="Table49B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> Determines if internal styles are overwritten if the source document contains styles having the same name.</p>
    </td></tr></table></div>
  <p class="Paragraph">The method <span class="Codeintext">getStyleLoaderOptions()</span> returns a sequence of these <span class="Codeintext">PropertyValue</span> structs, set to their default values. </p>
  <h4 class="Head4"><a name="1_4_1_1_Character_Styles" />Character Styles</h4>
  <p class="Paragraph">Character styles support all properties defined in the services <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html" title="see type com.sun.star.style.CharacterProperties">com.sun.star.style.CharacterProperties</a></span> and  <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterPropertiesAsian.html" title="see type com.sun.star.style.CharacterPropertiesAsian">com.sun.star.style.CharacterPropertiesAsian</a></span>. </p>
  <p class="Paragraph">They are created using the <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/lang/XMultiServiceFactory.html" title="see type com.sun.star.lang.XMultiServiceFactory">com.sun.star.lang.XMultiServiceFactory</a></span>  interface of the text document model using the service name <span class="Codeintext">"com.sun.star.style.CharacterStyle"</span>.</p>
  <p class="Paragraph">The default style that is shown in the user interface and accessible through the API is not a style, but a tool to remove applied character styles. Therefore, its properties cannot be changed. </p>
  <p class="Paragraph">Set the property <span class="Codeintext">CharStyleName</span> at an object including the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/CharacterProperties.html" title="see type com.sun.star.style.CharacterProperties">com.sun.star.style.CharacterProperties</a></span> to set its character style.</p>
  <h4 class="Head4"><a name="1_4_1_2_Paragraph_Styles" />Paragraph Styles</h4>
  <p class="Paragraph">Paragraph styles support all properties defined in the services <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html" title="see type com.sun.star.style.ParagraphProperties">com.sun.star.style.ParagraphProperties</a></span> and <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphPropertiesAsian.html" title="see type com.sun.star.style.ParagraphPropertiesAsian">com.sun.star.style.ParagraphPropertiesAsian</a></span>.</p>
  <p class="Paragraph">They are created using the <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/lang/XMultiServiceFactory.html" title="see type com.sun.star.lang.XMultiServiceFactory">com.sun.star.lang.XMultiServiceFactory</a></span>  interface of the text document model using the service name <span class="Codeintext">"com.sun.star.style.ParagraphStyle"</span>.</p>
  <p class="Paragraph">Set the property <span class="Codeintext">ParaStyleName</span> at an object, including the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html" title="see type com.sun.star.style.ParagraphProperties">com.sun.star.style.ParagraphProperties</a></span> to set its paragraph style.</p>
  <h4 class="Head4"><a name="1_4_1_3_Frame_Styles" />Frame Styles</h4>
  <p class="Paragraph">Frame styles support all properties defined in the services <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrameProperties.html" title="see type com.sun.star.text.BaseFrameProperties">com.sun.star.text.BaseFrameProperties</a></span>.</p>
  <p class="Paragraph">The frame styles are applied to text frames, graphic objects and embedded objects.  </p>
  <p class="Paragraph">They are created using the <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/lang/XMultiServiceFactory.html" title="see type com.sun.star.lang.XMultiServiceFactory">com.sun.star.lang.XMultiServiceFactory</a></span>  interface of the text document model using the service name <span class="Codeintext">"com.sun.star.style.FrameStyle"</span>.</p>
  <p class="Paragraph">Set the property <span class="Codeintext">FrameStyleName</span> at <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/BaseFrame.html" title="see type com.sun.star.text.BaseFrame">com.sun.star.text.BaseFrame</a></span> objects to set their frame style.</p>
  <h4 class="Head4"><a name="1_4_1_4_Page_Styles" />Page Styles</h4>
  <p class="Paragraph">Page styles are controlled via properties. The page related properties are defined in the services <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/PageStyle.html" title="see type com.sun.star.style.PageStyle">com.sun.star.style.PageStyle</a></span></p>
  <p class="Paragraph">They are created using the <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/lang/XMultiServiceFactory.html" title="see type com.sun.star.lang.XMultiServiceFactory">com.sun.star.lang.XMultiServiceFactory</a></span>  interface of the text document model using the service name <span class="Codeintext">"com.sun.star.style.PageStyle"</span>.</p>
  <p class="Paragraph">As mentioned above, page styles are not hierarchical. The section <span class="ChapterRef"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/Text/Text.xhtml#1_4_5_Page_Layout" title="see chapter 8.4.5 Text Documents - Overall Document Features - Page Layout">8.4.5 Text Documents - Overall Document Features - Page Layout</a></span> discusses page styles.</p>
  <p class="Paragraph">The PageStyle is set at the current text cursor position by setting the property PageDescName to an existing page style name.This will insert a new page that uses the new page style. If no new page should be inserted, the cursor has to be at the beginning of the first paragraph. </p>
  <h4 class="Head4"><a name="1_4_1_5_Numbering_Styles" />Numbering Styles</h4>
  <p class="Paragraph">Numbering styles support all properties defined in the services <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/NumberingStyle.html" title="see type com.sun.star.text.NumberingStyle">com.sun.star.text.NumberingStyle</a></span>. </p>
  <p class="Paragraph">They are created using the <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/lang/XMultiServiceFactory.html" title="see type com.sun.star.lang.XMultiServiceFactory">com.sun.star.lang.XMultiServiceFactory</a></span>  interface of the text document model using the service name "<span class="Codeintext">com.sun.star.style.NumberingStyle</span>".</p>
  <p class="Paragraph">The structure of the numbering rules is described in section <span class="ChapterRef"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/Text/Text.xhtml#1_4_3_Line_Numbering_and_Outline_Numbering" title="see chapter 8.4.3 Text Documents - Overall Document Features - Line Numbering and Outline Numbering">8.4.3 Text Documents - Overall Document Features - Line Numbering and Outline Numbering</a></span>.</p>
  <p class="Paragraph">The name of the numbering style is set in the property <span class="Codeintext">NumberingStyleName</span> of paragraphs (set through the <span class="Codeintext">PropertySet</span> of a <span class="Codeintext">TextCursor</span>) or a paragraph style to apply the numbering to the paragraphs.</p>
  <p class="Paragraph">The following example demonstrates the use of paragraph styles: (<a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/examples/DevelopersGuide/Text/TextDocuments.java" title="goto source Text/TextDocuments.java">Text/TextDocuments.java</a>) </p>
  <p class="Code">/** This method demonstrates how to create, insert and apply styles </p>
  <p class="Code"> */</p>
  <p class="Code">protected void StylesExample() { </p>
  <p class="Code">    try {</p>
  <p class="Code">        // Go to the end of the document</p>
  <p class="Code">        mxDocCursor.gotoEnd(false);</p>
  <p class="Code"> </p>
  <p class="Code">        // Insert two paragraph breaks</p>
  <p class="Code">        mxDocText.insertControlCharacter( </p>
  <p class="Code">            mxDocCursor, ControlCharacter.PARAGRAPH_BREAK, false);</p>
  <p class="Code">        mxDocText.insertControlCharacter( </p>
  <p class="Code">            mxDocCursor, ControlCharacter.PARAGRAPH_BREAK, false);</p>
  <p class="Code"> </p>
  <p class="Code">        // Create a new style from the document's factory</p>
  <p class="Code">        XStyle xStyle = (XStyle) UnoRuntime.queryInterface( </p>
  <p class="Code">            XStyle.class, mxDocFactory.createInstance("com.sun.star.style.ParagraphStyle"));</p>
  <p class="Code">                </p>
  <p class="Code">        // Access the XPropertySet interface of the new style</p>
  <p class="Code">        XPropertySet xStyleProps = (XPropertySet) UnoRuntime.queryInterface(</p>
  <p class="Code">            XPropertySet.class, xStyle);</p>
  <p class="Code"> </p>
  <p class="Code">        // Give the new style a light blue background</p>
  <p class="Code">        xStyleProps.setPropertyValue ("ParaBackColor", new Integer(13421823));</p>
  <p class="Code"> </p>
  <p class="Code">        // Get the StyleFamiliesSupplier interface of the document</p>
  <p class="Code">        XStyleFamiliesSupplier xSupplier = (XStyleFamiliesSupplier)UnoRuntime.queryInterface(</p>
  <p class="Code">            XStyleFamiliesSupplier.class, mxDoc);</p>
  <p class="Code"> </p>
  <p class="Code">        // Use the StyleFamiliesSupplier interface to get the XNameAccess interface of the</p>
  <p class="Code">        // actual style families</p>
  <p class="Code">        XNameAccess xFamilies = (XNameAccess) UnoRuntime.queryInterface ( </p>
  <p class="Code">            XNameAccess.class, xSupplier.getStyleFamilies());</p>
  <p class="Code"> </p>
  <p class="Code">        // Access the 'ParagraphStyles' Family</p>
  <p class="Code">        XNameContainer xFamily = (XNameContainer) UnoRuntime.queryInterface( </p>
  <p class="Code">            XNameContainer.class, xFamilies.getByName("ParagraphStyles"));</p>
  <p class="Code"> </p>
  <p class="Code">        // Insert the newly created style into the ParagraphStyles family</p>
  <p class="Code">        xFamily.insertByName ("All-Singing All-Dancing Style", xStyle);</p>
  <p class="Code"> </p>
  <p class="Code">        // Get the XParagraphCursor interface of the document cursor</p>
  <p class="Code">        XParagraphCursor xParaCursor = (XParagraphCursor) UnoRuntime.queryInterface(</p>
  <p class="Code">            XParagraphCursor.class, mxDocCursor);</p>
  <p class="Code">                        </p>
  <p class="Code">        // Select the first paragraph inserted</p>
  <p class="Code">        xParaCursor.gotoPreviousParagraph(false);</p>
  <p class="Code">        xParaCursor.gotoPreviousParagraph(true);</p>
  <p class="Code"> </p>
  <p class="Code">        // Access the property set of the cursor selection</p>
  <p class="Code">        XPropertySet xCursorProps = (XPropertySet) UnoRuntime.queryInterface(</p>
  <p class="Code">            XPropertySet.class, mxDocCursor);</p>
  <p class="Code"> </p>
  <p class="Code">        // Set the style of the cursor selection to our newly created style</p>
  <p class="Code">        xCursorProps.setPropertyValue("ParaStyleName", "All-Singing All-Dancing Style");</p>
  <p class="Code"> </p>
  <p class="Code">        // Go back to the end</p>
  <p class="Code">        mxDocCursor.gotoEnd(false);</p>
  <p class="Code">                        </p>
  <p class="Code">        // Select the last paragraph in the document</p>
  <p class="Code">        xParaCursor.gotoNextParagraph(true);</p>
  <p class="Code"> </p>
  <p class="Code">        // And reset it's style to 'Standard' (the programmatic name for the default style)</p>
  <p class="Code">        xCursorProps.setPropertyValue("ParaStyleName", "Standard");</p>
  <p class="Code"> </p>
  <p class="Code">    } catch (Exception e) {</p>
  <p class="Code">        e.printStackTrace (System.out);</p>
  <p class="Code">    }</p>
  <p class="Code">} </p>
  <h3 class="Head3"><a name="1_4_2_Settings" />8.4.2  Settings</h3>
  <h4 class="Head4"><a name="1_4_2_1_General_Document_Information" />General Document Information</h4>
  <p class="Paragraph">Text documents offer general information about the document through their <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/document/XDocumentInfoSupplier.html" title="see type com.sun.star.document.XDocumentInfoSupplier">com.sun.star.document.XDocumentInfoSupplier</a></span> interface. The <span class="Codeintext">DocumentInfo</span> is a common OpenOffice.org feature and is discussed in <span class="ChapterRef"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/OfficeDev/OfficeDev.xhtml#1_Office_Development" title="see chapter 7 Office Development">7 Office Development</a></span>. </p>
  <p class="Paragraph">The XDocumentInfoSupplier has one single method: </p>
  <p class="MethodSignatures">com::sun::star::document::XDocumentInfo <span class="T2">getDocumentInfo</span>()</p>
  <p class="Paragraph">which returns a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/document/DocumentInfo.html" title="see type com.sun.star.document.DocumentInfo">com.sun.star.document.DocumentInfo</a></span> service, offering the statistical information about the document that is available through <span class="T2">File - Properties</span> in the GUI.</p>
  <h4 class="Head4"><a name="1_4_2_2_Document_Properties" />Document Properties</h4>
  <p class="Paragraph">The model implements a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/beans/XPropertySet.html" title="see type com.sun.star.beans.XPropertySet">com.sun.star.beans.XPropertySet</a></span> that provides properties concerning character formatting and general settings.</p>
  <p class="Paragraph">The properties for character attributes are <span class="Codeintext">CharFontName</span>,<span class="Codeintext">CharFontStyleName</span>, <span class="Codeintext">CharFontFamily</span>, <span class="Codeintext">CharFontCharSet</span>, <span class="Codeintext">CharFontPitch</span> and their Asian counterparts <span class="Codeintext">CharFontStyleNameAsian</span>, <span class="Codeintext">CharFontFamilyAsian</span>, <span class="Codeintext">CharFontCharSetAsian</span>, <span class="Codeintext">CharFontPitchAsian</span>. </p>
  <p class="Paragraph">The following properties handle general settings: </p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table15"><colgroup><col width="212" /><col width="493" /></colgroup><tr><td colspan="2" style="text-align:left;width:4.653cm; " class="Table15A1">
      <p class="TableHead">Properties of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextDocument.html" title="see type com.sun.star.text.TextDocument">com.sun.star.text.TextDocument</a></span></p>
     </td></tr><tr><td style="text-align:left;width:4.653cm; " class="Table15A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/AdvancedTextDocument.html#CharLocale" title="see CharLocale of type com.sun.star.text.AdvancedTextDocument">CharLocale</a></span></p>
    </td><td style="text-align:left;width:10.786cm; " class="Table15B2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/lang/Locale.html" title="see type com.sun.star.lang.Locale">com.sun.star.lang.Locale</a></span>. Default locale of the document.</p>
    </td></tr><tr><td style="text-align:left;width:4.653cm; " class="Table15A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/AdvancedTextDocument.html#CharacterCount" title="see CharacterCount of type com.sun.star.text.AdvancedTextDocument">CharacterCount</a></span></p>
    </td><td style="text-align:left;width:10.786cm; " class="Table15B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">—</span> Number of characters.</p>
    </td></tr><tr><td style="text-align:left;width:4.653cm; " class="Table15A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/AdvancedTextDocument.html#ParagraphCount" title="see ParagraphCount of type com.sun.star.text.AdvancedTextDocument">ParagraphCount</a></span></p>
    </td><td style="text-align:left;width:10.786cm; " class="Table15B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">—</span> Number of paragraphs.</p>
    </td></tr><tr><td style="text-align:left;width:4.653cm; " class="Table15A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/AdvancedTextDocument.html#WordCount" title="see WordCount of type com.sun.star.text.AdvancedTextDocument">WordCount</a></span></p>
    </td><td style="text-align:left;width:10.786cm; " class="Table15B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">—</span> Number of words.</p>
    </td></tr><tr><td style="text-align:left;width:4.653cm; " class="Table15A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/AdvancedTextDocument.html#WordSeparator" title="see WordSeparator of type com.sun.star.text.AdvancedTextDocument">WordSeparator</a></span></p>
    </td><td style="text-align:left;width:10.786cm; " class="Table15B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">—</span> Contains all that characters that are treated as separators between words to determine word count.</p>
    </td></tr><tr><td style="text-align:left;width:4.653cm; " class="Table15A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextDocument.html#RedlineDisplayType" title="see RedlineDisplayType of type com.sun.star.text.TextDocument">RedlineDisplayType</a></span></p>
    </td><td style="text-align:left;width:10.786cm; " class="Table15B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">—</span> Displays redlines as defined in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/document/RedlineDisplayType.html" title="see type com.sun.star.document.RedlineDisplayType">com.sun.star.document.RedlineDisplayType</a></span>.</p>
    </td></tr><tr><td style="text-align:left;width:4.653cm; " class="Table15A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/GenericTextDocument.html#RecordChanges" title="see RecordChanges of type com.sun.star.text.GenericTextDocument">RecordChanges</a></span></p>
    </td><td style="text-align:left;width:10.786cm; " class="Table15B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> Determines if redlining is switched on.</p>
    </td></tr><tr><td style="text-align:left;width:4.653cm; " class="Table15A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextDocument.html#ShowChanges" title="see ShowChanges of type com.sun.star.text.TextDocument">ShowChanges</a></span></p>
    </td><td style="text-align:left;width:10.786cm; " class="Table15B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> Determines if redlines are displayed.</p>
    </td></tr><tr><td style="text-align:left;width:4.653cm; " class="Table15A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextDocument.html#RedlineProtectionKey" title="see RedlineProtectionKey of type com.sun.star.text.TextDocument">RedlineProtectionKey</a></span></p>
    </td><td style="text-align:left;width:10.786cm; " class="Table15B2">
     <p class="TextInTable"><span class="Codeintext">sequence &lt; byte &gt;.</span> Contains the password key.</p>
    </td></tr><tr><td style="text-align:left;width:4.653cm; " class="Table15A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/document/Settings.html#ForbiddenCharacters" title="see ForbiddenCharacters of type com.sun.star.document.Settings">ForbiddenCharacters</a></span></p>
    </td><td style="text-align:left;width:10.786cm; " class="Table15B2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/i18n/ForbiddenCharacters.html" title="see type com.sun.star.i18n.ForbiddenCharacters">com.sun.star.i18n.ForbiddenCharacters</a></span>. Contains characters that are not allowed to be at the first or last character of a text line.</p>
    </td></tr><tr><td style="text-align:left;width:4.653cm; " class="Table15A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/GenericTextDocument.html#TwoDigitYear" title="see TwoDigitYear of type com.sun.star.text.GenericTextDocument">TwoDigitYear</a></span></p>
    </td><td style="text-align:left;width:10.786cm; " class="Table15B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">—</span> Determines the start of the range, for example, when entering a two-digit year.</p>
    </td></tr><tr><td style="text-align:left;width:4.653cm; " class="Table15A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/GenericTextDocument.html#IndexAutoMarkFileURL" title="see IndexAutoMarkFileURL of type com.sun.star.text.GenericTextDocument">IndexAutoMarkFileURL</a></span></p>
    </td><td style="text-align:left;width:10.786cm; " class="Table15B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">—</span> The URL to the file that contains the search words and settings of the automatic marking of index marks for alphabetical indexes.</p>
    </td></tr><tr><td style="text-align:left;width:4.653cm; " class="Table15A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/document/OfficeDocument.html#AutomaticControlFocus" title="see AutomaticControlFocus of type com.sun.star.document.OfficeDocument">AutomaticControlFocus</a></span></p>
    </td><td style="text-align:left;width:10.786cm; " class="Table15B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span>, the first form object is selected when the document is loaded.</p>
    </td></tr><tr><td style="text-align:left;width:4.653cm; " class="Table15A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/document/OfficeDocument.html#ApplyFormDesignMode" title="see ApplyFormDesignMode of type com.sun.star.document.OfficeDocument">ApplyFormDesignMode</a></span></p>
    </td><td style="text-align:left;width:10.786cm; " class="Table15B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> Determines if form (database) controls are in the design mode.</p>
    </td></tr><tr><td style="text-align:left;width:4.653cm; " class="Table15A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextDocument.html#HideFieldTips" title="see HideFieldTips of type com.sun.star.text.TextDocument">HideFieldTips</a></span></p>
    </td><td style="text-align:left;width:10.786cm; " class="Table15B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span>, the automatic tips displayed for some types of text fields are suppressed.</p>
    </td></tr></table></div>
  <h4 class="Head4"><a name="1_4_2_3_Creating_Default_Settings" />Creating Default Settings</h4>
  <p class="Paragraph">The <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/lang/XMultiServiceFactory.html" title="see type com.sun.star.lang.XMultiServiceFactory">com.sun.star.lang.XMultiServiceFactory</a></span> implemented at the model provides the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Defaults.html" title="see type com.sun.star.text.Defaults">com.sun.star.text.Defaults</a></span>. Use this service to find out default values to set paragraph and character properties of the document to default. </p>
  <h4 class="Head4"><a name="1_4_2_4_Creating_Document_Settings" />Creating Document Settings</h4>
  <p class="Paragraph">Another set of properties can be created by the service name <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/document/Settings.html" title="see type com.sun.star.document.Settings">com.sun.star.document.Settings</a></span> that contains a number of additional settings. </p>
  <h3 class="Head3"><a name="1_4_3_Line_Numbering_and_Outline_Numbering" />8.4.3  Line Numbering and Outline Numbering</h3>
  <p class="Paragraph">OpenOffice.org provides automatic numbering for texts. For instance, paragraphs can be numbered or listed with bullets in a hierarchical manner, chapter headings can be numbered and lines can be counted and numbered.  </p>
  <h4 class="Head4"><a name="1_4_3_1_Paragraph_and_Outline_Numbering" />Paragraph and Outline Numbering</h4>
  <p class="Paragraph"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/NumberingRules.html" title="see type com.sun.star.text.NumberingRules">com.sun.star.text.NumberingRules</a></span>The key for paragraph numbering is the paragraph property <span class="Codeintext">NumberingRules</span>. This property is provided by paragraphs and numbering styles and is a member of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/ParagraphProperties.html" title="see type com.sun.star.style.ParagraphProperties">com.sun.star.style.ParagraphProperties</a></span>. </p>
  <p class="Paragraph">A similar object controls outline numbering and is returned from the method:</p>
  <p class="MethodSignatures">com::sun::star::container::XIndexReplace <span class="T2">getChapterNumberingRules</span>()</p>
  <p class="Paragraph">at the <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XChapterNumberingSupplier.html" title="see type com.sun.star.text.XChapterNumberingSupplier">com.sun.star.text.XChapterNumberingSupplier</a></span> interface that is implemented at the document model. </p>
  <p class="Paragraph">These objects provide an interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XIndexReplace.html" title="see type com.sun.star.container.XIndexReplace">com.sun.star.container.XIndexReplace</a></span>. Each element of the container represents a numbering level. The writer document provides ten numbering levels. The highest level is zero. Each level of the container consists of a sequence of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/beans/PropertyValue.html" title="see type com.sun.star.beans.PropertyValue">com.sun.star.beans.PropertyValue</a></span>.</p>
  <p class="P28">The two related objects differ in some of properties they provide.  </p>
  <p class="P28">Both of them provide the following properties: </p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table47"><colgroup><col width="225" /><col width="480" /></colgroup><tr><td colspan="2" style="text-align:left;width:4.927cm; " class="Table47A1">
      <p class="TableHead">Common Properties for Paragraph and Outline Numbering in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/NumberingLevel.html" title="see type com.sun.star.text.NumberingLevel">com.sun.star.text.NumberingLevel</a></span></p>
     </td></tr><tr><td style="text-align:left;width:4.927cm; " class="Table47A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/NumberingLevel.html#Adjust" title="see Adjust of type com.sun.star.text.NumberingLevel">Adjust</a></span></p>
    </td><td style="text-align:left;width:10.513cm; " class="Table47B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">—</span> Adjustment of the numbering symbol defined in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/HoriOrientation.html" title="see type com.sun.star.text.HoriOrientation">com.sun.star.text.HoriOrientation</a></span>.</p>
    </td></tr><tr><td style="text-align:left;width:4.927cm; " class="Table47A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/NumberingLevel.html#ParentNumbering" title="see ParentNumbering of type com.sun.star.text.NumberingLevel">ParentNumbering</a></span></p>
    </td><td style="text-align:left;width:10.513cm; " class="Table47B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">—</span> Determines if higher numbering levels are included in the numbering, for example, 2.3.1.2.</p>
    </td></tr><tr><td style="text-align:left;width:4.927cm; " class="Table47A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/NumberingLevel.html#Prefix" title="see Prefix of type com.sun.star.text.NumberingLevel">Prefix</a></span><br /><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/NumberingLevel.html#Suffix" title="see Suffix of type com.sun.star.text.NumberingLevel">Suffix</a></span></p>
    </td><td style="text-align:left;width:10.513cm; " class="Table47B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">—</span> Contains strings that surround the numbering symbol, for example, brackets.</p>
    </td></tr><tr><td style="text-align:left;width:4.927cm; " class="Table47A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/NumberingLevel.html#CharStyleName" title="see CharStyleName of type com.sun.star.text.NumberingLevel">CharStyleName</a></span></p>
    </td><td style="text-align:left;width:10.513cm; " class="Table47B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">—</span> Name of the character style that is applied to the number symbol.</p>
    </td></tr><tr><td style="text-align:left;width:4.927cm; " class="Table47A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/NumberingLevel.html#StartWith" title="see StartWith of type com.sun.star.text.NumberingLevel">StartWith</a></span></p>
    </td><td style="text-align:left;width:10.513cm; " class="Table47B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">—</span> Determines the value the numbering starts with. The default is one.</p>
    </td></tr><tr><td style="text-align:left;width:4.927cm; " class="Table47A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/NumberingLevel.html#FirstLineOffset" title="see FirstLineOffset of type com.sun.star.text.NumberingLevel">FirstLineOffset</a></span><br /><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/NumberingLevel.html#LeftMargin" title="see LeftMargin of type com.sun.star.text.NumberingLevel">LeftMargin</a></span><br /></p>
    </td><td style="text-align:left;width:10.513cm; " class="Table47B2">
     <p class="TextInTable"><span class="Codeintext">long</span> <span class="T8">—</span> Influences the left indent and left margin of the numbering.</p>
    </td></tr><tr><td style="text-align:left;width:4.927cm; " class="Table47A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/NumberingLevel.html#SymbolTextDistance" title="see SymbolTextDistance of type com.sun.star.text.NumberingLevel">SymbolTextDistance</a></span></p>
    </td><td style="text-align:left;width:10.513cm; " class="Table47B2">
     <p class="TextInTable"><span class="Codeintext">[optional] long</span> <span class="T8">—</span> Distance between the numbering symbol and the text of the paragraph.</p>
    </td></tr><tr><td style="text-align:left;width:4.927cm; " class="Table47A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/NumberingLevel.html#NumberingType" title="see NumberingType of type com.sun.star.text.NumberingLevel">NumberingType</a></span></p>
    </td><td style="text-align:left;width:10.513cm; " class="Table47B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">—</span> Determines the type of the numbering defined in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/NumberingType.html" title="see type com.sun.star.style.NumberingType">com.sun.star.style.NumberingType</a></span>.</p>
    </td></tr></table></div>
  <p class="P28">Only paragraphs have the following properties in their <span class="Codeintext">NumberingRules</span> property:</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table48"><colgroup><col width="296" /><col width="409" /></colgroup><tr><td style="text-align:left;width:6.486cm; " class="Table48A1">
      <p class="TableHead">Paragraph NumberingRules Properties in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/NumberingLevel.html" title="see type com.sun.star.text.NumberingLevel">com.sun.star.text.NumberingLevel</a></span></p>
     </td><td style="text-align:left;width:8.954cm; " class="Table48B1">
      <p class="TableHead">Description </p>
     </td></tr><tr><td style="text-align:left;width:6.486cm; " class="Table48A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/NumberingLevel.html#BulletChar" title="see BulletChar of type com.sun.star.text.NumberingLevel">BulletChar</a></span></p>
    </td><td style="text-align:left;width:8.954cm; " class="Table48B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">—</span> Determines the bullet character if the numbering type is set to <span class="Codeintext">NumberingType::CHAR_SPECIAL</span>.</p>
    </td></tr><tr><td style="text-align:left;width:6.486cm; " class="Table48A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/NumberingLevel.html#BulletFontName" title="see BulletFontName of type com.sun.star.text.NumberingLevel">BulletFontName</a></span></p>
    </td><td style="text-align:left;width:8.954cm; " class="Table48B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">—</span> Determines the bullet font if the numbering type is set to <span class="Codeintext">NumberingType::CHAR_SPECIAL</span>.</p>
    </td></tr><tr><td style="text-align:left;width:6.486cm; " class="Table48A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/NumberingLevel.html#GraphicURL" title="see GraphicURL of type com.sun.star.text.NumberingLevel">GraphicURL</a></span></p>
    </td><td style="text-align:left;width:8.954cm; " class="Table48B2">
     <p class="TextInTable"><span class="Codeintext">string</span> <span class="T8">—</span> Determines the type, size and orientation of a graphic when the numbering type is set to <span class="Codeintext">NumberingType::BITMAP</span>.</p>
    </td></tr><tr><td style="text-align:left;width:6.486cm; " class="Table48A2">
     <p class="TextInTable">GraphicBitmap </p>
    </td><td style="text-align:left;width:8.954cm; " class="Table48B2">
     <p class="TextInTable">Undocumented </p>
    </td></tr><tr><td style="text-align:left;width:6.486cm; " class="Table48A2">
     <p class="TextInTable">GraphicSize </p>
    </td><td style="text-align:left;width:8.954cm; " class="Table48B2">
     <p class="TextInTable">Undocumented </p>
    </td></tr><tr><td style="text-align:left;width:6.486cm; " class="Table48A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/NumberingLevel.html#VertOrient" title="see VertOrient of type com.sun.star.text.NumberingLevel">VertOrient</a></span></p>
    </td><td style="text-align:left;width:8.954cm; " class="Table48B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">—</span> Vertical orientation of a graphic according to <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/VertOrientation.html" title="see type com.sun.star.text.VertOrientation">com.sun.star.text.VertOrientation</a></span></p>
    </td></tr></table></div>
  <p class="P28">Only the chapter numbering rules provide the following property: </p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table51"><colgroup><col width="296" /><col width="409" /></colgroup><tr><td style="text-align:left;width:6.486cm; " class="Table51A1">
      <p class="TableHead">Property of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ChapterNumberingRule.html" title="see type com.sun.star.text.ChapterNumberingRule">com.sun.star.text.ChapterNumberingRule</a></span></p>
     </td><td style="text-align:left;width:8.954cm; " class="Table51B1">
      <p class="TableHead">Description </p>
     </td></tr><tr><td style="text-align:left;width:6.486cm; " class="Table51A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ChapterNumberingRule.html#HeadingStyleName" title="see HeadingStyleName of type com.sun.star.text.ChapterNumberingRule">HeadingStyleName</a></span></p>
    </td><td style="text-align:left;width:8.954cm; " class="Table51B2">
     <p class="TextInTable">string <span class="T8">—</span> Contains the name of the paragraph style that marks a paragraph as a chapter heading.</p>
    </td></tr></table></div>
  <p class="Textbody"> </p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table7"><colgroup><col width="112" /><col width="709" /></colgroup><tr><td style="text-align:left;width:2.45cm; " class="Table7A1">
      <div class="TextInTable"><img width="39" height="39" alt="Note graphics marks a special text section" src="./8 Text Documents_files/interesting.gif" class="fr10" /></div>
     </td><td style="text-align:left;width:15.529cm; " class="Table7B1">
      <p class="TipInTable">Note that the <span class="Codeintext">NumberingRules</span> service is returned by value like most properties in the OpenOffice.org API, therefore you must get the rules from the <span class="Codeintext">XPropertySet</span>, change them and put the <span class="Codeintext">NumberingRules</span> object back into the property.</p>
     </td></tr></table></div>
  <p class="Paragraph">The following is an example for the <span class="Codeintext">NumberingRules</span> service: (<a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/examples/DevelopersGuide/Text/TextDocuments.java" title="goto source Text/TextDocuments.java">Text/TextDocuments.java</a>)</p>
  <p class="Code">/** This method demonstrates how to set numbering types and numbering levels using the </p>
  <p class="Code">        com.sun.star.text.NumberingRules service</p>
  <p class="Code"> */</p>
  <p class="Code">protected void NumberingExample() { </p>
  <p class="Code">    try {</p>
  <p class="Code">        // Go to the end of the document</p>
  <p class="Code">        mxDocCursor.gotoEnd(false);</p>
  <p class="Code">        // Get the RelativeTextContentInsert interface of the document</p>
  <p class="Code">        XRelativeTextContentInsert xRelative = (XRelativeTextContentInsert)</p>
  <p class="Code">            UnoRuntime.queryInterface(XRelativeTextContentInsert.class, mxDocText);</p>
  <p class="Code">        </p>
  <p class="Code">        // Use the document's factory to create the NumberingRules service, and get it's</p>
  <p class="Code">        // XIndexAccess interface</p>
  <p class="Code">        XIndexAccess xNum = (XIndexAccess) UnoRuntime.queryInterface(XIndexAccess.class,</p>
  <p class="Code">            mxDocFactory.createInstance("com.sun.star.text.NumberingRules"));</p>
  <p class="Code">                        </p>
  <p class="Code">        // Also get the NumberingRule's XIndexReplace interface</p>
  <p class="Code">        XIndexReplace xReplace = (XIndexReplace) UnoRuntime.queryInterface(</p>
  <p class="Code">        XIndexReplace.class, xNum);</p>
  <p class="Code">        </p>
  <p class="Code">        // Create an array of XPropertySets, one for each of the three paragraphs we're about</p>
  <p class="Code">        // to create</p>
  <p class="Code">        XPropertySet xParas[] = new XPropertySet[3];</p>
  <p class="Code">        for (int i = 0 ; i &lt; 3 ; ++ i) {</p>
  <p class="Code">            // Create a new paragraph</p>
  <p class="Code">            XTextContent xNewPara = (XTextContent) UnoRuntime.queryInterface(</p>
  <p class="Code">                XTextContent.class, mxDocFactory.createInstance(</p>
  <p class="Code">                    "com.sun.star.text.Paragraph"));</p>
  <p class="Code">                                </p>
  <p class="Code">            // Get the XPropertySet interface of the new paragraph and put it in our array</p>
  <p class="Code">            xParas[i] = (XPropertySet) UnoRuntime.queryInterface( </p>
  <p class="Code">                XPropertySet.class, xNewPara);</p>
  <p class="Code">                                </p>
  <p class="Code">            // Insert the new paragraph into the document after the fish section. As it is</p>
  <p class="Code">            // an insert</p>
  <p class="Code">            // relative to the fish section, the first paragraph inserted will be below</p>
  <p class="Code">            // the next two</p>
  <p class="Code">            xRelative.insertTextContentAfter (xNewPara, mxFishSection);</p>
  <p class="Code"> </p>
  <p class="Code">            // Separate from the above, but also needs to be done three times</p>
  <p class="Code"> </p>
  <p class="Code">            // Get the PropertyValue sequence for this numbering level</p>
  <p class="Code">            PropertyValue[] aProps = (PropertyValue []) xNum.getByIndex(i);</p>
  <p class="Code"> </p>
  <p class="Code">            // Iterate over the PropertyValue's for this numbering level, looking for the</p>
  <p class="Code">            // 'NumberingType' property</p>
  <p class="Code">            for (int j = 0 ; j &lt; aProps.length ; ++j) {</p>
  <p class="Code">                if (aProps[j].Name.equals ("NumberingType")) {</p>
  <p class="Code">                    // Once we find it, set it's value to a new type, </p>
  <p class="Code">                    // dependent on which</p>
  <p class="Code">                    // numbering level we're currently on</p>
  <p class="Code">                    switch ( i ) {</p>
  <p class="Code">                        case 0 : aProps[j].Value = new Short(NumberingType.ROMAN_UPPER);</p>
  <p class="Code">                            break;</p>
  <p class="Code">                        case 1 : aProps[j].Value = new Short(NumberingType.CHARS_UPPER_LETTER);</p>
  <p class="Code">                            break;</p>
  <p class="Code">                        case 2 : aProps[j].Value = new Short(NumberingType.ARABIC);</p>
  <p class="Code">                            break;</p>
  <p class="Code">                    }</p>
  <p class="Code">                    // Put the updated PropertyValue sequence back into the</p>
  <p class="Code">                    // NumberingRules service</p>
  <p class="Code">                    xReplace.replaceByIndex (i, aProps); </p>
  <p class="Code">                    break;</p>
  <p class="Code">                }</p>
  <p class="Code">            }</p>
  <p class="Code">        }</p>
  <p class="Code">        // Get the XParagraphCursor interface of our text cursro</p>
  <p class="Code">        XParagraphCursor xParaCursor = (XParagraphCursor) UnoRuntime.queryInterface(</p>
  <p class="Code">            XParagraphCursor.class, mxDocCursor);</p>
  <p class="Code">        // Go to the end of the document, then select the preceding paragraphs</p>
  <p class="Code">        mxDocCursor.gotoEnd(false);</p>
  <p class="Code">        xParaCursor.gotoPreviousParagraph false);</p>
  <p class="Code">        xParaCursor.gotoPreviousParagraph true);</p>
  <p class="Code">        xParaCursor.gotoPreviousParagraph true);</p>
  <p class="Code"> </p>
  <p class="Code">        // Get the XPropertySet of the cursor's currently selected text</p>
  <p class="Code">        XPropertySet xCursorProps = (XPropertySet) UnoRuntime.queryInterface(</p>
  <p class="Code">            XPropertySet.class, mxDocCursor);</p>
  <p class="Code"> </p>
  <p class="Code">        // Set the updated Numbering rules to the cursor's property set</p>
  <p class="Code">        xCursorProps.setPropertyValue ("NumberingRules", xNum);</p>
  <p class="Code">        mxDocCursor.gotoEnd(false);</p>
  <p class="Code"> </p>
  <p class="Code">        // Set the first paragraph that was inserted to a numbering level of 2 (thus it will</p>
  <p class="Code">        // have Arabic style numbering)</p>
  <p class="Code">        xParas[0].setPropertyValue ("NumberingLevel", new Short ((short) 2));</p>
  <p class="Code"> </p>
  <p class="Code">        // Set the second paragraph that was inserted to a numbering level of 1 (thus it will</p>
  <p class="Code">        // have 'Chars Upper Letter' style numbering)</p>
  <p class="Code">        xParas[1].setPropertyValue ("NumberingLevel", new Short((short) 1));</p>
  <p class="Code"> </p>
  <p class="Code">        // Set the third paragraph that was inserted to a numbering level of 0 (thus it will</p>
  <p class="Code">        // have 'Chars Upper Letter' style numbering)</p>
  <p class="Code">        xParas[2].setPropertyValue("NumberingLevel", new Short((short) 0));</p>
  <p class="Code">    } catch (Exception e) {</p>
  <p class="Code">        e.printStackTrace (System.out);</p>
  <p class="Code">    }</p>
  <p class="Code">} </p>
  <h4 class="Head4"><a name="1_4_3_2_Line_Numbering" />Line Numbering</h4>
  <p class="Paragraph">The text document model supports the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XLineNumberingProperties.html" title="see type com.sun.star.text.XLineNumberingProperties">com.sun.star.text.XLineNumberingProperties</a></span>. The provided object has the properties described in the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/LineNumberingProperties.html" title="see type com.sun.star.text.LineNumberingProperties">com.sun.star.text.LineNumberingProperties</a></span>. It is used in conjunction with the paragraph properties <span class="Codeintext">ParaLineNumberCount</span> and <span class="Codeintext">ParaLineNumberStartValue</span>.</p>
  <h4 class="Head4"><a name="1_4_3_3_Number_Formats" />Number Formats</h4>
  <p class="Paragraph">The text document model provides access to the number formatter through aggregation, that is, it provides the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/util/XNumberFormatsSupplier.html" title="see type com.sun.star.util.XNumberFormatsSupplier">com.sun.star.util.XNumberFormatsSupplier</a></span> seamlessly.</p>
  <p class="Paragraph">The number formatter is used to format numerical values. For details, refer to <span class="ChapterRef"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/OfficeDev/OfficeDev.xhtml#1_2_5_Number_Formats" title="see chapter 7.2.5 Office Development - Common Application Features - Number Formats">7.2.5 Office Development - Common Application Features - Number Formats</a></span>.</p>
  <p class="Paragraph">In text, text fields with numeric content and table cells provide a property <span class="Codeintext">NumberFormat</span> that contains a long value that refers to a number format.</p>
  <h3 class="Head3"><a name="1_4_4_Text_Sections" />8.4.4  Text Sections</h3>
  <p class="Paragraph">A text section is a range of complete paragraphs that can have its own format settings and source location, separate from the surrounding text. Text sections can be nested in a hierarchical structure.  </p>
  <p class="Paragraph">For example, a section is formatted to have text columns that different column settings in a text on a paragraph by paragraph basis. The content of a section can be linked through file links or over a DDE connection.  </p>
  <p class="Paragraph">The text sections support the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextSection.html" title="see type com.sun.star.text.TextSection">com.sun.star.text.TextSection</a></span>. To access the sections, the text document model implements the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextSectionsSupplier.html" title="see type com.sun.star.text.XTextSectionsSupplier">com.sun.star.text.XTextSectionsSupplier</a></span> that provides an interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XNameAccess.html" title="see type com.sun.star.container.XNameAccess">com.sun.star.container.XNameAccess</a></span> . The returned objects support the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XIndexAccess.html" title="see type com.sun.star.container.XIndexAccess">com.sun.star.container.XIndexAccess</a></span>, as well.</p>
  <p class="Paragraph">Master documents implement the structure of sub documents using linked text sections.  </p>
  <p class="Paragraph">An example demonstrating the creation, insertion and linking of text sections: (<a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/examples/DevelopersGuide/Text/TextDocuments.java" title="goto source Text/TextDocuments.java">Text/TextDocuments.java</a>) </p>
  <p class="Code">/** This method demonstrates how to create linked and unlinked sections  </p>
  <p class="Code"> */</p>
  <p class="Code">protected void TextSectionExample() { </p>
  <p class="Code">    try {</p>
  <p class="Code">        // Go to the end of the document</p>
  <p class="Code">        mxDocCursor.gotoEnd(false);</p>
  <p class="Code">        // Insert two paragraph breaks</p>
  <p class="Code">        mxDocText.insertControlCharacter( </p>
  <p class="Code">            mxDocCursor, ControlCharacter.PARAGRAPH_BREAK, false);</p>
  <p class="Code">        mxDocText.insertControlCharacter( </p>
  <p class="Code">        mxDocCursor, ControlCharacter.PARAGRAPH_BREAK, true);</p>
  <p class="Code"> </p>
  <p class="Code">        // Create a new TextSection from the document factory and access it's XNamed interface</p>
  <p class="Code">        XNamed xChildNamed = (XNamed) UnoRuntime.queryInterface(</p>
  <p class="Code">            XNamed.class, mxDocFactory.createInstance("com.sun.star.text.TextSection"));</p>
  <p class="Code">        // Set the new sections name to 'Child_Section'</p>
  <p class="Code">        xChildNamed.setName("Child_Section");</p>
  <p class="Code"> </p>
  <p class="Code">        // Access the Child_Section's XTextContent interface and insert it into the document</p>
  <p class="Code">        XTextContent xChildSection = (XTextContent) UnoRuntime.queryInterface(</p>
  <p class="Code">            XTextContent.class, xChildNamed);</p>
  <p class="Code">        mxDocText.insertTextContent (mxDocCursor, xChildSection, false);</p>
  <p class="Code"> </p>
  <p class="Code">        // Access the XParagraphCursor interface of our text cursor</p>
  <p class="Code">        XParagraphCursor xParaCursor = (XParagraphCursor) UnoRuntime.queryInterface( </p>
  <p class="Code">            XParagraphCursor.class, mxDocCursor);</p>
  <p class="Code"> </p>
  <p class="Code">        // Go back one paragraph (into Child_Section)</p>
  <p class="Code">        xParaCursor.gotoPreviousParagraph(false);</p>
  <p class="Code">                        </p>
  <p class="Code">        // Insert a string into the Child_Section</p>
  <p class="Code">        mxDocText.insertString(mxDocCursor, "This is a test", false);</p>
  <p class="Code"> </p>
  <p class="Code">        // Go to the end of the document</p>
  <p class="Code">        mxDocCursor.gotoEnd(false);</p>
  <p class="Code">                        </p>
  <p class="Code">        // Go back two paragraphs</p>
  <p class="Code">        xParaCursor.gotoPreviousParagraph (false);</p>
  <p class="Code">        xParaCursor.gotoPreviousParagraph (false);</p>
  <p class="Code">        // Go to the end of the document, selecting the two paragraphs</p>
  <p class="Code">        mxDocCursor.gotoEnd(true);</p>
  <p class="Code"> </p>
  <p class="Code">        // Create another text section and access it's XNamed interface</p>
  <p class="Code">        XNamed xParentNamed = (XNamed) UnoRuntime.queryInterface(XNamed.class,</p>
  <p class="Code">            mxDocFactory.createInstance("com.sun.star.text.TextSection"));</p>
  <p class="Code"> </p>
  <p class="Code">        // Set this text section's name to Parent_Section</p>
  <p class="Code">        xParentNamed.setName ("Parent_Section");</p>
  <p class="Code"> </p>
  <p class="Code">        // Access the Parent_Section's XTextContent interface ...</p>
  <p class="Code">        XTextContent xParentSection = (XTextContent) UnoRuntime.queryInterface(</p>
  <p class="Code">            XTextContent.class, xParentNamed);</p>
  <p class="Code">        // ...and insert it into the document</p>
  <p class="Code">        mxDocText.insertTextContent(mxDocCursor, xParentSection, false);</p>
  <p class="Code"> </p>
  <p class="Code">        // Go to the end of the document</p>
  <p class="Code">        mxDocCursor.gotoEnd (false);</p>
  <p class="Code">        // Insert a new paragraph</p>
  <p class="Code">        mxDocText.insertControlCharacter( </p>
  <p class="Code">            mxDocCursor, ControlCharacter.PARAGRAPH_BREAK, false);</p>
  <p class="Code">        // And select the new pargraph</p>
  <p class="Code">        xParaCursor.gotoPreviousParagraph(true);</p>
  <p class="Code"> </p>
  <p class="Code">        // Create a new Text Section and access it's XNamed interface</p>
  <p class="Code">        XNamed xLinkNamed = (XNamed) UnoRuntime.queryInterface(</p>
  <p class="Code">            XNamed.class, mxDocFactory.createInstance("com.sun.star.text.TextSection"));</p>
  <p class="Code">        // Set the new text section's name to Linked_Section</p>
  <p class="Code">        xLinkNamed.setName("Linked_Section");</p>
  <p class="Code"> </p>
  <p class="Code">        // Access the Linked_Section's XTextContent interface</p>
  <p class="Code">        XTextContent xLinkedSection = (XTextContent) UnoRuntime.queryInterface(</p>
  <p class="Code">            XTextContent.class, xLinkNamed);</p>
  <p class="Code">        // And insert the Linked_Section into the document</p>
  <p class="Code">        mxDocText.insertTextContent(mxDocCursor, xLinkedSection, false);</p>
  <p class="Code"> </p>
  <p class="Code">        // Access the Linked_Section's XPropertySet interface</p>
  <p class="Code">        XPropertySet xLinkProps = (XPropertySet) UnoRuntime.queryInterface( </p>
  <p class="Code">            XPropertySet.class, xLinkNamed);</p>
  <p class="Code">        // Set the linked section to be linked to the Child_Section</p>
  <p class="Code">        xLinkProps.setPropertyValue("LinkRegion", "Child_Section");</p>
  <p class="Code">                        </p>
  <p class="Code">        // Access the XPropertySet interface of the Child_Section</p>
  <p class="Code">        XPropertySet xChildProps = (XPropertySet) UnoRuntime.queryInterface(</p>
  <p class="Code">            XPropertySet.class, xChildNamed);</p>
  <p class="Code">        // Set the Child_Section's background colour to blue</p>
  <p class="Code">        xChildProps.setPropertyValue("BackColor", new Integer(13421823));</p>
  <p class="Code"> </p>
  <p class="Code">        // Refresh the document, so the linked section matches the Child_Section</p>
  <p class="Code">        XRefreshable xRefresh = (XRefreshable) UnoRuntime.queryInterface( </p>
  <p class="Code">            XRefreshable.class, mxDoc);</p>
  <p class="Code">        xRefresh.refresh();</p>
  <p class="Code">    } catch (Exception e) {</p>
  <p class="Code">        e.printStackTrace (System.out);</p>
  <p class="Code">    }</p>
  <p class="Code">} </p>
  <h3 class="Head3"><a name="1_4_5_Page_Layout" />8.4.5  Page Layout</h3>
  <p class="Paragraph">A page layout in OpenOffice.org is always a page style. A page can not be hard formatted. To change the current page layout, retrieve the current page style from the text cursor property <span class="Codeintext">PageStyleName</span> and get this page style from the <span class="Codeintext">StyleFamily</span> <span class="Codeintext">PageStyles</span>.</p>
  <p class="Paragraph">Changes of the page layout happen through the properties described in <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/PageProperties.html" title="see type com.sun.star.style.PageProperties">com.sun.star.style.PageProperties</a></span>. Refer to the API reference for details on all the possible properties, including the header and footer texts which are part of these properties.</p>
  <p class="Paragraph">As headers or footers are connected to a page style, the text objects are provided as properties of the style. Depending on the setting of the page layout, there is one header and footer text object per style available or there are two, a left and right header, and footer text:. </p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table52"><colgroup><col width="236" /><col width="469" /></colgroup><tr class="Table521"><td style="text-align:left;width:5.172cm; " class="Table52A1">
     <p class="TableHead"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/PageProperties.html" title="see type com.sun.star.style.PageProperties">com.sun.star.style.PageProperties</a></span> containing Headers and Footers</p>
    </td><td style="text-align:left;width:10.268cm; " class="Table52B1">
     <p class="TableHead">Description </p>
    </td></tr><tr class="Table521"><td style="text-align:left;width:5.172cm; " class="Table52A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/PageProperties.html#HeaderText" title="see HeaderText of type com.sun.star.style.PageProperties">HeaderText</a></span></p>
    </td><td style="text-align:left;width:10.268cm; " class="Table52B2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Text.html" title="see type com.sun.star.text.Text">com.sun.star.text.Text</a></span></p>
    </td></tr><tr class="Table521"><td style="text-align:left;width:5.172cm; " class="Table52A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/PageProperties.html#HeaderTextLeft" title="see HeaderTextLeft of type com.sun.star.style.PageProperties">HeaderTextLeft</a></span></p>
    </td><td style="text-align:left;width:10.268cm; " class="Table52B2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Text.html" title="see type com.sun.star.text.Text">com.sun.star.text.Text</a></span></p>
    </td></tr><tr class="Table521"><td style="text-align:left;width:5.172cm; " class="Table52A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/PageProperties.html#HeaderTextRight" title="see HeaderTextRight of type com.sun.star.style.PageProperties">HeaderTextRight</a></span></p>
    </td><td style="text-align:left;width:10.268cm; " class="Table52B2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Text.html" title="see type com.sun.star.text.Text">com.sun.star.text.Text</a></span></p>
    </td></tr><tr class="Table521"><td style="text-align:left;width:5.172cm; " class="Table52A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/PageProperties.html#FooterText" title="see FooterText of type com.sun.star.style.PageProperties">FooterText</a></span></p>
    </td><td style="text-align:left;width:10.268cm; " class="Table52B2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Text.html" title="see type com.sun.star.text.Text">com.sun.star.text.Text</a></span></p>
    </td></tr><tr class="Table521"><td style="text-align:left;width:5.172cm; " class="Table52A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/PageProperties.html#FooterTextLeft" title="see FooterTextLeft of type com.sun.star.style.PageProperties">FooterTextLeft</a></span></p>
    </td><td style="text-align:left;width:10.268cm; " class="Table52B2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Text.html" title="see type com.sun.star.text.Text">com.sun.star.text.Text</a></span></p>
    </td></tr><tr class="Table521"><td style="text-align:left;width:5.172cm; " class="Table52A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/PageProperties.html#FooterTextRight" title="see FooterTextRight of type com.sun.star.style.PageProperties">FooterTextRight</a></span></p>
    </td><td style="text-align:left;width:10.268cm; " class="Table52B2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/Text.html" title="see type com.sun.star.text.Text">com.sun.star.text.Text</a></span></p>
    </td></tr></table></div>
  <p class="Paragraph">The page layout of a page style can be equal on left and right pages, mirrored, or separate for right and left pages. This is controlled by the property <span class="Codeintext">PageStyleLayout</span> that expects values from the enum <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/style/PageStyleLayout.html" title="see type com.sun.star.style.PageStyleLayout">com.sun.star.style.PageStyleLayout</a></span>. As long as left and right pages are equal, <span class="Codeintext">HeaderText</span> and <span class="Codeintext">HeaderRightText</span> are identical. The same applies to the footers.</p>
  <p class="Paragraph">The text objects in headers and footers are only available if headers or footers are switched on, using the properties <span class="Codeintext">HeaderIsOn</span> and <span class="Codeintext">FooterIsOn</span>. </p>
  <p class="Paragraph">Drawing objects cannot be inserted into headers or footers. </p>
  <h3 class="Head3"><a name="1_4_6_Columns" />8.4.6  Columns</h3>
  <p class="Paragraph">Text frames, text sections and page styles can be formatted to have columns. The width of columns is relative since the absolute width of the object is unknown in the model. The layout formatting is responsible for calculating the actual widths of the columns.  </p>
  <p class="Paragraph">Columns are applied using the property <span class="Codeintext">TextColumns</span>. It expects a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextColumns.html" title="see type com.sun.star.text.TextColumns">com.sun.star.text.TextColumns</a></span> service that has to be created by the document factory. The interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextColumns.html" title="see type com.sun.star.text.XTextColumns">com.sun.star.text.XTextColumns</a></span> refines the characteristics of the text columns before applying the created <span class="Codeintext">TextColumns</span> service to the property <span class="Codeintext">TextColumns</span>.</p>
  <p class="Paragraph">Consider the following example to see how to work with text columns: (<a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/examples/DevelopersGuide/Text/TextDocuments.java" title="goto source Text/TextDocuments.java">Text/TextDocuments.java</a>) </p>
  <p class="Code">/** This method demonstrates the XTextColumns interface and how to insert a blank paragraph </p>
  <p class="Code">    using the XRelativeTextContentInsert interface</p>
  <p class="Code"> */</p>
  <p class="Code">protected void TextColumnsExample() { </p>
  <p class="Code">    try {</p>
  <p class="Code">        // Go to the end of the doucment</p>
  <p class="Code">        mxDocCursor.gotoEnd(false);</p>
  <p class="Code">        // insert a new paragraph</p>
  <p class="Code">        mxDocText.insertControlCharacter(mxDocCursor, ControlCharacter.PARAGRAPH_BREAK, false);</p>
  <p class="Code"> </p>
  <p class="Code">        // insert the string 'I am a fish.' 100 times</p>
  <p class="Code">        for (int i = 0 ; i &lt; 100 ; ++i) {</p>
  <p class="Code">            mxDocText.insertString(mxDocCursor, "I am a fish.", false);</p>
  <p class="Code">        }</p>
  <p class="Code">        // insert a paragraph break after the text</p>
  <p class="Code">        mxDocText.insertControlCharacter(mxDocCursor, ControlCharacter.PARAGRAPH_BREAK, false);</p>
  <p class="Code">                        </p>
  <p class="Code">        // Get the XParagraphCursor interface of our text cursor</p>
  <p class="Code">        XParagraphCursor xParaCursor = (XParagraphCursor) UnoRuntime.queryInterface(</p>
  <p class="Code">            XParagraphCursor.class, mxDocCursor);</p>
  <p class="Code">        // Jump back before all the text we just inserted</p>
  <p class="Code">        xParaCursor.gotoPreviousParagraph(false);</p>
  <p class="Code">        xParaCursor.gotoPreviousParagraph(false);</p>
  <p class="Code">                        </p>
  <p class="Code">        // Insert a string at the beginning of the block of text</p>
  <p class="Code">        mxDocText.insertString(mxDocCursor, "Fish section begins:", false);</p>
  <p class="Code"> </p>
  <p class="Code">        // Then select all of the text</p>
  <p class="Code">        xParaCursor.gotoNextParagraph(true);</p>
  <p class="Code">        xParaCursor.gotoNextParagraph(true);</p>
  <p class="Code"> </p>
  <p class="Code">        // Create a new text section and get it's XNamed interface</p>
  <p class="Code">        XNamed xSectionNamed = (XNamed) UnoRuntime.queryInterface(</p>
  <p class="Code">            XNamed.class, mxDocFactory.createInstance("com.sun.star.text.TextSection"));</p>
  <p class="Code"> </p>
  <p class="Code">        // Set the name of our new section (appropiately) to 'Fish'</p>
  <p class="Code">        xSectionNamed.setName("Fish");</p>
  <p class="Code"> </p>
  <p class="Code">        // Create the TextColumns service and get it's XTextColumns interface</p>
  <p class="Code">        XTextColumns xColumns = (XTextColumns) UnoRuntime.queryInterface(</p>
  <p class="Code">            XTextColumns.class, mxDocFactory.createInstance("com.sun.star.text.TextColumns"));</p>
  <p class="Code"> </p>
  <p class="Code">        // We want three columns</p>
  <p class="Code">        xColumns.setColumnCount((short) 3);</p>
  <p class="Code"> </p>
  <p class="Code">        // Get the TextColumns, and make the middle one narrow with a larger margin</p>
  <p class="Code">        // on the left than the right</p>
  <p class="Code">        TextColumn[]  aSequence = xColumns.getColumns ();</p>
  <p class="Code">        aSequence[1].Width /= 2;</p>
  <p class="Code">        aSequence[1].LeftMargin = 350;</p>
  <p class="Code">        aSequence[1].RightMargin = 200;</p>
  <p class="Code">        // Set the updated TextColumns back to the XTextColumns</p>
  <p class="Code">        xColumns.setColumns(aSequence);</p>
  <p class="Code"> </p>
  <p class="Code">        // Get the property set interface of our 'Fish' section</p>
  <p class="Code">        XPropertySet xSectionProps = (XPropertySet) UnoRuntime.queryInterface(</p>
  <p class="Code">            XPropertySet.class, xSectionNamed);</p>
  <p class="Code"> </p>
  <p class="Code">        // Set the columns to the Text Section</p>
  <p class="Code">        xSectionProps.setPropertyValue("TextColumns", xColumns);</p>
  <p class="Code">        </p>
  <p class="Code">        // Get the XTextContent interface of our 'Fish' section</p>
  <p class="Code">        mxFishSection = (XTextContent) UnoRuntime.queryInterface(</p>
  <p class="Code">            XTextContent.class, xSectionNamed);</p>
  <p class="Code"> </p>
  <p class="Code">        // Insert the 'Fish' section over the currently selected text</p>
  <p class="Code">        mxDocText.insertTextContent(mxDocCursor, mxFishSection, true);</p>
  <p class="Code"> </p>
  <p class="Code">        // Get the wonderful XRelativeTextContentInsert interface</p>
  <p class="Code">        XRelativeTextContentInsert xRelative = (XRelativeTextContentInsert)</p>
  <p class="Code">            UnoRuntime.queryInterface(XRelativeTextContentInsert.class, mxDocText);</p>
  <p class="Code"> </p>
  <p class="Code">        // Create a new empty paragraph and get it's XTextContent interface</p>
  <p class="Code">        XTextContent xNewPara = (XTextContent) UnoRuntime.queryInterface(XTextContent.class, </p>
  <p class="Code">            mxDocFactory.createInstance("com.sun.star.text.Paragraph"));</p>
  <p class="Code">                                </p>
  <p class="Code">        // Insert the empty paragraph after the fish Text Section</p>
  <p class="Code">        xRelative.insertTextContentAfter(xNewPara, mxFishSection);</p>
  <p class="Code">    } catch (Exception e) {</p>
  <p class="Code">        e.printStackTrace(System.out);</p>
  <p class="Code">    }</p>
  <p class="Code">} </p>
  <p class="Paragraph">The text columns property consists of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextColumn.html" title="see type com.sun.star.text.TextColumn">com.sun.star.text.TextColumn</a></span> structs. The <span class="Codeintext">Width</span> elements of all structs in the <span class="Codeintext">TextColumns</span> sequence make up a sum, that is provided by the method <span class="Codeintext">getReferenceValue()</span> of the <span class="Codeintext">XTextColumns</span> interface. To determine the metric width of an actual column, the reference value and the columns width element have to be calculated using the metric width of the object (page, text frame, text section) and a rule of three, for example:</p>
  <p class="Code">nColumn3Width = aColumns[3].Width / xTextColumns.getReferenceValue() * RealObjectWidth </p>
  <p class="Paragraph">The column margins (<span class="Codeintext">LeftMargin</span>, and <span class="Codeintext">RightMargin</span> elements of the struct) are inside of the column. Their values do not influence the column width. They just limit the space available for the column content. </p>
  <p class="Paragraph">The default column setting in OpenOffice.org creates columns with equal margins at inner columns, and no left margin at the leftmost column and no right margin at the rightmost column. Therefore, the relative width of the first and last column is smaller than those of the inner columns. This causes a limitation of this property: Setting the text columns with equal column content widths and equal margins is only possible when the width of the object (text frame, text section) can be determined. Unfortunately this is  impossible when the width of the object depends on its environment itself.</p>
  <h3 class="Head3"><a name="1_4_7_Link_targets" />8.4.7  Link targets</h3>
  <p class="Paragraph">The interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/document/XLinkTargetSupplier.html" title="see type com.sun.star.document.XLinkTargetSupplier">com.sun.star.document.XLinkTargetSupplier</a></span> of the document model provides all elements of the document that can be used as link targets. These targets can be used for load URLs and sets the selection to a certain position object inside of a document. An example of a URL containing a link target is <span class="wwwftpemail">"file:///c:/documents/document1|bookmarkname"</span>. </p>
  <p class="Paragraph">This interface is used from the hyperlink dialog to detect the links available inside of a document.  </p>
  <p class="Paragraph">The interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XNameAccess.html" title="see type com.sun.star.container.XNameAccess">com.sun.star.container.XNameAccess</a></span> returned by the method <span class="Codeintext">getLinks()</span> provides access to an array of target types. These types are: </p>
  <ul style="margin-left:0.5cm;">
   <li class="P29" style="margin-left:2.5cm;"><p class="P29" style="margin-left:0cm;">Tables </p></li>
   <li class="P29" style="margin-left:2.5cm;"><p class="P29" style="margin-left:0cm;">Text frame </p></li>
   <li class="P29" style="margin-left:2.5cm;"><p class="P29" style="margin-left:0cm;">Graphics </p></li>
   <li class="P29" style="margin-left:2.5cm;"><p class="P29" style="margin-left:0cm;">OLEObjects </p></li>
   <li class="P29" style="margin-left:2.5cm;"><p class="P29" style="margin-left:0cm;">Sections </p></li>
   <li class="P29" style="margin-left:2.5cm;"><p class="P29" style="margin-left:0cm;">Headings </p></li>
   <li class="P29" style="margin-left:2.5cm;"><p class="P29" style="margin-left:0cm;">Bookmarks. </p></li>
  </ul>
  <p class="Paragraph">The names of the elements depend on the installed language.  </p>
  <p class="Paragraph">Each returned object supports the interfaces <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/beans/XPropertySet.html" title="see type com.sun.star.beans.XPropertySet">com.sun.star.beans.XPropertySet</a></span> and interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XNameAccess.html" title="see type com.sun.star.container.XNameAccess">com.sun.star.container.XNameAccess</a></span>.  The property set provides the properties <span class="Codeintext">LinkDisplayName</span> (string) and <span class="Codeintext">LinkDisplayBitmap</span> (<span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/awt/XBitmap.html" title="see type com.sun.star.awt.XBitmap">com.sun.star.awt.XBitmap</a></span>). Each of these objects provides an array of targets of the relating type. Each target returned supports the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/beans/XPropertySet.html" title="see type com.sun.star.beans.XPropertySet">com.sun.star.beans.XPropertySet</a></span>  and the property <span class="Codeintext">LinkDisplayName</span> (string).</p>
  <p class="P30">The name of the objects is the bookmark to be added to the document URL, for example,  <span class="wwwftpemail">"Table1|table"</span>. The <span class="Codeintext">LinkDisplayName</span> contains the name of the object, e.g. <span class="Codeintext">"Table1"</span>.</p>
  <h2 class="Head2"><a name="1_5_Text_Document_Controller" />8.5  Text Document Controller</h2>
  <p class="Paragraph">The text document model knows its controller and it can lock the controller to block user interaction. The appropriate methods in the model's <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/frame/XModel.html" title="see type com.sun.star.frame.XModel">com.sun.star.frame.XModel</a></span> interface are:</p>
  <p class="MethodSignatures">void <span class="T2">lockControllers</span>()</p>
  <p class="MethodSignatures">void <span class="T2">unlockControllers</span>()</p>
  <p class="MethodSignatures">boolean <span class="T2">hasControllersLocked</span>()</p>
  <p class="MethodSignatures">com::sun::star::frame::XController <span class="T2">getCurrentController</span>()</p>
  <p class="MethodSignatures">void <span class="T2">setCurrentController</span>( [in] com::sun::star::frame::XController xController)</p>
  <p class="Paragraph">The controller returned by <span class="Codeintext">getCurrentController()</span>shares the following interfaces with all other document controllers in OpenOffice.org:</p>
  <ul style="margin-left:0.5cm;">
   <li class="P31" style="margin-left:2.5cm;"><p class="P31" style="margin-left:0cm;"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/frame/XController.html" title="see type com.sun.star.frame.XController">com.sun.star.frame.XController</a></span></p></li>
   <li class="P31" style="margin-left:2.5cm;"><p class="P31" style="margin-left:0cm;"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/frame/XDispatchProvider.html" title="see type com.sun.star.frame.XDispatchProvider">com.sun.star.frame.XDispatchProvider</a></span></p></li>
   <li class="P31" style="margin-left:2.5cm;"><p class="P31" style="margin-left:0cm;"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/ui/XContextMenuInterceptor.html" title="see type com.sun.star.ui.XContextMenuInterceptor">com.sun.star.ui.XContextMenuInterceptor</a></span></p></li>
  </ul>
  <p class="Paragraph">Document controllers are explained in the <span class="ChapterRef"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/OfficeDev/OfficeDev.xhtml#1_Office_Development" title="see chapter 7 Office Development">7 Office Development</a></span>. </p>
  <h3 class="Head3"><a name="1_5_1_TextView" />8.5.1  TextView</h3>
  <p class="Paragraph">The writer controller implementation supports the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/view/XSelectionSupplier.html" title="see type com.sun.star.view.XSelectionSupplier">com.sun.star.view.XSelectionSupplier</a></span> that returns the object that is currently selected in the user interface.</p>
  <p class="Paragraph">Its method <span class="Codeintext">getSelection()</span> returns an <span class="CODEKeyWord">any</span>  that may contain the following object depending on the selection:</p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table11"><colgroup><col width="224" /><col width="481" /></colgroup><tr><td style="text-align:left;width:4.897cm; " class="Table11A1">
     <p class="TableHead">Selection </p>
    </td><td style="text-align:left;width:10.543cm; " class="Table11B1">
     <p class="TableHead">Returned Object </p>
    </td></tr><tr><td style="text-align:left;width:4.897cm; " class="Table11A2">
     <p class="TextInTable">Text </p>
    </td><td style="text-align:left;width:10.543cm; " class="Table11B2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/container/XIndexAccess.html" title="see type com.sun.star.container.XIndexAccess">com.sun.star.container.XIndexAccess</a></span> containing one or more <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/uno/XInterface.html" title="see type com.sun.star.uno.XInterface">com.sun.star.uno.XInterface</a></span> pointing to a text range.</p>
    </td></tr><tr><td style="text-align:left;width:4.897cm; " class="Table11A2">
     <p class="TextInTable">Selection of table cells </p>
    </td><td style="text-align:left;width:10.543cm; " class="Table11B2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/uno/XInterface.html" title="see type com.sun.star.uno.XInterface">com.sun.star.uno.XInterface</a></span> pointing to a table cursor.</p>
    </td></tr><tr><td style="text-align:left;width:4.897cm; " class="Table11A2">
     <p class="TextInTable">Text frame </p>
    </td><td style="text-align:left;width:10.543cm; " class="Table11B2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/uno/XInterface.html" title="see type com.sun.star.uno.XInterface">com.sun.star.uno.XInterface</a></span> pointing to a text frame.</p>
    </td></tr><tr><td style="text-align:left;width:4.897cm; " class="Table11A2">
     <p class="TextInTable">Graphic object </p>
    </td><td style="text-align:left;width:10.543cm; " class="Table11B2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/uno/XInterface.html" title="see type com.sun.star.uno.XInterface">com.sun.star.uno.XInterface</a></span> pointing to a graphic object.</p>
    </td></tr><tr><td style="text-align:left;width:4.897cm; " class="Table11A2">
     <p class="TextInTable">OLE object </p>
    </td><td style="text-align:left;width:10.543cm; " class="Table11B2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/uno/XInterface.html" title="see type com.sun.star.uno.XInterface">com.sun.star.uno.XInterface</a></span> pointing to an OLE object.</p>
    </td></tr><tr><td style="text-align:left;width:4.897cm; " class="Table11A2">
     <p class="TextInTable">Shape, Form control </p>
    </td><td style="text-align:left;width:10.543cm; " class="Table11B2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/uno/XInterface.html" title="see type com.sun.star.uno.XInterface">com.sun.star.uno.XInterface</a></span> pointing to a <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/drawing/ShapeCollection.html" title="see type com.sun.star.drawing.ShapeCollection">com.sun.star.drawing.ShapeCollection</a></span> containing one or more shapes.</p>
    </td></tr></table></div>
  <ul style="margin-left:0.5cm;">
   <li class="P32" style="margin-left:2.5cm;"><p class="P32" style="margin-left:0cm;"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/view/XControlAccess.html" title="see type com.sun.star.view.XControlAccess">com.sun.star.view.XControlAccess</a></span><br />provides access to the controller of form controls.</p></li>
   <li class="P32" style="margin-left:2.5cm;"><p class="P32" style="margin-left:0cm;"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextViewCursorSupplier.html" title="see type com.sun.star.text.XTextViewCursorSupplier">com.sun.star.text.XTextViewCursorSupplier</a></span><br />provides access to the cursor of the view.</p></li>
   <li class="P32" style="margin-left:2.5cm;"><p class="P32" style="margin-left:0cm;"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XRubySelection.html" title="see type com.sun.star.text.XRubySelection">com.sun.star.text.XRubySelection</a></span><br />provides access to rubies contained in the selection. This interface is necessary for Asian language support.</p></li>
   <li class="P32" style="margin-left:2.5cm;"><p class="P32" style="margin-left:0cm;"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/view/XViewSettingsSupplier.html" title="see type com.sun.star.view.XViewSettingsSupplier">com.sun.star.view.XViewSettingsSupplier</a></span><br />provides access to the settings of the view as described in the service <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html" title="see type com.sun.star.text.ViewSettings">com.sun.star.text.ViewSettings</a></span>. </p></li>
  </ul>
  <p class="Paragraph"> </p>
  <div style="text-align:left"><table border="0" cellspacing="0" cellpadding="0" class="Table18"><colgroup><col width="220" /><col width="485" /></colgroup><tr><td colspan="2" style="text-align:left;width:4.815cm; " class="Table18A1">
     <p class="TableHead">Properties of <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html" title="see type com.sun.star.text.ViewSettings">com.sun.star.text.ViewSettings</a></span> </p>
    </td></tr><tr><td style="text-align:left;width:4.815cm; " class="Table18A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html#ShowAnnotations" title="see ShowAnnotations of type com.sun.star.text.ViewSettings">ShowAnnotations</a></span></p>
    </td><td style="text-align:left;width:10.624cm; " class="Table18B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span>, annotations (notes) are visible. </p>
    </td></tr><tr><td style="text-align:left;width:4.815cm; " class="Table18A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html#ShowBreaks" title="see ShowBreaks of type com.sun.star.text.ViewSettings">ShowBreaks</a></span></p>
    </td><td style="text-align:left;width:10.624cm; " class="Table18B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span>, paragraph line breaks are visible. </p>
    </td></tr><tr><td style="text-align:left;width:4.815cm; " class="Table18A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html#ShowDrawings" title="see ShowDrawings of type com.sun.star.text.ViewSettings">ShowDrawings</a></span></p>
    </td><td style="text-align:left;width:10.624cm; " class="Table18B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span>, shapes are visible. </p>
    </td></tr><tr><td style="text-align:left;width:4.815cm; " class="Table18A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html#ShowFieldCommands" title="see ShowFieldCommands of type com.sun.star.text.ViewSettings">ShowFieldCommands</a></span></p>
    </td><td style="text-align:left;width:10.624cm; " class="Table18B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span>, text fields are shown with their commands, otherwise the content is visible. </p>
    </td></tr><tr><td style="text-align:left;width:4.815cm; " class="Table18A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html#ShowFootnoteBackground" title="see ShowFootnoteBackground of type com.sun.star.text.ViewSettings">ShowFootnoteBackground</a></span></p>
    </td><td style="text-align:left;width:10.624cm; " class="Table18B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span>, footnotes symbols are displayed with gray background. </p>
    </td></tr><tr><td style="text-align:left;width:4.815cm; " class="Table18A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html#ShowGraphics" title="see ShowGraphics of type com.sun.star.text.ViewSettings">ShowGraphics</a></span></p>
    </td><td style="text-align:left;width:10.624cm; " class="Table18B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span>, graphic objects are visible. </p>
    </td></tr><tr><td style="text-align:left;width:4.815cm; " class="Table18A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html#ShowHiddenParagraphs" title="see ShowHiddenParagraphs of type com.sun.star.text.ViewSettings">ShowHiddenParagraphs</a></span></p>
    </td><td style="text-align:left;width:10.624cm; " class="Table18B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span>, hidden paragraphs are displayed. </p>
    </td></tr><tr><td style="text-align:left;width:4.815cm; " class="Table18A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html#ShowHiddenText" title="see ShowHiddenText of type com.sun.star.text.ViewSettings">ShowHiddenText</a></span></p>
    </td><td style="text-align:left;width:10.624cm; " class="Table18B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span>, hidden text is displayed. </p>
    </td></tr><tr><td style="text-align:left;width:4.815cm; " class="Table18A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html#ShowHoriRuler" title="see ShowHoriRuler of type com.sun.star.text.ViewSettings">ShowHoriRuler</a></span></p>
    </td><td style="text-align:left;width:10.624cm; " class="Table18B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span>, the horizontal ruler is displayed. </p>
    </td></tr><tr><td style="text-align:left;width:4.815cm; " class="Table18A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html#ShowHoriScrollBar" title="see ShowHoriScrollBar of type com.sun.star.text.ViewSettings">ShowHoriScrollBar</a></span></p>
    </td><td style="text-align:left;width:10.624cm; " class="Table18B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span>, the horizontal scroll bar is displayed. </p>
    </td></tr><tr><td style="text-align:left;width:4.815cm; " class="Table18A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html#ShowIndexMarkBackground" title="see ShowIndexMarkBackground of type com.sun.star.text.ViewSettings">ShowIndexMarkBackground</a></span></p>
    </td><td style="text-align:left;width:10.624cm; " class="Table18B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span> , index marks are displayed with gray background. </p>
    </td></tr><tr><td style="text-align:left;width:4.815cm; " class="Table18A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html#ShowParaBreaks" title="see ShowParaBreaks of type com.sun.star.text.ViewSettings">ShowParaBreaks</a></span></p>
    </td><td style="text-align:left;width:10.624cm; " class="Table18B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span> , paragraph breaks are visible. </p>
    </td></tr><tr><td style="text-align:left;width:4.815cm; " class="Table18A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html#ShowProtectedSpaces" title="see ShowProtectedSpaces of type com.sun.star.text.ViewSettings">ShowProtectedSpaces</a></span></p>
    </td><td style="text-align:left;width:10.624cm; " class="Table18B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span>, protected spaces (hard spaces) are displayed with gray background. </p>
    </td></tr><tr><td style="text-align:left;width:4.815cm; " class="Table18A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html#ShowSoftHyphens" title="see ShowSoftHyphens of type com.sun.star.text.ViewSettings">ShowSoftHyphens</a></span></p>
    </td><td style="text-align:left;width:10.624cm; " class="Table18B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span>, soft hyphens are displayed with gray background. </p>
    </td></tr><tr><td style="text-align:left;width:4.815cm; " class="Table18A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html#ShowSpaces" title="see ShowSpaces of type com.sun.star.text.ViewSettings">ShowSpaces</a></span></p>
    </td><td style="text-align:left;width:10.624cm; " class="Table18B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span>, spaces are displayed with dots. </p>
    </td></tr><tr><td style="text-align:left;width:4.815cm; " class="Table18A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html#ShowTableBoundaries" title="see ShowTableBoundaries of type com.sun.star.text.ViewSettings">ShowTableBoundaries</a></span></p>
    </td><td style="text-align:left;width:10.624cm; " class="Table18B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span>, table boundaries are displayed. </p>
    </td></tr><tr><td style="text-align:left;width:4.815cm; " class="Table18A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html#ShowTables" title="see ShowTables of type com.sun.star.text.ViewSettings">ShowTables</a></span></p>
    </td><td style="text-align:left;width:10.624cm; " class="Table18B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span>, tables are visible. </p>
    </td></tr><tr><td style="text-align:left;width:4.815cm; " class="Table18A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html#ShowTabstops" title="see ShowTabstops of type com.sun.star.text.ViewSettings">ShowTabstops</a></span></p>
    </td><td style="text-align:left;width:10.624cm; " class="Table18B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span>, tab stops are visible. </p>
    </td></tr><tr><td style="text-align:left;width:4.815cm; " class="Table18A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html#ShowTextBoundaries" title="see ShowTextBoundaries of type com.sun.star.text.ViewSettings">ShowTextBoundaries</a></span></p>
    </td><td style="text-align:left;width:10.624cm; " class="Table18B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span>, text boundaries are displayed. </p>
    </td></tr><tr><td style="text-align:left;width:4.815cm; " class="Table18A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html#ShowTextFieldBackground" title="see ShowTextFieldBackground of type com.sun.star.text.ViewSettings">ShowTextFieldBackground</a></span></p>
    </td><td style="text-align:left;width:10.624cm; " class="Table18B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span>, text fields are displayed with gray background. </p>
    </td></tr><tr><td style="text-align:left;width:4.815cm; " class="Table18A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html#ShowVertRuler" title="see ShowVertRuler of type com.sun.star.text.ViewSettings">ShowVertRuler</a></span></p>
    </td><td style="text-align:left;width:10.624cm; " class="Table18B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span>, the vertical ruler is displayed. </p>
    </td></tr><tr><td style="text-align:left;width:4.815cm; " class="Table18A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html#ShowVertScrollBar" title="see ShowVertScrollBar of type com.sun.star.text.ViewSettings">ShowVertScrollBar</a></span></p>
    </td><td style="text-align:left;width:10.624cm; " class="Table18B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span>, the vertical scroll bar is displayed. </p>
    </td></tr><tr><td style="text-align:left;width:4.815cm; " class="Table18A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html#SmoothScrolling" title="see SmoothScrolling of type com.sun.star.text.ViewSettings">SmoothScrolling</a></span></p>
    </td><td style="text-align:left;width:10.624cm; " class="Table18B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span>, smooth scrolling is active. </p>
    </td></tr><tr><td style="text-align:left;width:4.815cm; " class="Table18A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html#SolidMarkHandles" title="see SolidMarkHandles of type com.sun.star.text.ViewSettings">SolidMarkHandles</a></span></p>
    </td><td style="text-align:left;width:10.624cm; " class="Table18B2">
     <p class="TextInTable"><span class="Codeintext">boolean</span> <span class="T8">—</span> If <span class="Codeintext">true</span>, handles of drawing objects are visible. </p>
    </td></tr><tr><td style="text-align:left;width:4.815cm; " class="Table18A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html#ZoomType" title="see ZoomType of type com.sun.star.text.ViewSettings">ZoomType</a></span></p>
    </td><td style="text-align:left;width:10.624cm; " class="Table18B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">—</span> defines the zoom type for the document as defined in <a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/view/DocumentZoomType.html" title="see type com.sun.star.view.DocumentZoomType">com.sun.star.view.DocumentZoomType</a></p>
    </td></tr><tr><td style="text-align:left;width:4.815cm; " class="Table18A2">
     <p class="TextInTable"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/ViewSettings.html#ZoomValue" title="see ZoomValue of type com.sun.star.text.ViewSettings">ZoomValue</a></span></p>
    </td><td style="text-align:left;width:10.624cm; " class="Table18B2">
     <p class="TextInTable"><span class="Codeintext">short</span> <span class="T8">—</span> defines the zoom value to use, the value is given as percentage. Valid only if the property ZoomType is set to <a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/view/DocumentZoomType.html#BY_VALUE" title="see BY_VALUE of type com.sun.star.view.DocumentZoomType:BY_VALUE">com.sun.star.view.DocumentZoomType:BY_VALUE</a>.</p>
    </td></tr></table></div>
  <p class="Paragraph">In StarOffice 6.0 and OpenOffice.org 1.0 you can only influence the zoom factor by setting the <span class="Codeintext">ZoomType</span> to <span class="Codeintext">BY_VALUE</span> and adjusting <span class="Codeintext">ZoomValue</span> explicitly. The other zoom types have no effect.</p>
  <h3 class="Head3"><a name="1_5_2_TextViewCursor" />8.5.2  TextViewCursor</h3>
  <p class="Paragraph">The text controller has a visible cursor that is used in the GUI. Get the <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/TextViewCursor.html" title="see type com.sun.star.text.TextViewCursor">com.sun.star.text.TextViewCursor</a></span> by calling<span class="Codeintext"> getTextViewCursor()</span> at the <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XTextViewCursorSupplier.html" title="see type com.sun.star.text.XTextViewCursorSupplier">com.sun.star.text.XTextViewCursorSupplier</a></span> interface of the current text document controller. </p>
  <p class="Paragraph">It supports the following cursor capabilities that depend on having the necessary information about the current layout state, therefore it is not supported by the model cursor. </p>
  <p class="Paragraph"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/text/XPageCursor.html" title="see type com.sun.star.text.XPageCursor">com.sun.star.text.XPageCursor</a></span></p>
  <p class="MethodSignatures">boolean <span class="T2">jumpToFirstPage</span>()</p>
  <p class="MethodSignatures">boolean <span class="T2">jumpToLastPage</span>()</p>
  <p class="MethodSignatures">boolean <span class="T2">jumpToPage</span>( [in] long pageNo)</p>
  <p class="MethodSignatures">long <span class="T2">getPage</span>()</p>
  <p class="MethodSignatures">boolean <span class="T2">jumpToNextPage</span>()</p>
  <p class="MethodSignatures">boolean <span class="T2">jumpToPreviousPage</span>()</p>
  <p class="MethodSignatures">boolean <span class="T2">jumpToEndOfPage</span>()</p>
  <p class="MethodSignatures">boolean <span class="T2">jumpToStartOfPage</span>()</p>
  <p class="Paragraph"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/view/XScreenCursor.html" title="see type com.sun.star.view.XScreenCursor">com.sun.star.view.XScreenCursor</a></span></p>
  <p class="MethodSignatures">boolean <span class="T2">screenDown</span>()</p>
  <p class="MethodSignatures">boolean <span class="T2">screenUp</span>()</p>
  <p class="Paragraph"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/view/XLineCursor.html" title="see type com.sun.star.view.XLineCursor">com.sun.star.view.XLineCursor</a></span></p>
  <p class="MethodSignatures">boolean <span class="T2">goDown</span>( [in] long lines,  [in] boolean bExpand)</p>
  <p class="MethodSignatures">boolean <span class="T2">goUp</span>( [in] long lines,  [in] boolean bExpand)</p>
  <p class="MethodSignatures">boolean <span class="T2">isAtStartOfLine</span>()</p>
  <p class="MethodSignatures">boolean <span class="T2">isAtEndOfLine</span>()</p>
  <p class="MethodSignatures">void <span class="T2">gotoEndOfLine</span>( [in] boolean bExpand)</p>
  <p class="MethodSignatures">void <span class="T2">gotoStartOfLine</span>( [in] boolean bExpand)</p>
  <p class="Paragraph"><span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/view/XViewCursor.html" title="see type com.sun.star.view.XViewCursor">com.sun.star.view.XViewCursor</a></span></p>
  <p class="MethodSignatures">boolean <span class="CODEEmphasis">goLeft</span>( [in] long characters,  [in] boolean bExpand)</p>
  <p class="MethodSignatures">boolean <span class="CODEEmphasis">goRight</span>( [in] long characters,  [in] boolean bExpand)</p>
  <p class="MethodSignatures">boolean <span class="CODEEmphasis">goDown</span>( [in] long characters,  [in] boolean bExpand)</p>
  <p class="MethodSignatures">boolean <span class="CODEEmphasis">goUp</span>( [in] long characters,  [in] boolean bExpand)</p>
  <p class="Paragraph">Additionally the interface <span class="Codeintext"><a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/common/ref/com/sun/star/beans/XPropertySet.html" title="see type com.sun.star.beans.XPropertySet">com.sun.star.beans.XPropertySet</a></span> is supported. </p>
  <p class="Paragraph">Currently, the view cursor does not have the capabilities as the document cursor does. Therefore, it is necessary to create a document cursor to have access to the full text cursor functionality. The method <span class="Codeintext">createTextCursorByRange()</span> is used:</p>
  <p class="Code">XText xCrsrText = xViewCursor.getText(); </p>
  <p class="Code">// Create a TextCursor over the view cursor's contents </p>
  <p class="Code">XTextCursor xDocumentCursor =         xViewText.createTextCursorByRange(xViewCursor.getStart());</p>
  <p class="Code">xDocumentCursor.gotoRange(xViewCursor.getEnd(), true); </p>
 <p style="text-align:center;"><small>[ <a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/OfficeDev/OfficeDev.xhtml" title="Link to previous document">Previous document</a> | <a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/DevelopersGuide.xhtml" title="Link to the Content Table">Content Table</a> | <a href="http://replay.waybackmachine.org/20090501191804/http://api.openoffice.org/docs/DevelopersGuide/Spreadsheet/Spreadsheet.xhtml" title="Link to next document">Next document</a> ]</small></p></body></html>